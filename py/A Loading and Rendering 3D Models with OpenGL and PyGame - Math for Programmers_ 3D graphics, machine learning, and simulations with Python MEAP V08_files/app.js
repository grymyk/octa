!function(e){function t(t){for(var n,s,a=t[0],c=t[1],l=t[2],d=0,p=[];d<a.length;d++)s=a[d],r[s]&&p.push(r[s][0]),r[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(u&&u(t);p.length;)p.shift()();return i.push.apply(i,l||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],n=!0,a=1;a<o.length;a++){var c=o[a];0!==r[c]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=o[0]))}return e}var n={},r={9:0},i=[];function s(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.e=function(e){var t=[],o=r[e];if(0!==o)if(o)t.push(o[2]);else{var n=new Promise((function(t,n){o=r[e]=[t,n]}));t.push(o[2]=n);var i,a=document.createElement("script");a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=function(e){return s.p+""+({0:"vendors~bookPage~catalogModule~discussionModule~editorPage~exerciseSuitePage~freePreviewManager~geoM~74cc4642",1:"vendors~bookPage~discussionModule~editorPage~freePreviewManager~geoMapModule~helpInfoFeedbackModule~~26883938",2:"vendors~bookPage~geoMapModule~micropurchase~searchModule~shoppingCartModule~unlockManager~unlockModal",3:"vbook-ui~discussionModule~exerciseSuitePage~exercises~profileImageUpload",4:"vbook-ui~exerciseSuitePage~exercises~tryItManager",5:"vbook-ui~micropurchase~unlockManager~unlockModal",6:"default~editorPage~epubPage",7:"vbook-ui~exerciseSuitePage~exercises",8:"vendors~exercises~tryItManager",10:"audioModule",11:"bookPage",12:"booksModule",13:"catalogModule",14:"catalogPage",15:"discussionModule",16:"editorPage",17:"epubPage",18:"exerciseSuitePage",19:"exercises",20:"freePreviewManager",21:"geoMapModule",22:"helpInfoFeedbackModule",23:"landingPage",24:"libraryPage",25:"loginManager",26:"micropurchase",28:"profileImageUpload",29:"promoManager",30:"searchFallbackModule",31:"searchModule",32:"shoppingCartModule",33:"termViewer",34:"tryItManager",35:"tryItPage",36:"unlockManager",37:"unlockModal",38:"unlockText",40:"vbook-ui~discussionModule",41:"vbook-ui~geoMapModule",42:"vbook-ui~searchModule",43:"vbook-ui~shoppingCartModule",44:"vbook-ui~termViewer",46:"vendors~bookPage",47:"vendors~codemirror",48:"vendors~esprima",50:"vendors~profileImageUpload",51:"vendors~searchFallbackModule",52:"vendors~searchModule",53:"vendors~termViewer",54:"wishListManager"}[e]||e)+".chunk.js?"+{0:"b06127a2c59a601181ed",1:"865b12119e3d19773c12",2:"e825b899ce17f20e5193",3:"cc581f2c4af1f162d0a9",4:"177ab2485f0f40a357c1",5:"0bfd748f6f3721486169",6:"e87e9220b43e3cb2bd6e",7:"a37c29b3d1c4908cafb0",8:"05180677c960e21cd591",10:"19155d35340c1561b604",11:"a796f8c9e28d41ef982b",12:"255cd651c1dd5c16ebd5",13:"a2277e980b01484c91fa",14:"9734db0c60c4e6a90f8e",15:"956ec283e45dcdce3a7b",16:"683719abcaae571e1ac6",17:"63ab46b67fb3d7a64de3",18:"154f039df4de1c9372a5",19:"8c4c36ef01261096b032",20:"b520e62ab6eb57a289de",21:"c161864c43ab7034dcc3",22:"4899e2067c87b97e95f4",23:"a273add2e892e742a784",24:"fcfb024eb6149cf37bb1",25:"654895ff4e2b6bf05c33",26:"d3a5dda96f274256f9fe",28:"6f83387a39f15730e13a",29:"dea21562620d5fbd88e8",30:"a80d327827d90cf22ee8",31:"3aed2ccd39ae596e26bf",32:"e6c66a135af60f56b2bd",33:"e8f428004b176613c786",34:"32ea6e41d20d920bf60e",35:"8a86a5ae6ea6cf967ae0",36:"e1252e401758326e0218",37:"9d8ad9e39c1226bf79f9",38:"4214d40db04915723ee9",40:"72130d69e3a149728f25",41:"086bc817d09edd1bae9e",42:"b14d6b6c1c0922b95d26",43:"05d8d2cc37464a5a1b6a",44:"e6d23c05b3b080ee9d1e",46:"3ba66e90703bbf8527e1",47:"bcbc1697874505f3d98b",48:"e8974b8178b067730ab4",50:"a252a5aa0112f3403bd6",51:"88f7dbeea67d6012bd99",52:"7bcc6554a97bd5c68a9c",53:"731a3aca374caa31cef0",54:"7b0afd5c16f5af6a1a03"}[e]}(e);var c=new Error;i=function(t){a.onerror=a.onload=null,clearTimeout(l);var o=r[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+i+")",c.name="ChunkLoadError",c.type=n,c.request=i,o[1](c)}r[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:a})}),12e4);a.onerror=a.onload=i,document.head.appendChild(a)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(o,n,function(t){return e[t]}.bind(null,n));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="https://d1hmx3o2etrakk.cloudfront.net/bin/js/",s.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;i.push([342,39,45]),o()}({0:function(e,t,o){"use strict";var n=o(1),r="",i="",s="",a="",c="",l="",u="",d="",p=function(){var e=document.location.href,t=document.location.href.indexOf("#");if(t<0)return e;return e.substring(0,t)}();var h=n.b.getPlatformAndOsString();r="livebook.manning.com",i="dpzbhybb2pdcj.cloudfront.net",s="https://www.manning.com/",a="https://livebook.manning.com/",c="https://livevideo.manning.com/",d="https://d1hmx3o2etrakk.cloudfront.net/",l="https://images.manning.com/",u="https://dpzbhybb2pdcj.cloudfront.net/";var f=function(){function e(){this.platform=h,this.marketplaceBaseUrl=s,this.liveBookBaseUrl=a,this.liveVideoBaseUrl=c,this.marketplaceBaseImageUrl=l,this.liveBookBaseImageUrl=u,this.awsPublicUrl=""+this.getProtocol()+i}return e.prototype.getProtocol=function(){return document.location.href.startsWith("https")?"https://":"http://"},e.prototype.getServerUrl=function(){return r},e.prototype.getAppRoot=function(){return""+this.getProtocol()+this.getServerUrl()+"/"},e.prototype.getLivebookCdn=function(){return n.b.isApp()?"":d},e.prototype.getLivebookBaseUrl=function(){return a},e.prototype.getLivevideoBaseUrl=function(){return c},e.prototype.navigateToLocation=function(e){e.startsWith(".")&&(e=e.substring(1)),page.redirect(e)},e.prototype.getFromS3=function(e,t,o,n){void 0===n&&(n=!0),$.ajax({url:e,dataType:n?"json":"text",crossDomain:!0}).done((function(e){return t(e)})).fail((function(e){return o(e)}))},e.prototype.attemptLogin=function(e,t,o,n,r){void 0===r&&(r=!0),$.ajax({url:e,type:"post",data:JSON.stringify(n)||{},dataType:r?"json":"text",contentType:r?"application/json":"application/x-www-form-urlencoded",crossDomain:this.isCrossDomain(e),xhrFields:{withCredentials:!0}}).done((function(e){return t(e)})).fail((function(e){return o(e)}))},e.prototype.getFromOurBackend=function(e,t,o,n,r,i,s,a){void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===s&&(s=!1),void 0===a&&(a=!1),this.interactWithOurBackend(e,"get",t,o,n,r,i,s,a)},e.prototype.postToOurBackend=function(e,t,o,n,r,i,s,a){return void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===s&&(s=!1),void 0===a&&(a=!1),this.interactWithOurBackend(e,"post",t,o,n,r,i,s,a)},e.prototype.interactWithOurBackend=function(e,t,o,n,r,i,s,a,c){void 0===i&&(i=!0),void 0===s&&(s=!0),void 0===a&&(a=!1),void 0===c&&(c=!1),r=Object.assign({},r,{platform:this.platform});var l={url:e,type:t,async:s,data:c?JSON.stringify(r||{}):r||{},dataType:i?"json":"text",crossDomain:this.isCrossDomain(e),xhrFields:{withCredentials:!0}};return c&&(l.contentType="application/json; charset=utf-8"),$.ajax(l).done((function(e){return o(e)})).fail((function(e){n(e)}))},e.prototype.isCrossDomain=function(e){return!0},e.prototype.getAbsoluteUrl=function(e){return""+this.getAppRoot()+e},e.prototype.getClientAbsoluteUrl=function(e){return""+document.location.origin+e},e.prototype.getAwsUrl=function(e){return""+this.getAwsPublic()+e},e.prototype.getLiveVideoUrl=function(e){return c+(c.endsWith("/")?"":"/")+e},e.prototype.getBookCoverUrl=function(e){return this.getAwsUrl("/"+e+"/Figures/cover.jpg")},e.prototype.getBookFigureUrl=function(e,t,o){return void 0===o&&(o=""),this.getAwsUrl("/"+e+"/"+(o?"v-"+o+"/":"")+"Figures/"+t)},e.prototype.getInteractiveCodeUrl=function(e,t){return this.getAwsUrl("/"+e+"/interactive/"+t)},e.prototype.getMarketplaceProductCoverUrl=function(e){return l+"180/225/resize/"+e},e.prototype.getMarketplaceHiqhQualityProductCoverUrl=function(e){return l+"720/960/resize/"+e},e.prototype.getMarketplaceProductUrl=function(e,t){return s+(s.endsWith("/")?"":"/")+(t?"livevideo":"books")+"/"+e},e.prototype.getMarketplaceUrl=function(e){return s+(s.endsWith("/")?"":"/")+e},e.prototype.getProductionMarketplaceUrl=function(e){return"https://www.manning.com/"+e},e.prototype.isAbsoluteUrl=function(e){return!!e&&(e.startsWith("http://")||e.startsWith("https://"))},e.prototype.getMarketplaceS3Url=function(e){return"https://manning-content.s3.amazonaws.com/"+e},e.prototype.getBookUrlFromBook=function(e){return"string"==typeof e?this.getBookUrl(e):e?this.getBookUrl(e.slug):""},e.prototype.getBookUrl=function(e){return encodeURI("/book/"+e)},e.prototype.getAbsoluteBookElementUrl=function(e,t,o){return this.getAbsoluteUrl(this.getBookElementUrl(e,t,o).substring(1))},e.prototype.getBookElementUrl=function(e,t,o,n){return this.getBookPageUrl("book",e,t,o,n)},e.prototype.getBookExercisesElementUrl=function(e,t,o,n){return this.getBookPageUrl("exercises",e,t,o,n)},e.prototype.getBookPageUrl=function(e,t,o,n,r){var i="/book/"+t+"/";return o?((o||n)&&(o||(o="chapter-1"),i+=o+"/",n&&(i+="v-"+n+"/"),r&&(i+="r-"+r+"/")),encodeURI(i)):i},e.prototype.getAwsPublic=function(){return this.awsPublicUrl},e.prototype.clearCookies=function(){try{void 0}catch(e){console.log("Clear cookies error:",e)}this.deleteCookie("CASTGC"),this.deleteCookie("JSESSIONID"),this.deleteCookie("m-lb-rm")},e.prototype.deleteCookie=function(e,t){void 0===t&&(t="/"),document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; domain=.manning.com; path="+t},e.prototype.deleteCordovaCookie=function(){cookieMaster.clearCookies((function(){return console.log("Cookies have been cleared")}),(function(){return console.log("Cookies could not be cleared")}))},e.prototype.hasCookie=function(e){return(document.cookie||"").indexOf(e)>=0},e.prototype.hasSsoCookie=function(){return this.hasCookie("CASTGC")},e.prototype.getCookie=function(e){var t,o,n,r;if(o=e+"=",n=(t=document.cookie).indexOf("; "+o),r=t.length,-1!==n)n+=2;else if(-1===(n=t.indexOf(o))||0!==n)return null;return-1!==t.indexOf(";",n)&&(r=t.indexOf(";",n)),decodeURI(t.substring(n+o.length,r)).replace(/"/g,"")},e.prototype.isAdditionalInstruction=function(e){return localStorage&&localStorage.getItem("additionalInstruction")==e},e.prototype.addAdditionalInstructionToExecuteAfterReload=function(e){localStorage&&localStorage.setItem("additionalInstruction",e)},e.prototype.removeAdditionalInstruction=function(){localStorage&&localStorage.removeItem("additionalInstruction")},e.prototype.reloadPage=function(){location.reload(!0)},e.prototype.getInitialPageLocation=function(){return p},e}();t.a=new f},1:function(e,t,o){"use strict";var n,r;o.d(t,"a",(function(){return n})),function(e){e[e.Unknown=0]="Unknown",e[e.Browser=1]="Browser",e[e.Cordova=2]="Cordova",e[e.Electron=3]="Electron"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.Android=1]="Android",e[e.Linux=2]="Linux",e[e.MacOS=3]="MacOS",e[e.iOs=4]="iOs",e[e.Windows=5]="Windows",e[e.WindowsMobile=6]="WindowsMobile"}(r||(r={}));var i=window.cordova||null,s=$(window),a=function(){function e(){var e=this;this.deviceReadyPromise=new Promise((function(t,o){$(document).ready((function(){return t(e.getDeviceInfo())}))}))}return e.prototype.isSmallScreenSize=function(){return s.width()<690},e.prototype.isMediumOrLargeScreenSize=function(){return s.width()>=690},e.prototype.isLargeScreenSize=function(){return s.width()>=900},e.prototype.isExtraLargeScreenSize=function(){return s.width()>=1070},e.prototype.loadDeviceInfo=function(){return this.deviceReadyPromise},e.prototype.getDeviceInfo=function(){return{isTouchDevice:this.isTouchDevice(),platform:this.getPlatform(),os:this.getOS(),platformString:this.getPlatformString(),isIE:this.isIE(),isIOS:this.isIOS(),isAndroid:this.isAndroid()}},e.prototype.isTouchEventOnTouchDevice=function(e){return!!this.isTouchDevice()&&0===(e||"").indexOf("touch")},e.prototype.isTouchDevice=function(){return"ontouchstart"in window||!!window.navigator.maxTouchPoints},e.prototype.isIE=function(){return!!navigator.userAgent.match(/msie|trident|edge/i)},e.prototype.isAndroid=function(){var e=navigator.userAgent||navigator.vendor||"";return/android/i.test(e)},e.prototype.isIOS=function(){var e=(navigator.userAgent||navigator.vendor||"").toLowerCase();return/(iphone|ipod|ipad).*/.test(e)},e.prototype.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},e.prototype.isCordova=function(){return this.getPlatform()===n.Cordova},e.prototype.isIOSCordova=function(){return this.isCordova()&&this.isIOS()},e.prototype.isApp=function(){},e.prototype.getPlatform=function(){return n.Browser},e.prototype.getPlatformAndOsString=function(){return this.getPlatformString()+"-"+this.getOSString()},e.prototype.getPlatformString=function(){return"browser"},e.prototype.getOSString=function(){return i&&i.platformId||navigator.platform},e.prototype.getOS=function(){if(i)switch(i.platformId){case"osx":case"macos":return r.MacOS;case"android":return r.Android;case"ios":return r.iOs;default:return r.Unknown}},e.prototype.isConnected=function(){return this.isCordova()?this.cordovaIsConnected():navigator.onLine},e.prototype.cordovaIsConnected=function(){return navigator&&navigator.connection&&navigator.connection.type?["ethernet","wifi","2g","3g","4g","cellular","5g"].indexOf(navigator.connection.type)>0:navigator.onLine},e}();t.b=new a},121:function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));var n=function(){function e(e,t,o,n,r){this.shortName=e,this.title=t,this.productType=o,this.price=n,this.partialBookOwnership=r}return e.prototype.isAudio=function(){return"AUDIO"===this.productType},e.prototype.isBook=function(){return"EBOOK"===this.productType||"COMBO"===this.productType||"PDF"===this.productType||"LIVEBOOK"==this.productType},e.isAcceptableProductType=function(e){return"AUDIO"===(e=(e||"").toUpperCase())||"EBOOK"===e||"COMBO"===e||"PDF"===e||"LIVEBOOK"==e||"LIVEAUDIO"==e},e}(),r=function(){function e(e,t,o,n,r){this.id=e,this.manningId=t,this.price=o,this.productType=n,this.unitAmountDiscounted=r}return e.prototype.isAudioOffering=function(){return"AUDIO"===this.productType||"LIVEAUDIO"===this.productType||"liveAudio"===this.productType},e.prototype.isEBookOffering=function(){return"EBOOK"===this.productType},e.prototype.isComboOffering=function(){return"COMBO"===this.productType},e.productTypes=["EBOOK","AUDIO","LIVEAUDIO","liveAudio","COMBO"],e}();t.b=r},128:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LinksUtils}));var query_string__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(122),query_string__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(query_string__WEBPACK_IMPORTED_MODULE_0__),_DeviceUtils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),_BookContentUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(15),_DOMUtils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(9),_WebUtils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(0),_EventUtils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(3),_BookViewDOMUtils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6),_RouteUtils__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(18),_components_misc_LinkPreviewer__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(56),_managers_ScreenScrollManager__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(77),_modules_discussions_DiscussionModule__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(67),_modules_UnlockModule__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(76),IS_ON_DEVICE=void 0,$document=$(document),LinksUtilsClass=function(){function LinksUtilsClass(){var e=this;this.pageCounter=0,_DeviceUtils__WEBPACK_IMPORTED_MODULE_1__.b.loadDeviceInfo().then((function(t){e.currentPlatform=t.platform,$("body").on("click","a:not(.immediately-go-to-link)",(function(e){return LinksUtils.handleLinkClick(e,e.currentTarget)})),t.isTouchDevice||(_EventUtils__WEBPACK_IMPORTED_MODULE_5__.a.onDescendantEventWithCooldown($("body"),"mouseenter","#book-markup-container a",(function(t){return e.handleLinkHover(t,t.currentTarget)})),$("body").on("mouseleave","#book-markup-container a",(function(e){return LinksUtils.handleLinkLeave(e.currentTarget)})))}))}return LinksUtilsClass.prototype.clean=function(){_components_misc_LinkPreviewer__WEBPACK_IMPORTED_MODULE_8__.a.hidePreview(!1,!0)},LinksUtilsClass.prototype.adjustBookLink=function(e){if(e=e||"",IS_ON_DEVICE){var t=e.indexOf("#!");return 0==t?e:1==t?e.substr(1):("#!/"+e).replace(/\/\//,"/")}return e.replace("#!/","/")},LinksUtilsClass.prototype.formLink=function(e,t,o){return void 0===o&&(o=""),""+this.getBasePath()+this.formHash(e,t)+o},LinksUtilsClass.prototype.formLinkFromBookSlugAndBookElementShortName=function(e,t){return""+this.getBasePath()+this.formHashFromSlugAndShortNames(e,t)},LinksUtilsClass.prototype.formEditLinkFromBookSlugAndBookElementShortName=function(e,t){return""+this.getBasePath()+this.formEditHashFromSlugAndShortNames(e,t)},LinksUtilsClass.prototype.getBasePath=function(){return _DeviceUtils__WEBPACK_IMPORTED_MODULE_1__.b.isApp()?_WebUtils__WEBPACK_IMPORTED_MODULE_4__.a.getInitialPageLocation():document.location.protocol+"//"+document.location.host},LinksUtilsClass.prototype.formHash=function(e,t){if(null==e||null==t)return"";var o="/book/"+e.slug+"/"+t.shortName+"/";return IS_ON_DEVICE&&(o="#!"+o),t.meapVersion>0?o+="v-"+t.meapVersion+"/":t.reviewVersion>0&&(o+="r-"+t.reviewVersion+"/"),o},LinksUtilsClass.prototype.formHashFromSlugAndShortNames=function(e,t){var o="/book/"+e+"/"+t;return IS_ON_DEVICE&&(o="#!"+o),o},LinksUtilsClass.prototype.formEditHashFromSlugAndShortNames=function(e,t){var o="/edit/"+e+"/"+t;return IS_ON_DEVICE&&(o="#!"+o),o},LinksUtilsClass.prototype.trimLastSlash=function(e){return e&&0!=e.length?"/"==e[e.length-1]?e.substring(0,e.length-1):e:""},LinksUtilsClass.prototype.handleLinkClick=function(e,t){var o=$(t),n=$(e.target),r=$(e.currentTarget),i=n.closest(".dont-propagate-click");if(n.is(".dont-propagate-click")||r.is(".dont-propagate-click")||i.length>0&&$.contains(r[0],i[0]))e.preventDefault();else if((n.is(".immediately-go-to-link")||r.is(".immediately-go-to-link"))&&(document.location.href=t.href),n.is("#livebook-button"))e.preventDefault();else{if(!_DeviceUtils__WEBPACK_IMPORTED_MODULE_1__.b.isConnected()&&_DeviceUtils__WEBPACK_IMPORTED_MODULE_1__.b.isApp()&&r.is(".open-book-link.not-downloaded-book"))return $(document).trigger("requestNotification","Please connect to the internet to open this book"),void e.preventDefault();if(_components_misc_LinkPreviewer__WEBPACK_IMPORTED_MODULE_8__.a.hidePreview(),-1!=t.href.indexOf("data:"))return!0;if(-1!=t.href.indexOf("javascript:void(0)"))return!0;if(!t.href||t.href===document.location.href||t.href===document.location.href+"#")return e.preventDefault(),!1;if(o.is(".reload-link")&&_WebUtils__WEBPACK_IMPORTED_MODULE_4__.a.reloadPage(),t.href.indexOf("search-")>=0&&$document.trigger("searchSuggestion",["link",t.href]),this.isThirdPartyLink(t.href)||e.ctrlKey||e.metaKey||2===e.which||"_blank"==o.attr("target"))return e.preventDefault(),this.openLinkInNewTab(t.href),!1;-1==t.href.indexOf("javascript:")&&$document.trigger("searchHideRequested");var s=this.extractBookElementData(t);if(s){if(this.isLinkOnSameBookElement(s)){e.preventDefault();var a=null;if(s.additional){if(s.additional.startsWith("comment-"))return void _modules_discussions_DiscussionModule__WEBPACK_IMPORTED_MODULE_10__.a.requestShowCommentWhenReady(s.additional.replace("comment-",""),0,(function(){}),$(e.target).closest("#in-page-discussion-wrapper").length>0);!a&&s.additional.startsWith("note-")&&$document.trigger("noteOpenRequested",s.additional.replace("note-","")),!(a=document.getElementById(s.additional))&&s.additional.startsWith("search-")&&null!=(a=document.getElementById(s.additional.replace("search-","")))&&($(".paragraph-selected").removeClass("paragraph-selected"),$(a).addClass("paragraph-selected")),!a&&s.additional.startsWith("section-")&&(a=_BookViewDOMUtils__WEBPACK_IMPORTED_MODULE_6__.a.getSectionHeading(s.additional))}else a=document.querySelector(".readable-text");var c=o.text();if(_BookContentUtils__WEBPACK_IMPORTED_MODULE_2__.a.matchesBrowsableRegEx(c)){var l=o.closest(".readable-text")[0];if(l){var u=_BookContentUtils__WEBPACK_IMPORTED_MODULE_2__.a.getMatchingBrowsable(l.browsables,o.text());$(u).closest(".focus-off").removeClass("focus-off"),u&&_DOMUtils__WEBPACK_IMPORTED_MODULE_3__.a.precedesElement(a,l)&&(a=l)}}return a&&($document.trigger("disableToolbarHiding"),_managers_ScreenScrollManager__WEBPACK_IMPORTED_MODULE_9__.a.scrollToElement(a,(function(){$document.trigger("enableToolbarHiding"),$(a).is(".scrambled")&&s&&s.additional.startsWith("search-")&&_modules_UnlockModule__WEBPACK_IMPORTED_MODULE_11__.a.tryToSearchUnlockFragmentInCurrentBookElement([$(a)])})),$document.trigger("withinChapterLinkScroll",a)),!1}var d=t.href.indexOf("/book/")>-1?"book":"edit";if(s.book&&s.bookElement){var p=(IS_ON_DEVICE?"#!":"")+"/"+d+"/"+s.book+"/"+s.bookElement+"/";return s.meapVersion?p+="v-"+s.meapVersion+"/":s.reviewVersion&&(p+="r-"+s.reviewVersion+"/"),s.additional&&(p+=s.additional),page(p),!1}if(s.book&&!s.bookElement)return page((IS_ON_DEVICE?"#!":"")+"/"+d+"/"+s.book),!1}}},LinksUtilsClass.prototype.handleLinkHover=function(e,t){clearTimeout(this.linkHoverTimer);var o=$(t),n=this.extractBookElementData(t);if(n&&this.isLinkOnSameBookElement(n))try{var r=document.getElementById(n.additional);if(null!=r){var i=$(r).closest(".browsable-container, .readable-text");if(i.is(".browsable-container"))return void(_BookViewDOMUtils__WEBPACK_IMPORTED_MODULE_6__.a.isElementVisibleEvenALittle(i.get(0))||_components_misc_LinkPreviewer__WEBPACK_IMPORTED_MODULE_8__.a.showBrowsablePreview(t,i));if(i.is(".readable-text"))return void(_BookViewDOMUtils__WEBPACK_IMPORTED_MODULE_6__.a.isElementVisibleEvenALittle(i.get(0))||_components_misc_LinkPreviewer__WEBPACK_IMPORTED_MODULE_8__.a.showWithinChapterPreview(t,i))}}catch(e){}if(this.isLivebookLink(t.href)){var s=_WebUtils__WEBPACK_IMPORTED_MODULE_4__.a.getAbsoluteUrl("api/book/linkPreviewDetails"),a=this.extractBookElementData(t);this.linkHoverTimer=_EventUtils__WEBPACK_IMPORTED_MODULE_5__.a.setTimeout((function(){_WebUtils__WEBPACK_IMPORTED_MODULE_4__.a.getFromOurBackend(s,(function(e){null!=e&&o.is(":hover")&&_components_misc_LinkPreviewer__WEBPACK_IMPORTED_MODULE_8__.a.showBookElementPreview(t,e)}),(function(e){console.error("Something went wrong retrieveing preview details: ",e)}),{linkHash:t.hash||t.pathname,bookElementLink:a})}),100)}},LinksUtilsClass.prototype.handleLinkLeave=function(e){clearTimeout(this.linkHoverTimer),this.linkHoverTimer=_EventUtils__WEBPACK_IMPORTED_MODULE_5__.a.setTimeout((function(){$(e).is(":hover")||_components_misc_LinkPreviewer__WEBPACK_IMPORTED_MODULE_8__.a.hidePreview(!0)}),300)},LinksUtilsClass.prototype.extractBookElementData=function(e){var t=query_string__WEBPACK_IMPORTED_MODULE_0__.extract(e.href);if(t){var o="",n=t.indexOf("#");-1!=n&&(o=t.substring(n+1),t=t.substring(0,n));var r=query_string__WEBPACK_IMPORTED_MODULE_0__.parse(t),i=r.book,s=r.bookElement;if("search"in r&&(o="search-"+o),i&&s)return{book:i,bookElement:s,additional:o,isEditLink:t.indexOf("/edit/")>0}}var a=e.pathname,c=_RouteUtils__WEBPACK_IMPORTED_MODULE_7__.a.getRouteInfo(a);return c||((a=e.hash).indexOf("#!")>=0&&(a=a.substring("#!".length),c=_RouteUtils__WEBPACK_IMPORTED_MODULE_7__.a.getRouteInfo(a))?c:document.getElementById(e.hash.substring(1))?((c=_RouteUtils__WEBPACK_IMPORTED_MODULE_7__.a.getCurrentRouteInfo()).additional=e.hash.substring(1),c):null)},LinksUtilsClass.prototype.isLinkOnSameBookElement=function(e){var t=_RouteUtils__WEBPACK_IMPORTED_MODULE_7__.a.getCurrentRouteInfo();return!!t&&(t.book===e.book&&t.bookElement===e.bookElement&&t.meapVersion==e.meapVersion&&t.isEditLink==e.isEditLink)},LinksUtilsClass.prototype.isThirdPartyLink=function(e){return"string"==typeof e&&""!=e&&-1==e.indexOf("localhost")&&-1==e.indexOf("livebook")&&-1==e.indexOf("liveaudio")&&-1==e.indexOf("vbook")&&0!==e.indexOf("file://")&&0!==e.indexOf("cdv://")&&0!==e.indexOf("javascript")},LinksUtilsClass.prototype.isLivebookLink=function(e){return!!e&&(-1!==e.indexOf("localhost")||-1!==e.indexOf("livebook")||0==e.indexOf("#"))},LinksUtilsClass.prototype.openLinkInNewTab=function(location){switch(this.currentPlatform){case _DeviceUtils__WEBPACK_IMPORTED_MODULE_1__.a.Cordova:navigator&&navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(location,{openExternal:!0}):window.cordova&&window.cordova.InAppBrowser&&window.cordova.InAppBrowser.open?window.cordova.InAppBrowser.open(location,"_blank","location=yes"):window.open(location,"_system");break;case _DeviceUtils__WEBPACK_IMPORTED_MODULE_1__.a.Electron:var shell=eval("require('electron').shell");shell&&shell.openExternal&&shell.openExternal(location);break;case _DeviceUtils__WEBPACK_IMPORTED_MODULE_1__.a.Browser:default:var win=window.open(location,"_blank");win.focus()}},LinksUtilsClass.prototype.openLink=function(e){this.isLivebookLink(e)?document.location.href=e:this.openLinkInNewTab(e)},LinksUtilsClass}(),LinksUtils=new LinksUtilsClass},129:function(e,t,o){"use strict";var n;o.d(t,"a",(function(){return n})),o.d(t,"b",(function(){return r})),function(e){e[e.Default=0]="Default",e[e.Search=1]="Search",e[e.Point=2]="Point",e[e.Paragraphs=3]="Paragraphs",e[e.Subsection=4]="Subsection",e[e.Section=5]="Section",e[e.BookElement=6]="BookElement",e[e.FreePreview=7]="FreePreview"}(n||(n={}));var r=new(function(){function e(){}return e.prototype.markParagraphsForUnscrambling=function(e){e.forEach((function(e){e.find(".scrambled-notifier").remove(),e.addClass("unscrambling"),e.removeClass("unscramble-target")}))},e.prototype.adaptReadableTextContentForUnscrambling=function(e){e.forEach((function(e){if(e.attr("data-original-html",e.html()),1===e.children().length&&1===e.children("p").length){var t=e.children("p");t.html('<div class="scrambled-content-container">'+t.html()+'</div>\n                     <div class="unscrambled-content-container"></div>')}else e.html('<div class="scrambled-content-container">'+e.html()+'</div>\n                     <div class="unscrambled-content-container"></div>')}))},e.prototype.resetUnscrambledElements=function(e){e.forEach((function(e){e.html(e.attr("data-original-html")),e.attr("data-original-html",""),e.removeClass("unscrambling")}))},e.prototype.getDataFromPointingLink=function(e,t,o){if(!e||!t||!o||o.length<2)return null;var n={bookShortName:e.shortName,bookElementShortName:t.shortName,paragraphId:void 0,paragraphFingerprint:void 0,pointingLinkId:void 0,paragraphsToUnlock:void 0,startParagraphId:void 0,endParagraphId:void 0,meapVersion:t.meapVersion||0,isUserEditorLink:!1};if(2==o.length?(n.paragraphId=o[0],n.paragraphFingerprint=o[1],n.startParagraphId=parseInt(o[0]),n.endParagraphId=parseInt(o[0])):(n.pointingLinkId=o[0],n.startParagraphId=parseInt(o[1]),n.endParagraphId=parseInt(o[2]),n.isUserEditorLink="1"===o[3]),Number.isNaN(n.startParagraphId)||Number.isNaN(n.endParagraphId))return null;if(n.startParagraphId>n.endParagraphId){var r=n.startParagraphId;n.startParagraphId=n.endParagraphId,n.endParagraphId=r}return n},e.prototype.isEncompassingWholeContent=function(e,t){if("1"!=e)return!1;try{var o=document.querySelector('[refid="'+t+'"]'),n=document.querySelector('[refid="'+(+t+1)+'"]');return null!=o&&null==n}catch(e){return!1}},e.prototype.replaceEncryptedContent=function(e,t){return t&&t.forEach((function(t){var o=e.find("[refid='"+t.paragraphID+"']");o.is(".scrambled")&&o.html(t.content).removeClass("scrambled").addClass("unscrambled")})),e.html()},e}())},130:function(e,t,o){"use strict";var n=o(1),r=$(document),i=$(window),s=function(){function e(){var e=this;this.isDisabled=!0,this.$footer=$("#footer"),r.on("disableToolbarHiding",(function(){n.b.isIOS()||(e.disableHiding(),n.b.isIOS()&&e.hideFooter())})),r.on("enableToolbarHiding",(function(){n.b.isIOS()||(e.enableHiding(),n.b.isIOS()&&e.showFooter())})),i.on("scrollstop",{latency:100},(function(){if(!n.b.isIOS()){var t=r.height();(t-(i.height()+i.scrollTop()))/t==0&&e.showFooter()}}))}return e.prototype.initialize=function(){n.b.isIOS()||(n.b.isSmallScreenSize()&&this.$footer.headroom({tolerance:{up:2,down:0}}),this.isDisabled?this.disableHiding():this.enableHiding())},e.prototype.disableHiding=function(){n.b.isIOS()||(this.isDisabled=!0,this.$footer.data("headroom")&&(this.$footer.data("headroom").disabled=!0))},e.prototype.enableHiding=function(){n.b.isIOS()||(this.isDisabled=!1,this.$footer.data("headroom")&&(this.$footer.data("headroom").disabled=!1))},e.prototype.deactivateHeadroom=function(){this.$footer.data("headroom")&&(this.$footer.data("headroom").destroy(),this.$footer.removeData("headroom"))},e.prototype.hideFooter=function(){n.b.isIOS()||this.$footer.removeClass("headroom--pinned").addClass("headroom--unpinned")},e.prototype.showFooter=function(){n.b.isIOS()||this.$footer.removeClass("headroom--unpinned").addClass("headroom--pinned")},e.prototype.makeFooterTransparent=function(){this.$footer.css({opacity:0})},e.prototype.makeFooterOpaque=function(){this.$footer.css({opacity:1})},e.prototype.disableAndRevert=function(){this.disableHiding(),this.$footer.removeClass("headroom--unpinned").addClass("headroom-pinned")},e}();t.a=new s},131:function(e,t,o){"use strict";var n=o(1),r=$(document),i=function(){function e(){var e=this;this.isDisabled=!0,this.$scrollHeader=$(".scrollheader"),r.on("disableToolbarHiding",(function(){return e.disableHiding()})),r.on("enableToolbarHiding",(function(){return e.enableHiding()}))}return e.prototype.initialize=function(){n.b.isIOS()||(n.b.isSmallScreenSize()&&this.$scrollHeader.headroom({tolerance:{up:2,down:0},onPin:function(){return r.trigger("topbarToggled")},onUnpin:function(){return r.trigger("topbarToggled")}}),this.isDisabled?this.disableHiding():this.enableHiding())},e.prototype.disableHiding=function(){n.b.isIOS()||(this.isDisabled=!0,this.$scrollHeader.data("headroom")&&(this.$scrollHeader.data("headroom").disabled=!0))},e.prototype.enableHiding=function(){n.b.isIOS()||(this.isDisabled=!1,this.$scrollHeader.data("headroom")&&(this.$scrollHeader.data("headroom").disabled=!1))},e.prototype.disableAndRevert=function(){n.b.isIOS()||(this.disableHiding(),this.$scrollHeader.removeClass("headroom--unpinned").addClass("headroom-pinned"))},e}();t.a=new i},132:function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));var n=o(0),r=o(14),i=o(4),s=o(7),a=new(function(){function e(){var e=this;this.discountedProductsPromiseMap={},$(document).on("appActivatedAfterLongTime",(function(){e.dotdProductsPromise=null,e.dotdPromoInfoPromise=null,e.discountedProductsPromiseMap={}}))}return e.prototype.getNewUserDiscountCode=function(){return s.a.isCurrentlyLoggedIn()&&s.a.isExistingUser()?"":r.a.getItem("isBuyer")?"":"lb-new-user-30"},e.prototype.getFreePreviewDiscountCode=function(){return"lbpreview20"},e.prototype.getNewUserProductDiscounts=function(e,t){var o=this;if(null==e||0==e.length||!t)return Promise.resolve([]);var r=e.join(",")+" - "+t;return null!=this.discountedProductsPromiseMap[r]?this.discountedProductsPromiseMap[r]:this.discountedProductsPromiseMap[r]=new Promise((function(r,i){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/cart/newUserProductDeals"),(function(e){var t=[];for(var o in e)for(var n in e[o])e[o][n].discountCode=o,t.push(e[o][n]);r(t)}),(function(e){o.dotdProductsPromise=null,i(e)}),{productIds:e.join(","),code:t})}))},e.prototype.getDotdPromoInfo=function(){var e=this;return null!=this.dotdPromoInfoPromise?this.dotdPromoInfoPromise:this.dotdPromoInfoPromise=new Promise((function(t,o){Promise.all([e.getDotdProducts(),e.getDotdBrief(),e.getDotdFullInfo()]).then((function(e){var o=e[0],r=e[1],s=e[2],a=o.find((function(e){return(r.brief||"").indexOf(e.title)>=0}));if(null!=a){var c=a.productOfferings.find((function(e){return"EBOOK"==e.productType}));if(null!=c){var l="$"+i.a.formatMoney(c.price-c.discount)+" until "+i.a.getShortMonthName(s.expirationDate)+" "+s.expirationDate.getDate();t({headerMessage:"Save 50%! Get the eBook of "+a.title+" for only "+l,shortMessage:a.title+" for "+l,notificationMessage:"Don't miss out! The eBook of "+a.title+" is only "+l+".",priceMessage:l,categories:"",productLink:a.isLivebook?n.a.getBookUrl(a.slug):a.isLiveVideo?n.a.getLiveVideoUrl("course/"+a.externalId+"/"+a.slug):n.a.getMarketplaceProductUrl(a.slug,a.isLiveVideo),productExternalId:a.externalId,discountCode:s.code})}else t(null)}else t(null)})).catch((function(o){e.dotdPromoInfoPromise=null,t(null)}))}))},e.prototype.getDotdBrief=function(){return new Promise((function(e,t){n.a.getFromOurBackend(n.a.getAbsoluteUrl("api/cart/dotdBrief"),(function(t){return e(t)}),(function(e){return t(e)}))}))},e.prototype.getDotdFullInfo=function(){return new Promise((function(e,t){n.a.getFromOurBackend(n.a.getAbsoluteUrl("api/cart/dotdFullInfo"),(function(t){t.expirationDate&&(t.expirationDate=i.a.getDateFromString(t.expirationDate)),t.activationDate&&(t.activationDate=i.a.getDateFromString(t.activationDate)),e(t)}),(function(e){return t(e)}))}))},e.prototype.getDotdProducts=function(){var e=this;return null!=this.dotdProductsPromise?this.dotdProductsPromise:this.dotdProductsPromise=new Promise((function(t,o){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/cart/todaysDealsAndProducts"),(function(e){var o=[];for(var n in e)for(var r in e[n])e[n][r].discountCode=n,o.push(e[n][r]);t(o)}),(function(t){e.dotdProductsPromise=null,o(t)}))}))},e}())},133:function(e,t,o){"use strict";var n=o(1),r=o(63),i=o(65),s=o(64),a=o(4),c=o(0),l=function(){function e(){}return e.prototype.fetchTextAddons=function(e){return new Promise((function(t,o){c.a.getFromOurBackend(c.a.getAbsoluteUrl("api/textAddon/fetchTextAddonsForUsersBook"),(function(e){return t(e)}),(function(e){return o(e)}),{bookShortName:e.book.shortName})}))},e.prototype.addBookmarks=function(e,t){return t&&0!=t.length?new Promise((function(o,n){c.a.postToOurBackend(c.a.getAbsoluteUrl("api/bookmarks/addBookmarks"),(function(e){for(var n=e,r=0;r<n.length;r++)t[r].id=n[r];o(t)}),(function(e){return n(e)}),{bookmarks:JSON.stringify(t),bookShortName:e.book.shortName})})):Promise.resolve([])},e.prototype.addBookmark=function(e,t,o,n,r){var s=new i.a(-1,e.shortName,e.ordinal,t,o,n,r,Date.now(),e.meapVersion);return s.isBeingSynced=!0,new Promise((function(i,a){c.a.postToOurBackend(c.a.getAbsoluteUrl("api/bookmarks/addBookmark"),(function(e){s.id=e.bookmarkID,s.isBeingSynced=!1,i(s)}),(function(e){s.isBeingSynced=!1,a(e)}),{book:e.book.shortName,bookElement:e.shortName,productId:e.book.manningId,bookElementOrdinal:e.ordinal,contentID:t,contentHash:o,bookmarkedText:n,contentLocation:r,meapVersion:e.meapVersion})}))},e.prototype.removeBookmark=function(e,t){return void 0===t&&(t=0),new Promise((function(e,o){c.a.postToOurBackend(c.a.getAbsoluteUrl("api/bookmarks/removeBookmark"),(function(t){return e(!0)}),(function(e){console.log("Error when syncing bookmark",e),o(e)}),{bookmarkID:t})}))},e.prototype.addHighlight=function(e,t,o,n){var r=new s.b(-1,e.book.shortName,e.shortName,e.ordinal,e.meapVersion,o,t,Date.now(),n);return r.isBeingSynced=!0,new Promise((function(i,s){c.a.postToOurBackend(c.a.getAbsoluteUrl("api/highlight/createHighlight"),(function(e){r.id=e.id,r.isBeingSynced=!1,i(r)}),(function(e){console.log("Error when syncing highlight",e),r.isBeingSynced=!1,s(e)}),{bookShortName:e.book.shortName,productId:e.book.manningId,bookElementShortName:e.shortName,bookElementOrdinal:e.ordinal,meapVersion:e.meapVersion,highlightedParagraphsJson:JSON.stringify(t),offset:n,color:o})}))},e.prototype.removeHighlight=function(e,t){return new Promise((function(e,o){c.a.postToOurBackend(c.a.getAbsoluteUrl("api/highlight/deleteHighlight"),(function(t){return e(!0)}),(function(e){return o(e)}),{highlightID:t})}))},e.prototype.changeHighlightColor=function(e,t,o){return t&&o?new Promise((function(n,r){c.a.postToOurBackend(c.a.getAbsoluteUrl("api/highlight/changeColor"),(function(e){return n(!0)}),(function(e){return r(e)}),{bookShortName:e.book.shortName,highlightID:t,color:o})})):Promise.reject("No highlight to change color to")},e.prototype.addNote=function(e,t,o,n,i,s,a,l){var u=new r.a(-1,e.shortName,e.ordinal,t,o,n,i,s,Date.now(),e.meapVersion,e.reviewVersion);return u.isBeingSynced=!0,new Promise((function(r,d){c.a.postToOurBackend(c.a.getAbsoluteUrl("api/note/createNote"),(function(e){u.id=e.id,u.isBeingSynced=!1,r(u)}),(function(e){console.log("Error when syncing note",e),u.isBeingSynced=!1,d(e)}),{book:e.book.shortName,productId:e.book.manningId,bookElement:e.shortName,bookElementOrdinal:e.ordinal,contentItemID:t,contentHash:o,annotatedText:n,noteText:i,contentLocation:s,meapVersion:a,reviewVersion:l})}))},e.prototype.addNotes=function(e,t){return t&&0!=t.length?new Promise((function(o,n){c.a.postToOurBackend(c.a.getAbsoluteUrl("api/notes/addNotes"),(function(e){for(var n=e,r=0;r<n.length;r++)t[r].id=n[r];o(!0)}),(function(e){return n(e)}),{notes:JSON.stringify(t),bookShortName:e.book.shortName})})):Promise.resolve(!0)},e.prototype.removeNote=function(e,t){return new Promise((function(e,o){if(!t)return console.log("When removing note, cannot find note with id"),void o("Cannot find note to remove");c.a.postToOurBackend(c.a.getAbsoluteUrl("api/note/removeNote"),(function(t){return e(!0)}),(function(e){return o(e)}),{noteID:t},!1)}))},e.prototype.editNote=function(e,t,o){return new Promise((function(e,n){if(!t)return console.log("When editing note, cannot find note with id"),void n("Cannot find note with id");c.a.postToOurBackend(c.a.getAbsoluteUrl("api/note/editNote"),(function(t){return e(!0)}),(function(e){console.log("Error when syncing note",e),n(e)}),{noteID:t,noteText:o},!1)}))},e.prototype.syncTextAddonsWithServer=function(e){return void 0===e&&(e=void 0),e?new Promise((function(t,o){return c.a.postToOurBackend(c.a.getAbsoluteUrl("api/textAddon/syncTextAddons"),(function(){return t(!0)}),(function(e){document.dispatchEvent(new CustomEvent("sync-error",{detail:{error:e}})),o(!1)}),e,!0,!0,!1,!0)})):Promise.resolve(!0)},e}(),u=o(14),d=function(){function e(){this.webService=new l}return e.prototype.getUniqueTextAddonId=function(){var e=parseInt(u.a.getItem("TEXT_ADDON_COUNTER")||"0");return e=Number.isNaN(e)?0:e,e--,u.a.setItem("TEXT_ADDON_COUNTER",e),e},e.prototype.fetchTextAddons=function(e){var t=this;return n.b.isConnected()?new Promise((function(o,n){t.webService.fetchTextAddons(e).then((function(n){t.storeTextAddons(e,n),o(n)})).catch((function(r){t.loadTextAddons(e).then((function(e){return o(e)})).catch((function(e){return n(e)}))}))})):new Promise((function(o,n){return t.loadTextAddons(e).then((function(e){o(e)})).catch((function(e){return n(e)}))}))},e.prototype.loadTextAddons=function(e){var t=this;return new Promise((function(o,n){t.getUtils().readFile(t.getUtils().getTextAddonsLocation(e.book.shortName)).then((function(e){o(e?JSON.parse(e):{bookmarks:[],notes:[],highlights:[]})})).catch((function(e){return o({bookmarks:[],notes:[],highlights:[]})}))}))},e.prototype.loadSyncTextAddons=function(){var e=this;return new Promise((function(t,o){var n=e.getUtils().getSyncTextAddonsLocation();e.getUtils().readFile(n).then((function(e){if(e){var o=JSON.parse(e);t(o||{})}else t({})})).catch((function(e){return t({})}))}))},e.prototype.storeTextAddons=function(e,t){this.getUtils().writeToFile(this.getUtils().getTextAddonsLocation(e.book.shortName),JSON.stringify(t))},e.prototype.storeSyncTextAddons=function(e){this.getUtils().writeToFile(this.getUtils().getSyncTextAddonsLocation(),JSON.stringify(e))},e.prototype.addBookmark=function(e,t,o,r,i){var s=this;return n.b.isConnected()?new Promise((function(n,a){s.webService.addBookmark(e,t,o,r,i).then((function(t){s.storeBookmark(e,t),n(t)})).catch((function(c){s.addBookmarkToDevice(e,t,o,r,i).then((function(e){return n(e)})).catch((function(e){return a(e)}))}))})):this.addBookmarkToDevice(e,t,o,r,i)},e.prototype.addNote=function(e,t,o,r,i,s,a,c){var l=this;return n.b.isConnected()?new Promise((function(n,u){l.webService.addNote(e,t,o,r,i,s,a,c).then((function(t){l.storeNote(e,t),n(t)})).catch((function(d){l.addNoteToDevice(e,t,o,r,i,s,a,c).then((function(e){return n(e)})).catch((function(e){return u(e)}))}))})):this.addNoteToDevice(e,t,o,r,i,s,a,c)},e.prototype.addHighlight=function(e,t,o,r){var i=this;return n.b.isConnected()?new Promise((function(n,s){i.webService.addHighlight(e,t,o,r).then((function(t){i.storeHighlight(e,t),n(t)})).catch((function(a){i.addHighlightToDevice(e,t,o,r).then((function(e){return n(e)})).catch((function(e){return s(e)}))}))})):this.addHighlightToDevice(e,t,o,r)},e.prototype.addBookmarkToDevice=function(e,t,o,n,r){var s=this;return new Promise((function(a,c){var l=new i.a(s.getUniqueTextAddonId(),e.shortName,e.ordinal,t,o,n,r,Date.now(),e.meapVersion);l.hasNotBeenStoredOnServer=!0,s.storeBookmark(e,l),a(l)}))},e.prototype.addNoteToDevice=function(e,t,o,n,i,s,a,c){var l=this;return new Promise((function(a,c){var u=new r.a(l.getUniqueTextAddonId(),e.shortName,e.ordinal,t,o,n,i,s,Date.now(),e.meapVersion,e.reviewVersion);u.hasNotBeenStoredOnServer=!0,l.storeNote(e,u),a(u)}))},e.prototype.addHighlightToDevice=function(e,t,o,n){var r=this;return new Promise((function(i,a){var c=new s.b(r.getUniqueTextAddonId(),e.book.shortName,e.shortName,e.ordinal,e.meapVersion,o,t,Date.now(),n);c.hasNotBeenStoredOnServer=!0,r.storeHighlight(e,c),i(c)}))},e.prototype.removeBookmark=function(e,t){var o=this;return n.b.isConnected()?new Promise((function(n,r){o.webService.removeBookmark(e,t).then((function(){o.removeBookmarkFromDevice(e,t),n(!0)})).catch((function(i){o.scheduleBookmarkForDeviceDeletion(e,t).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))})):(this.scheduleBookmarkForDeviceDeletion(e,t),this.removeBookmarkFromDevice(e,t))},e.prototype.removeNote=function(e,t){var o=this;return n.b.isConnected()?new Promise((function(n,r){o.webService.removeNote(e,t).then((function(){o.removeNoteFromDevice(e,t),n(!0)})).catch((function(i){o.scheduleNoteForDeviceDeletion(e,t).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))})):(this.scheduleNoteForDeviceDeletion(e,t),this.removeNoteFromDevice(e,t))},e.prototype.removeHighlight=function(e,t){var o=this;return n.b.isConnected()?new Promise((function(n,r){o.webService.removeHighlight(e,t).then((function(){o.removeHighlightFromDevice(e,t),n(!0)})).catch((function(i){o.scheduleHighlightForDeviceDeletion(e,t).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))})):(this.scheduleHighlightForDeviceDeletion(e,t),this.removeHighlightFromDevice(e,t))},e.prototype.removeBookmarkFromDevice=function(e,t){var o=this;return new Promise((function(n,r){o.loadTextAddons(e).then((function(r){a.a.removeItemFromArray(r.bookmarks,r.bookmarks.find((function(e){return e.id==t}))),o.storeTextAddons(e,r),n(!0)}))}))},e.prototype.removeNoteFromDevice=function(e,t){var o=this;return new Promise((function(n,r){o.loadTextAddons(e).then((function(r){a.a.removeItemFromArray(r.notes,r.notes.find((function(e){return e.id==t}))),o.storeTextAddons(e,r),n(!0)}))}))},e.prototype.removeHighlightFromDevice=function(e,t){var o=this;return new Promise((function(n,r){o.loadTextAddons(e).then((function(r){a.a.removeItemFromArray(r.highlights,r.highlights.find((function(e){return e.id==t}))),o.storeTextAddons(e,r),n(!0)}))}))},e.prototype.scheduleBookmarkForDeviceDeletion=function(e,t){var o=this;return new Promise((function(n,r){var i=e.book.shortName;o.loadSyncTextAddons().then((function(e){var n=e[i]&&e[i].bookmarks,r=n&&n.find((function(e){return e.id==t}));if(r)a.a.removeItemFromArray(e[i].bookmarks,r),o.storeSyncTextAddons(e);else{var s={id:t,operation:"delete"};o.addToSyncTextAddons(i,"bookmarks",s)}})),n(!0)}))},e.prototype.scheduleNoteForDeviceDeletion=function(e,t){var o=this;return new Promise((function(n,r){o.loadSyncTextAddons().then((function(n){var r=e.book.shortName,i=n[r]&&n[r].notes,s=i&&i.find((function(e){return e.id==t}));if(s)a.a.removeItemFromArray(n[r].notes,s),o.storeSyncTextAddons(n);else{var c={id:t,operation:"delete"};o.addToSyncTextAddons(e.book.shortName,"notes",c)}})),n(!0)}))},e.prototype.scheduleHighlightForDeviceDeletion=function(e,t){var o=this;return new Promise((function(n,r){o.loadSyncTextAddons().then((function(n){var r=e.book.shortName,i=n[r]&&n[r].highlights,s=i&&i.find((function(e){return e.id==t}));if(s)a.a.removeItemFromArray(n[r].notes,s),o.storeSyncTextAddons(n);else{var c={id:t,operation:"delete"};o.addToSyncTextAddons(e.book.shortName,"highlights",c)}})),n(!0)}))},e.prototype.storeBookmark=function(e,t){var o=this;this.loadTextAddons(e).then((function(n){n.bookmarks.push(t),o.storeTextAddons(e,n)}));var n=Object.assign({operation:"new"},t);this.addToSyncTextAddons(e.book.shortName,"bookmarks",n)},e.prototype.storeNote=function(e,t){var o=this;if(this.loadTextAddons(e).then((function(n){n.notes.push(t),o.storeTextAddons(e,n)})),!n.b.isConnected()){var r=Object.assign({operation:"new"},t);this.addToSyncTextAddons(e.book.shortName,"notes",r)}},e.prototype.storeHighlight=function(e,t){var o=this;if(this.loadTextAddons(e).then((function(n){n.highlights.push(t),o.storeTextAddons(e,n)})),!n.b.isConnected()){var r=Object.assign({operation:"new"},t);this.addToSyncTextAddons(e.book.shortName,"highlights",r)}},e.prototype.addToSyncTextAddons=function(e,t,o){var n=this;this.loadSyncTextAddons().then((function(r){var i,s=r[e]||{bookmarks:[],highlights:[],notes:[]};s[t].push(o),Object.assign(r,((i={})[e]=s,i)),n.storeSyncTextAddons(r)}))},e.prototype.changeHighlightColor=function(e,t,o){var r=this;return n.b.isConnected()?new Promise((function(n,i){r.webService.changeHighlightColor(e,t,o).then((function(i){r.saveHighlightColorChangeToDevice(e,t,o,!0),n(i)})).catch((function(s){r.saveHighlightColorChangeToDevice(e,t,o,!1).then((function(e){return n(e)})).catch((function(e){return i(e)}))}))})):(this.loadSyncTextAddons().then((function(n){var i=e.book.shortName,s=(n[i]&&n[i].highlights).find((function(e){return e.id==t}));if(s)s.color=o,r.storeSyncTextAddons(n);else{var a={id:t,color:o,operation:"edit"};r.addToSyncTextAddons(e.book.shortName,"highlights",a)}})),this.saveHighlightColorChangeToDevice(e,t,o,!1))},e.prototype.saveHighlightColorChangeToDevice=function(e,t,o,n){var r=this;return new Promise((function(i,s){r.loadTextAddons(e).then((function(s){var a=s.highlights.find((function(e){return e.id==t}));null!=a&&(a.color=o,a.hasNotBeenEditedToServer=n),r.storeTextAddons(e,s),i(!0)}))}))},e.prototype.editNote=function(e,t,o){var r=this;return n.b.isConnected()?new Promise((function(n,i){r.webService.editNote(e,t,o).then((function(i){r.saveNoteTextChangeToDevice(e,t,o,!0),n(i)})).catch((function(s){r.saveNoteTextChangeToDevice(e,t,o,!1).then((function(e){return n(e)})).catch((function(e){return i(e)}))}))})):(this.loadSyncTextAddons().then((function(n){var i=e.book.shortName,s=(n[i]&&n[i].notes).find((function(e){return e.id==t}));if(s)s.text=o,r.storeSyncTextAddons(n);else{var a={id:t,text:o,operation:"edit"};r.addToSyncTextAddons(e.book.shortName,"notes",a)}})),this.saveNoteTextChangeToDevice(e,t,o,!1))},e.prototype.syncTextAddonsWithServer=function(){var e=this;return new Promise((function(t,o){return e.loadSyncTextAddons().then((function(n){Object.keys(n).length?e.webService.syncTextAddonsWithServer(n).then((function(o){e.getUtils().writeToFile(e.getUtils().getSyncTextAddonsLocation(),""),t(o)})).catch((function(e){return o(!1)})):t(!0)}))}))},e.prototype.saveNoteTextChangeToDevice=function(e,t,o,n){var r=this;return new Promise((function(i,s){r.loadTextAddons(e).then((function(s){var a=s.notes.find((function(e){return e.id==t}));null!=a&&(a.noteText=o,a.hasNotBeenEditedToServer=n),r.storeTextAddons(e,s),i(!0)}))}))},e.prototype.getUtils=function(){return window.fileSystemUtils},e}();o.d(t,"a",(function(){return p}));var p=new(function(){function e(){var e=this;this.textAddonsServicePromise=new Promise((function(e,t){n.b.loadDeviceInfo().then((function(t){e(function(e){switch(e){case n.a.Cordova:case n.a.Electron:return new d;case n.a.Browser:default:return new l}}(t.platform))})).catch((function(e){return t(e)}))})),$(document).on("appActivatedAfterLongTime",(function(){e.data=null,e.dataPromise=null,e.previousTextAddonsRequestInfo=null}))}return e.prototype.fetchTextAddons=function(e){var t=this;return null!=this.dataPromise&&this.previousTextAddonsRequestInfo.bookShortName===e.book.shortName?this.previousTextAddonsRequestInfo.bookElementShortName===e.shortName?null!=this.data?Promise.resolve(this.data):this.dataPromise:this.adaptCurrentTextAddonsToNewBookElement(e):(this.previousTextAddonsRequestInfo={bookShortName:e.book.shortName,bookElementShortName:e.shortName},this.dataPromise=new Promise((function(o,n){t.textAddonsServicePromise.then((function(n){n.fetchTextAddons(e).then((function(n){var a=n.notes.map((function(e){return r.a.fromJSON(e)})),c=n.bookmarks.map((function(e){return i.a.fromJSON(e)})),l=n.highlights.map((function(e){return s.b.fromJSON(e)}));t.data={notes:{bookNotes:a,bookElementNotes:a.filter((function(t){return t.bookElementShortName===e.shortName}))},bookmarks:{bookBookmarks:c,bookElementBookmarks:c.filter((function(t){return t.bookElementShortName===e.shortName}))},highlights:{bookHighlights:l,bookElementHighlights:l.filter((function(t){return t.bookElementShortName===e.shortName}))}},o(t.data)})).catch((function(e){return o(t.data={notes:{bookNotes:[],bookElementNotes:[]},bookmarks:{bookBookmarks:[],bookElementBookmarks:[]},highlights:{bookHighlights:[],bookElementHighlights:[]}})}))}))})))},e.prototype.adaptCurrentTextAddonsToNewBookElement=function(e){var t=this;return this.previousTextAddonsRequestInfo={bookShortName:e.book.shortName,bookElementShortName:e.shortName},null!=this.data?Promise.resolve(this.assignTextAddonData(this.data,e)):new Promise((function(o,n){t.dataPromise.then((function(n){return o(t.assignTextAddonData(n,e))})).catch((function(e){return n(e)}))}))},e.prototype.assignTextAddonData=function(e,t){var o={notes:e.notes,bookmarks:e.bookmarks,highlights:e.highlights};return o.notes.bookElementNotes=e.notes.bookNotes.filter((function(e){return e.bookElementShortName===t.shortName})),o.bookmarks.bookElementBookmarks=e.bookmarks.bookBookmarks.filter((function(e){return e.bookElementShortName===t.shortName})),o.highlights.bookElementHighlights=e.highlights.bookHighlights.filter((function(e){return e.bookElementShortName===t.shortName})),this.data=o},e.prototype.fetchHighlights=function(e){var t=this;return new Promise((function(o,n){t.fetchTextAddons(e).then((function(e){return o(e.highlights)})).catch((function(e){return n(e)}))}))},e.prototype.fetchBookmarks=function(e){var t=this;return new Promise((function(o,n){t.fetchTextAddons(e).then((function(e){return o(e.bookmarks)})).catch((function(e){return n(e)}))}))},e.prototype.fetchNotes=function(e){var t=this;return new Promise((function(o,n){t.fetchTextAddons(e).then((function(e){return o(e.notes)})).catch((function(e){return n(e)}))}))},e.prototype.addHighlight=function(e,t,o,n){var r=this;return new Promise((function(i,s){r.textAddonsServicePromise.then((function(a){a.addHighlight(e,t,o,n).then((function(e){r.data.highlights.bookHighlights.push(e),r.data.highlights.bookElementHighlights.push(e),i(e.id)})).catch((function(e){return s(e)}))}))}))},e.prototype.addBookmark=function(e,t,o,n,r){var i=this;return new Promise((function(s,a){i.textAddonsServicePromise.then((function(c){c.addBookmark(e,t,o,n,r).then((function(e){i.data.bookmarks.bookBookmarks.push(e),i.data.bookmarks.bookElementBookmarks.push(e),s(e.id)})).catch((function(e){return a(e)}))}))}))},e.prototype.addNote=function(e,t,o,n,r,i,s,a){var c=this;return new Promise((function(l,u){c.textAddonsServicePromise.then((function(d){d.addNote(e,t,o,n,r,i,s,a).then((function(e){c.data.notes.bookNotes.push(e),c.data.notes.bookElementNotes.push(e),l(e.id)})).catch((function(e){return u(e)}))}))}))},e.prototype.removeHighlight=function(e,t){var o=this;return new Promise((function(n,r){o.textAddonsServicePromise.then((function(i){var s=o.data&&o.data.highlights.bookHighlights.find((function(e){return e.id==t}));if(null==s)return Promise.resolve(!0);i.removeHighlight(e,t).then((function(e){e&&(a.a.removeItemFromArray(o.data.highlights.bookHighlights,s),a.a.removeItemFromArray(o.data.highlights.bookElementHighlights,s)),n(e)})).catch((function(e){r(e)}))}))}))},e.prototype.removeBookmarkByContentID=function(e,t){var o=this;return new Promise((function(n,r){o.textAddonsServicePromise.then((function(i){var s=o.data&&o.data.bookmarks.bookBookmarks.find((function(e){return e.contentID==t}));if(null==s)return Promise.resolve(!0);i.removeBookmark(e,s.id).then((function(e){e&&(a.a.removeItemFromArray(o.data.bookmarks.bookBookmarks,s),a.a.removeItemFromArray(o.data.bookmarks.bookElementBookmarks,s)),n(e)})).catch((function(e){return r(e)}))}))}))},e.prototype.removeBookmarkById=function(e,t){var o=this;return new Promise((function(n,r){o.textAddonsServicePromise.then((function(i){var s=o.data&&o.data.bookmarks.bookBookmarks.find((function(e){return e.id==t}));if(null==s)return Promise.resolve(!0);i.removeBookmark(e,t).then((function(e){e&&(a.a.removeItemFromArray(o.data.bookmarks.bookBookmarks,s),a.a.removeItemFromArray(o.data.bookmarks.bookElementBookmarks,s)),n(e)})).catch((function(e){return r(e)}))}))}))},e.prototype.removeNote=function(e,t){var o=this;return new Promise((function(n,r){o.textAddonsServicePromise.then((function(i){var s=o.data&&o.data.notes.bookNotes.find((function(e){return e.id==t}));if(null==s)return Promise.resolve(!0);i.removeNote(e,t).then((function(e){e&&(a.a.removeItemFromArray(o.data.notes.bookNotes,s),a.a.removeItemFromArray(o.data.notes.bookElementNotes,s)),n(e)})).catch((function(e){return r(e)}))}))}))},e.prototype.changeHighlightColor=function(e,t,o){var n=this;return e&&t&&o?new Promise((function(r,i){n.textAddonsServicePromise.then((function(s){var a=n.data&&n.data.highlights.bookHighlights.find((function(e){return e.id==t}));if(null==a)return Promise.resolve(!0);s.changeHighlightColor(e,t,o).then((function(e){e&&(a.color=o),r(e)})).catch((function(e){return i(e)}))}))})):Promise.reject("")},e.prototype.editNote=function(e,t,o){var n=this;return e&&t&&o?new Promise((function(r,i){n.textAddonsServicePromise.then((function(s){var a=n.data&&n.data.notes.bookElementNotes.find((function(e){return e.id==t}));if(null==a)return Promise.resolve(!0);s.editNote(e,t,o).then((function(e){e&&(a.noteText=o),r(e)})).catch((function(e){return i(e)}))}))})):Promise.reject("")},e.prototype.syncTextAddonsWithServer=function(){var e=this;return new Promise((function(t,o){return e.textAddonsServicePromise.then((function(e){return e.syncTextAddonsWithServer().then((function(e){return t(e)})).catch((function(e){console.error("Failed to synchronize text addons with server, error: ",e),o(!1)}))}))}))},e}())},135:function(e,t,o){"use strict";var n=o(78),r=o(6),i=o(8),s=new(function(){function e(){this.updateSpeed=this.updateSpeed.bind(this),this.handleSpeedContainerClick=this.handleSpeedContainerClick.bind(this)}return e.prototype.initialize=function(){this.$menuSettings=$("#settings-menu"),this.$speedControlPoint=this.$menuSettings.find(".speed-control-current-position-container"),this.$speedControlButtons=this.$menuSettings.find(".speed-stop"),this.$speedLabels=this.$menuSettings.find(".speed-stop-labels label"),this.$speedContainer=this.$menuSettings.find(".speed-container"),$(document).on("settingsUpdated",this.updateSpeed),this.$speedContainer.on("mousedown touchstart",this.handleSpeedContainerClick)},e.prototype.updateSpeed=function(){var e=i.a.get("speed");(e<0||e>2||Number.isNaN(+e))&&(e=1),this.speed=e;var t=(this.speed+"").replace("0","")+"x",o=-1;this.$speedLabels.each((function(e,n){-1!=$(n).text().indexOf(t)&&(o=e)})),this.$menuSettings.css("display","block"),this.$speedLabels.removeClass("selected"),this.$speedLabels.eq(o).addClass("selected"),this.moveToPosition(this.$speedControlButtons.eq(o)),this.$menuSettings.css("display","")},e.prototype.handleSpeedContainerClick=function(e){var t=e.pageY,o=e.pageX;"touchstart"===e.type&&(t=e.originalEvent.touches[0].pageY,o=e.originalEvent.touches[0].pageX);var n=r.a.getClosestToOffset(this.$speedControlButtons,{top:t,left:o});this.moveToPosition(n),this.$speedLabels.filter(".selected").removeClass("selected");var s=this.$speedLabels.eq(this.$speedControlButtons.index(n));s.addClass("selected");var a=parseFloat(s.text());(Number.isNaN(a)||a>2||a<0)&&(a=1),i.a.set("speed",""+a),$(document).trigger("settingsMenuItemClick")},e.prototype.moveToPosition=function(e){e&&0!=e.length&&this.$speedControlPoint.velocity({left:e.position().left-this.$speedControlPoint.width()/4},"easeOutSine","fast")},e}()),a=o(3),c=o(143),l=o(175),u=o(137),d=o(22),p=o(176),h=o(4),f=o(9),g=o(7),m=$(document),v=$(document.body),b=function(){function e(){var e=this;this.$settingsMenu=$("#settings-menu"),this.$settingsMenu.html(k),this.slideMenu=new n.a($(".settings-button.top-bar-button"),this.$settingsMenu,(function(){s.updateSpeed(),f.a.removeIconButtonGlow($(".settings-button.top-bar-button"))})),s.initialize(),c.a.initialize(),l.a.initialize(),u.a.initialize(),this.$textSizeSelectors=$(".text-size-selector"),this.$textSizeSelectorSmall=this.$textSizeSelectors.filter(".text-size-selector-small"),this.$textSizeSelectorStandard=this.$textSizeSelectors.filter(".text-size-selector-standard"),this.$textSizeSelectorLarge=this.$textSizeSelectors.filter(".text-size-selector-large"),this.$textSizeSelectorExtraLarge=this.$textSizeSelectors.filter(".text-size-selector-extra-large"),a.a.onEventWithCooldown(this.$textSizeSelectors,"click touchstart",(function(t){var o=$(t.currentTarget),n="standard";o.is(".text-size-selector-extra-large")?n="extra-large":o.is(".text-size-selector-large")?n="large":o.is(".text-size-selector-standard")?n="standard":o.is(".text-size-selector-small")&&(n="small"),i.a.set("text-size",n),e.updateTextSize()})),this.$nightModeCheckbox=$("#night-mode-checkbox"),this.$nightModeLabel=$("#night-mode-label"),this.$emailNotificationsLabel=$("#discussion-send-email-label"),this.$emailNotificationsCheckbox=$("#discussion-send-email-checkbox"),this.$showIndexedTermsLabel=$("#show-indexed-terms-label"),this.$showIndexedTermsCheckbox=$("#show-indexed-terms-checkbox"),a.a.onEventWithCooldown(this.$nightModeCheckbox,"click touchstart",(function(){return e.handleNightModeClick()})),a.a.onEventWithCooldown(this.$nightModeLabel,"click touchstart",(function(){return e.handleNightModeClick()})),a.a.onEventWithCooldown(this.$emailNotificationsLabel,"click touchstart",(function(){return e.handleEmailNotificationsClick()})),a.a.onEventWithCooldown(this.$emailNotificationsCheckbox,"click touchstart",(function(){return e.handleEmailNotificationsClick()})),a.a.onEventWithCooldown(this.$showIndexedTermsLabel,"click touchstart",(function(){return e.handleIndexedTermsClick()})),a.a.onEventWithCooldown(this.$showIndexedTermsCheckbox,"click touchstart",(function(){return e.handleIndexedTermsClick()})),m.on("settingsUpdated",(function(){e.updateTextSize(),e.setNightMode(i.a.get("night-mode")),e.setShowIndexedTerms(!i.a.get("hide-indexed-terms")),i.a.get("settings-menu-highlighted")||g.a.isLoggedIn().then((function(t){t.loggedIn&&h.a.isToday(t.userDetails.firstLoginDate)&&e.highlightSettingsButton()}))})),this.updateTextSize(),this.updateNightMode(),this.updateIndexedTermsDisplay(),g.a.isLoggedIn().then((function(t){e.visuallySetEmailNotifications(t.userDetails.receiveCommentNotificationEmails)})),this.$settingsMenu.find(".change-profile-image-link").on("click",(function(){p.a.showProfileImageUploadModal()}))}return e.prototype.initialize=function(){this.updateNightMode()},e.prototype.clean=function(){this.updateNightMode()},e.prototype.open=function(){this.slideMenu&&this.slideMenu.openMenu()},e.prototype.handleNightModeClick=function(){this.setNightMode(!this.$nightModeCheckbox.is(".selected")),m.trigger("settingsMenuItemClick")},e.prototype.handleIndexedTermsClick=function(){this.setShowIndexedTerms(!this.$showIndexedTermsCheckbox.is(".selected")),m.trigger("settingsMenuItemClick")},e.prototype.setNightMode=function(e){this.$nightModeCheckbox.toggleClass("selected",e),i.a.set("night-mode",e),this.updateNightMode()},e.prototype.setShowIndexedTerms=function(e){this.$showIndexedTermsCheckbox.toggleClass("selected",e),i.a.set("hide-indexed-terms",!e),this.updateIndexedTermsDisplay()},e.prototype.handleEmailNotificationsClick=function(){var e=!this.$emailNotificationsCheckbox.is(".selected");this.visuallySetEmailNotifications(e),this.updateReceiveCommentNotificationEmails(e)},e.prototype.updateReceiveCommentNotificationEmails=function(e){d.a.saveNotificationPreferences(e)},e.prototype.visuallySetEmailNotifications=function(e){this.$emailNotificationsCheckbox.toggleClass("selected",e)},e.prototype.updateTextSize=function(){var e=(i.a.get("text-size")||"").toLowerCase();switch(v.removeClass("text-size-small text-size-standard text-size-large text-size-extra-large"),this.$textSizeSelectors.removeClass("selected"),e){case"small":v.addClass("text-size-small"),this.$textSizeSelectorSmall.addClass("selected");break;case"standard":v.addClass("text-size-standard"),this.$textSizeSelectorStandard.addClass("selected");break;case"large":v.addClass("text-size-large"),this.$textSizeSelectorLarge.addClass("selected");break;case"extra-large":case"extra_large":v.addClass("text-size-extra-large"),this.$textSizeSelectorExtraLarge.addClass("selected");break;default:v.addClass("text-size-standard"),this.$textSizeSelectorStandard.addClass("selected")}m.trigger("textLayoutModified")},e.prototype.updateNightMode=function(){v.toggleClass("night-mode",i.a.get("night-mode")),$(document.documentElement).toggleClass("night-mode",i.a.get("night-mode"))},e.prototype.updateIndexedTermsDisplay=function(){v.toggleClass("indexed-terms-hidden",i.a.get("hide-indexed-terms"))},e.prototype.highlightSettingsButton=function(){f.a.addIconButtonGlow($(".settings-button.top-bar-button")),i.a.set("settings-menu-highlighted",!0)},e}(),k='\n<div class="slide-in-menu-container">\n<div id="settings-menu-container">\n    <ul>\n        <li class="settings-menu-user-container">\n            <div class="settings-menu-user-data-container-email pull-left"></div>\n            <div class="settings-menu-user-data-container-sign-out pull-right">\n                <a href="javascript:void(0)" class="emphasized-button sign-out-button">LOG OUT</a>\n            </div>\n            <div class="settings-menu-user-data-container-manage">\n                <a href="javascript:void(0)" class="change-profile-image-link">\n                    change your profile image\n                </a>\n                <br/>\n                <a href="https://www.manning.com/dashboard" target="_blank">\n                    view your dashboard  <i class="fa fa-external-link" aria-hidden="true"></i>\n                </a>\n                <br/>\n                <a href="https://www.manning.com/dashboard/details" target="_blank">\n                    manage account details <i class="fa fa-external-link" aria-hidden="true"></i>\n                </a>\n            </div>\n        </li>\n        <li>\n            <label class="settings-menu-header section-menu-header">TOKENS</label>\n            <ul>\n                <li>\n                    <div class="row">\n                        <div class="small-12 columns">\n                            <a href="javascript:void(0)" class="main-token-status-container" title="tokens" data-tooltip aria-haspopup="true" data-options="disable_for_touch:true">\n                                <svg viewBox="0 0 10.583333 10.583334"><use xlink:href="#token-icon"></svg>\n                                <span class="token-amount-container"></span>\n                            </a>\n                        </div>\n                    </div>\n                </li>\n                <li><div class="row"><div class="small-12 columns"></div></div></li>\n            </ul>\n        </li>\n        <li>\n            <label class="settings-menu-header section-menu-header">TEXT &amp; BACKGROUND</label>\n            <ul>\n                <li>\n                    <div class="row">\n                        <div class="small-4 columns">\n                            <label class="settings-menu-label inline">text size</label>\n                        </div>\n                        <div class="small-8 columns">\n                            <span class="text-size-selector text-size-selector-extra-large" title="extra-large"><i class="fa fa-font" aria-hidden="true"></i></span>\n                            <span class="text-size-selector text-size-selector-large" title="large"><i class="fa fa-font" aria-hidden="true"></i></span>\n                            <span class="text-size-selector text-size-selector-standard selected" title="standard"><i class="fa fa-font" aria-hidden="true"></i></span>\n                            <span class="text-size-selector text-size-selector-small" title="small"><i class="fa fa-font" aria-hidden="true"></i></span>\n                        </div>\n                    </div>\n                </li>\n                <li class="unread-text-color-menu-item">\n                    <div class="row">\n                        <div class="small-4 columns">\n                            <label class="settings-menu-label inline">unread text</label>\n                        </div>\n                        <div class="small-8 columns">\n                            <div class="checkbox-item semi-visible" title="Unread text will be grayed out">\n                                <i class="icon-i-check"></i>\n                            </div>\n                            <div class="checkbox-item full-visible" title="No difference between read and unread text">\n                                <i class="icon-i-check"></i>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n                <li>\n                    <div class="row" title="Toggle night mode while reading books">\n                        <div class="small-4 columns">\n                            <label class="settings-menu-label inline" id="night-mode-label">night mode</label>\n                        </div>\n                        <div class="small-8 columns">\n                            <div class="checkbox-item" id="night-mode-checkbox">\n                                <i class="icon-i-check"></i>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n                <li>\n                    <div class="row" title="Show indexed terms while reading books">\n                        <div class="small-4 columns">\n                            <label class="settings-menu-label inline" id="show-indexed-terms-label">show terms</label>\n                        </div>\n                        <div class="small-8 columns">\n                            <div class="checkbox-item" id="show-indexed-terms-checkbox">\n                                <i class="icon-i-check"></i>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n            </ul>\n        </li>\n        <li>\n            <label class="settings-menu-header section-menu-header">AUDIO</label>\n            <ul>\n                <li>\n                    <div class="row">\n                        <div class="small-12 columns">\n                            <label class="settings-menu-label">narration speed</label>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="small-12 columns">\n                            <div class="speed-container">\n                                <div class="speed-labels-container">\n                                    <div class="speed-stop-labels">\n                                        <label>.8x</label>\n                                        <label>.9x</label>\n                                        <label class="selected">1x</label>\n                                        <label>1.2x</label>\n                                        <label>1.4x</label>\n                                        <label>1.6x</label>\n                                    </div>\n                                </div>\n\n                                <div class="speed-control-container">\n                                    <div class="speed-line-stops-container">\n                                        <div class="line">&nbsp;</div>\n                                        <div class="speed-stops-container">\n                                            <div class="speed-stop"><div class="speed-stop-point"></div></div>\n                                            <div class="speed-stop"><div class="speed-stop-point"></div></div>\n                                            <div class="speed-stop"><div class="speed-stop-point"></div></div>\n                                            <div class="speed-stop"><div class="speed-stop-point"></div></div>\n                                            <div class="speed-stop"><div class="speed-stop-point"></div></div>\n                                            <div class="speed-stop"><div class="speed-stop-point"></div></div>\n                                        </div>\n                                        <div class="speed-control-current-position-container">\n                                            <div class="toolbar-current-position-outer-point">\n                                                <div class="toolbar-current-position-inner-point"></div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n                <li>\n                    <div class="row">\n                        <div class="small-7 columns">\n                            <label class="settings-menu-label inline first" id="browsable-stop-pause-label">pause at code/graphics</label>\n                        </div>\n                        <div class="small-5 columns">\n                            <div class="checkbox-item selected" id="browsable-stop-pause-checkbox">\n                                <i class="icon-i-check"></i>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n                <li>\n                    <div class="row">\n                        <div class="small-7 columns">\n                            <label class="settings-menu-label inline first" id="disable-live-audio-label">disable liveaudio</label>\n                        </div>\n                        <div class="small-5 columns">\n                            <div class="checkbox-item" id="disable-live-audio-checkbox">\n                                <i class="icon-i-check"></i>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n                <li>\n                    <div class="row">\n                        <div class="small-7 columns">\n                            <label class="settings-menu-label inline" id="sound-effects-label">sound effects</label>\n                        </div>\n                        <div class="small-5 columns">\n                            <div class="checkbox-item selected" id="sound-effects-checkbox">\n                                <i class="icon-i-check"></i>\n                            </div>\n                        </div>\n                    </div>\n                </li>\n            </ul>\n        </li>\n        <li>\n            <label class="settings-menu-header section-menu-header">MISC</label>\n            <div class="row" title="Toggle update page url while reading a book">\n                <div class="small-9 columns">\n                    <label class="settings-menu-label inline" id="update-history-scroll-label">update url on scroll</label>\n                </div>\n                <div class="small-3 columns">\n                    <div class="checkbox-item" id="update-history-scroll-checkbox">\n                        <i class="icon-i-check"></i>\n                    </div>\n                </div>\n            </div>\n            <div class="row" title="Send email notifications on discussion replies">\n                <div class="small-9 columns">\n                    <label class="settings-menu-label inline" id="discussion-send-email-label">receive discussion-related emails</label>\n                </div>\n                <div class="small-3 columns">\n                    <div class="checkbox-item" id="discussion-send-email-checkbox">\n                        <i class="icon-i-check"></i>\n                    </div>\n                </div>\n            </div>\n        </li>\n        <li class="settings-editor-section">\n            <label class="settings-menu-header section-menu-header">EDITOR</label>\n            <div class="row">\n                <div class="small-12 columns">\n                    <label class="settings-menu-label inline">\n                        <a href="javascript:void(0)" class="edit-book-link">edit book</a>\n                        <a href="javascript:void(0)" class="back-to-regular-book-link">back to regular book</a>\n                    </label>\n                </div>\n            </div>\n        </li>\n    </ul>\n</div>\n</div>\n';t.a=new b},136:function(e,t,o){"use strict";o.d(t,"a",(function(){return c}));var n=o(22),r=o(29),i=o(76),s=o(7),a=o(9),c=new(function(){function e(){}return e.prototype.initialize=function(){var e=this;$(document).on("click",".sign-in-button",(function(e){var t=$(e.currentTarget),o="signin";t.is(".free-preview-sign-in")?o="free-preview-sign-in":t.is(".micropurchase-sign-in")?o="microtransactions":t.is("wish-list-sign-in-button")&&(o="wishlist"),r.a.requestOpenModal("signin","",o)})).on("click",".discussion-sign-in-button",(function(){return r.a.requestOpenModal("signin","","discussion")})).on("click",".register-button",(function(e){var t="register";$(e.currentTarget).is(".free-preview-registration")&&(t="free-preview-registration"),r.a.requestOpenModal("register","",t)})).on("click",".sign-out-button",(function(){return r.a.requestLogout()})).on("requestAvatarUrlUpdate",(function(t,o){return e.updateAvatarImage(o)})),s.a.isLoggedIn().then((function(t){t.loggedIn?e.modifyUIWithLogin():e.notifyLoginNotAttempted(),i.a.fetchAndDisplayLatestTokenInfo()}))},e.prototype.modifyUIWithLogin=function(){var e=this;n.a.getUserEmail().then((function(e){$(".settings-menu-user-data-container-email").text(e),$(document.body).addClass("user-logged-in").removeClass("user-not-logged-in")}));var t=$("#top-bar-container .user-initials-container");n.a.getAvatarUrl().then((function(t){return e.updateAvatarImage(t)})),n.a.getUserInitials().then((function(e){e?(t.removeClass("hidden"),t.text(e.toUpperCase())):t.addClass("hidden")})).catch((function(e){console.log("Couldn't get initials",e),t.addClass("hidden")}))},e.prototype.modifyUIWithLogout=function(){$(document.body).addClass("user-not-logged-in").removeClass("user-logged-in")},e.prototype.notifyLoginNotAttempted=function(){this.modifyUIWithLogout(),$(document).trigger("loginNotAttempted")},e.prototype.updateAvatarImage=function(e){var t=this;if(e){var o=new Image;o.onload=function(){a.a.cacheImageIfNeeded(o),t.setAvatarBackground(e)},o.onerror=function(){a.a.loadFromCacheIfPossible(o,(function(e){}),(function(){o.onload=null,t.setAvatarBackground(o.src)}))},o.src=e}},e.prototype.setAvatarBackground=function(e){var t=$("#top-bar-container .avatar-icon");t.length>0?t.replaceWith("<div class='avatar-image' style='background-image: url("+e+")'></div>"):$("#top-bar-container .avatar-image").attr("style","background-image: url("+e+")")},e}())},137:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(8),r=new(function(){function e(){this.rewriteUrlOnScroll=!0,this.handleUpdateHistoryOnScrollClick=this.handleUpdateHistoryOnScrollClick.bind(this),this.handleSettingsUpdated=this.handleSettingsUpdated.bind(this),$(document).on("settingsUpdated",this.handleSettingsUpdated)}return e.prototype.initialize=function(){$("#update-history-scroll-checkbox, #update-history-scroll-label").on("click",this.handleUpdateHistoryOnScrollClick)},e.prototype.handleUpdateHistoryOnScrollClick=function(){this.updateValue(!$("#update-history-scroll-checkbox").is(".selected")),$(document).trigger("settingsMenuItemClick").trigger("requestUpdateHistoryOnScroll",this.rewriteUrlOnScroll)},e.prototype.handleSettingsUpdated=function(){this.updateValue(!!n.a.get("update-history-on-scroll")),$(document).trigger("requestUpdateHistoryOnScroll",!!n.a.get("update-history-on-scroll"))},e.prototype.updateValue=function(e){this.rewriteUrlOnScroll=e,$("#update-history-scroll-checkbox").toggleClass("selected",e),n.a.set("update-history-on-scroll",e)},e}())},139:function(e,t,o){"use strict";var n=o(3),r=o(15),i=o(6),s=o(9),a=o(77),c=new(function(){function e(){this.cueballSelector="img[src$='1.jpg'], img[src$='2.jpg'], img[src$='3.jpg'],\n                              img[src$='4.jpg'], img[src$='5.jpg'], img[src$='6.jpg'],\n                              img[src$='7.jpg'], img[src$='8.jpg'], img[src$='9.jpg'], img[src$='0.jpg'],\n                              img[src$='one.jpg'], img[src$='two.jpg'], img[src$='three.jpg'],\n                              img[src$='four.jpg'], img[src$='five.jpg'], img[src$='six.jpg'],\n                              img[src$='seven.jpg'], img[src$='eight.jpg'], img[src$='nine.jpg']"}return e.prototype.initialize=function(){for(var e=this,t=document.querySelectorAll(".browsable-container"),o=r.a.getTextFragmentElements(),i={},a=0;a<t.length;a++){(w=t[a]).isBrowsable=!0;var c=s.a.findFirstPreviousStopAt($(w),".readable-text","h1, h2, h3",20);c.length>0&&(c[0].nextBrowsable=w);var l=s.a.findFirstNext($(w),".readable-text",10);l.length>0&&(l[0].previousBrowsable=w);var u=w.querySelector("h5");if(u){var d=this.getBrowsableHeadingKeyword(u.textContent);d&&(i[d]=w,i[d.toLowerCase()]=w)}}for(var p=0,h=o;p<h.length;p++){var f=h[p],g=$(f),m=this.extractBrowsableRegexKeywords(g.text()),v=[];if(this.containsCueballs(g)){(w=s.a.findFirstPreviousStopAt(g,".listing-container","h1, h2, h3",20)[0])&&(w.isCueballBrowsable=!0,v.push(w),f.listingContainer=w);var b=g.find("img");b.addClass("clickable"),n.a.onEventWithCooldown(b,"click touchstart",(function(t){return e.handleCueBallClick(t)}))}for(var k=0,y=m;k<y.length;k++){(w=i[y[k]])&&-1==v.indexOf(w)&&v.push(w)}if(0==v.length&&g.find(".codeFragment").length){var w,P=s.a.findFirstPreviousStopAt(g,".browsable-container","h1, h2, h3",20);if(P.find("form").length||P.is(".listing-container"))(w=P[0])&&v.push(w)}0!=v.length&&(f.browsables=v)}},e.prototype.handleCueBallClick=function(e){var t=e.target,o=$(t).parents(".readable-text")[0];if(o){var n=r.a.getMostImportantBrowsable(o.browsables);if(n){n.annotatedListing&&n.annotatedListing.goToAnimationStep(r.a.extractFileNameNumber(t.src)),$(n).closest(".focus-off").removeClass("focus-off");var c=i.a.canBothElementsFitIntoScreen(o,n)&&s.a.precedesElement(n,o)?o:n;a.a.scrollToElement(c)}}},e.prototype.containsCueballs=function(e){for(var t=e.find("img"),o=0;o<t.length;o++)if(t.eq(o).is(this.cueballSelector))return!0;return!1},e.prototype.getBrowsableHeadingKeyword=function(e){for(var t=this.extractBrowsableRegexKeywords(e),o=0;o<t.length;o++)if(0==e.indexOf(t[o]))return t[o]},e.prototype.extractBrowsableRegexKeywords=function(e){var t=[];return r.a.browsableRegExes.forEach((function(o){var n=e.match(o);n&&n.length>0&&(t=t.concat(n))})),t},e}());t.a=c},14:function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));var n=new(function(){function e(){}return e.prototype.getItem=function(e){try{return localStorage.getItem(e)}catch(t){return console.log("Error getting item from local storage",e),""}},e.prototype.setItem=function(e,t){try{return localStorage.setItem(e,t)}catch(t){return console.log("Error setting item to local storage",e),""}},e.prototype.saveTemporarily=function(e,t,o){try{return localStorage.setItem(e,JSON.stringify({value:JSON.stringify(t),timestamp:(new Date).getTime()+o})),t}catch(e){return t}},e.prototype.loadTemporarily=function(e){try{var t=JSON.parse(localStorage.getItem(e));return!!t&&((new Date).getTime()<t.timestamp&&JSON.parse(t.value))}catch(e){return!1}},e.prototype.remove=function(e){try{localStorage.removeItem(e)}catch(e){}},e}())},141:function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));var n=o(3),r=o(1),i=o(17),s=o(5),a=new(function(){function e(){}return e.prototype.initialize=function(){this.loadCodeOnInteraction=this.loadCodeOnInteraction.bind(this),n.a.onPassiveEvent(document.querySelectorAll(".search-menu-button"),["mouseenter","touchstart","click"],this.loadCodeOnInteraction)},e.prototype.load=function(){this.getSource().then((function(e){return e.SearchMenu.initialize(i.a.book,i.a.bookElement)}))},e.prototype.loadCodeOnInteraction=function(e){var t=this,o="click"==e.type||r.b.isTouchEventOnTouchDevice(e.type);n.a.offPassiveEvent(document.querySelectorAll(".search-menu-button"),[e.type],this.loadCodeOnInteraction),this.getSource().then((function(r){var s=r.SearchMenu;o&&(s.initialize(i.a.book,i.a.bookElement),s.showSearch()),n.a.offPassiveEvent(document.querySelectorAll(".search-menu-button"),o?["mouseenter","touchstart","click"]:[e.type],t.loadCodeOnInteraction)}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(42),o.e(0),o.e(2),o.e(52),o.e(31)]).then(o.bind(null,351))},e}())},142:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));o(339);var n='\n<div class="download-progress-button">\n  <div class="download-progress-button-icon-wrapper dont-propagate-click">\n    <i class="fa fa-cloud-download download-progress-start-download-icon dont-propagate-click"></i>\n    <i class="fa fa-stop download-progress-stop-download-icon dont-propagate-click"></i>\n    <i class="fa fa-check download-progress-downloaded-icon dont-propagate-click"></i>\n    <i class="fa fa-repeat download-progress-retry-download-icon dont-propagate-click"></i>\n  </div>  \n  <div class="download-progress-button-progress-wrapper">\n    <svg class="download-progress-ring" width="{{size}}" height="{{size}}">\n      <circle class="download-progress-ring-circle" stroke="rgb(120,192,162)" stroke-width="{{strokeWidth}}"\n              fill="transparent" r="{{radius}}" cx="{{circleOffset}}" cy="{{circleOffset}}"/>\n    </svg>\n  </div>\n</div>',r=function(){function e(e,t){void 0===t&&(t={}),this.container=e,this.container.innerHTML=Mustache.render(n,{size:t.isSmall?30:40,radius:t.isSmall?12:18,circleOffset:t.isSmall?15:20,strokeWidth:t.isSmall?2:3})}return e.prototype.setProgress=function(e){this.markAsDownloading();var t=this.container.querySelector("circle"),o=2*t.r.baseVal.value*Math.PI;t.style.strokeDasharray=o+" "+o,t.style.strokeDashoffset=""+o;var n=o-e/100*o;t.style.strokeDashoffset=""+n},e.prototype.markAsDownloading=function(){$(this.container).find(".download-progress-button").removeClass("downloaded download-error").addClass("downloading").attr("title","downloading ...")},e.prototype.markAsDownloaded=function(){$(this.container).find(".download-progress-button").removeClass("downloading download-error").addClass("downloaded").attr("title","downloaded to your device")},e.prototype.markAsNotDownloaded=function(){$(this.container).find(".download-progress-button").removeClass("downloaded downloading download-error").attr("title","download to your device")},e.prototype.markAsError=function(){$(this.container).find(".download-progress-button").removeClass("downloaded downloading").addClass("download-error").attr("title","error downloading")},e}()},143:function(e,t,o){"use strict";o.d(t,"a",(function(){return i}));var n=o(8),r=$(document),i=new(function(){function e(){this.handleCheckboxClick=this.handleCheckboxClick.bind(this),this.updateBrowsableStopMode=this.updateBrowsableStopMode.bind(this)}return e.prototype.initialize=function(){this.$browsableStopCheckbox=$("#browsable-stop-pause-checkbox"),this.$browsableStopLabel=$("#browsable-stop-pause-label"),this.$browsableStopCheckbox.on("click",this.handleCheckboxClick),this.$browsableStopLabel.on("click",this.handleCheckboxClick),r.on("settingsUpdated",this.updateBrowsableStopMode),this.updateBrowsableStopMode()},e.prototype.updateBrowsableStopMode=function(){var e=n.a.get("browsable-pause-type");this.browsablePauseType!=e&&(this.browsablePauseType=e,this.syncUI())},e.prototype.handleCheckboxClick=function(){r.trigger("settingsMenuItemClick"),this.$browsableStopCheckbox.is(".selected")?this.setBrowsablePauseTypeToPause():this.setBrowsablePauseTypeToFullStop()},e.prototype.isBrowsablePause=function(){return"browsable-pause-pause"==this.browsablePauseType||"PAUSE"==this.browsablePauseType},e.prototype.isBrowsableStop=function(){return"browsable-pause-stop"==this.browsablePauseType||"STOP"==this.browsablePauseType},e.prototype.setBrowsablePauseTypeToFullStop=function(){this.setBrowsablePauseType("browsable-pause-stop")},e.prototype.setBrowsablePauseTypeToPause=function(){this.setBrowsablePauseType("browsable-pause-pause")},e.prototype.setBrowsablePauseType=function(e){n.a.set("browsable-pause-type",e),this.updateBrowsableStopMode()},e.prototype.syncUI=function(){this.$browsableStopCheckbox.toggleClass("selected","browsable-pause-stop"===this.browsablePauseType)},e}())},144:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(5),r=new(function(){function e(){}return e.prototype.initialize=function(e,t){this.getSource().then((function(o){return o.BooksMenu.initialize(e,t)}))},e.prototype.clean=function(){this.sourcePromise&&this.sourcePromise.then((function(e){return e.BooksMenu.clean()}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=n.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return o.e(12).then(o.bind(null,353))},e}())},15:function(e,t,o){"use strict";var n=o(34),r=o(6),i=o(9),s=o(139),a=o(3),c=o(4),l=o(16),u=o(0),d=o(95),p=o(66),h=o(1),f=function(){function e(){this.listingRegEx=/listing(\s)+[0-9]+\.[0-9]+/gi,this.figureRegEx=/figure(\s)+[0-9]+\.[0-9]+/gi,this.tableRegEx=/table(\s)+[0-9]+\.[0-9]+/gi,this.browsableRegExes=[this.listingRegEx,this.figureRegEx,this.tableRegEx]}return e.prototype.createBookFromBookData=function(e){var t=new n.a(e.id,e.manningId,e.title,e.shortName,e.description,e.lastUpdateDate,e.exercisesComingSoon,e.programmingLanguage,e.userOwnsBook,e.userOwnsAudio,u.a.getBookCoverUrl(e.shortName),u.a.getBookUrl(e.slug),e.meap,e.open,e.latestMeapVersion||0,e.highResolutionCover);return t.slug=e.slug,t.offlineFileSizes=e.offlineFileSizes,t.openChapters=e.openChapters||[],t.cleanTitle=this.cleanBookTitle(t.title),t.authors=e.authors,t.isReview=!!e.isReview,t.userCanViewReviews=!!e.userCanViewReviews,t.userIsReviewer=!!e.userIsReviewer,t.userOwnsPBook=!!e.userOwnsPBook,t.categories=e.categories||"",t.hasAudio=!!e.hasAudio,t.isFreeEbook=!!e.isFreeEbook,t.hasExercises=!!e.hasExercises,t.hasTextAddendums=!!e.hasTextAddendums,t.hasKnowledgeGraph=!!e.hasKnowledgeGraph,t.isKnowledgeGraphAccessible=!!e.isKnowledgeGraphAccessible,t.userOwnsAudio=!!e.userOwnsAudio,t.userIsEditor=!!e.userIsEditor,t.userCanViewReviews=!!e.userCanViewReviews,t.userIsReviewer=!!e.userIsReviewer,t.isReview=!!e.isReview,t.isParagraphByParagraphUnlockDisabled=!!e.isParagraphByParagraphUnlockDisabled,t.hasBeenDownloaded=!!e.hasBeenDownloaded,null!=e.offlineFileSizes&&(t.offlineFileSizes=e.offlineFileSizes),t},e.prototype.createBookElement=function(e,t,o,n){var r=new d.a(t,e.id,e.title,e.shortName,e.userOwnsBookElement,e.ordinal,e.wordCount,e.freeWordCount,e.audioLocation,e.subtitlesLocation,e.isOpen,e.meapVersion,e.location,e.isBookOverview);return r.videos=e.videos,r.exercisesLocation=e.exercisesLocation,r.reviewVersion=e.reviewVersion,o&&(r.previousBookElement=new p.a(o.shortName,o.title,o.link||u.a.getBookElementUrl(t.slug,o.shortName,r.meapVersion,r.reviewVersion))),n&&(r.nextBookElement=new p.a(n.shortName,n.title,n.link||u.a.getBookElementUrl(t.slug,n.shortName,r.meapVersion,r.reviewVersion),n.introItems)),r},e.prototype.groupSmallListItemsIfNecessary=function(e){for(var t=[],o=[],n=[],r=0,i=e;r<i.length;r++){var s=i[r],a=s.closest("ul, ol");if(0==a.length)t.push([s]);else if(this.isListWithLargeItems(a))t.push([s]);else{var c=a.get(0),l=o.indexOf(c);-1==l&&(o.push(c),n.push([]),l=o.length-1),n[l].push(s)}}return t.concat(n)},e.prototype.insertLoadingBoxes=function(){try{var e=document.querySelector("#book-content-main-row #book-markup-container");if(!e)return;for(var t=e.querySelectorAll("h2, h3"),o=0;o<t.length;o++){var n=t[o].parentElement;if(null==n.nextElementSibling||null!=n.nextElementSibling.querySelector("h2, h3")){var r=document.createElement("div");r.innerHTML=c();for(var i=0;i<r.children.length;i++)s=r.children[i],(a=n).parentNode.insertBefore(s,a.nextSibling)}}}catch(e){}var s,a;function c(){for(var e=l(1,6),t=[0,10,20,30,40,50,70,90],o="",n=0;n<=e;n++)o+='<div class="readable-text"><span class="placeholder" style="margin-right: '+t[l(0,t.length-1)]+'px"><span class="placeholder-animated-background">&nbsp;</span></span> </div>';return o}function l(e,t){return Math.floor(Math.random()*(t-e+1)+e)}},e.prototype.getHeadingSectionCost=function(e,t,o){if(null==e||null==t||null==o)return 0;var n=l.a.isChapterOrAppendix(t.text().trim())?e.tokenPrice:this.getSectionSubsectionTokenPrice(l.a.extractNumbering(t.text().trim()),e.sectionSubsectionPrices);return n<=0?0:0==this.getContainedScrambledAndUnscrambledParagraphs(t,o).scrambledParagraphs.length?0:n},e.prototype.getSectionSubsectionTokenPrice=function(e,t){if(null==t||0==t.length)return 0;var o=t.find((function(t){return t.shortName==e}));return null!=o?o.tokenPrice:0},e.prototype.getSectionSubsectionFullTokenPrice=function(e,t){if(null==t||0==t.length)return 0;var o=t.find((function(t){return t.shortName==e}));return null!=o?o.fullTokenPrice:0},e.prototype.cleanBookTitle=function(e,t){if(void 0===t&&(t=!1),!e)return e;try{var o=e.indexOf(":");e=-1!=o?e.substr(0,o):e,t&&(e=e.replace(/second edition/i,"2nd").replace(/third edition/i,"3rd").replace(/fourth edition/i,"4th").replace(/fifth edition/i,"5th").replace(/sixth edition/i,"6th").replace(/seventh edition/i,"7th").replace(/eight edition/i,"8th").replace(/ninth edition/i,"9th"));var n=e.toLowerCase().indexOf("meap");return-1!=n?e.substr(0,n):e}catch(t){return e}},e.prototype.updateTitle=function(e){e=(e||"").trim(),document.title=e||"livebook"},e.prototype.updateMetaContent=function(e){e?$(".meta-description").attr("content",e):this.resetMetaContent()},e.prototype.updateMetaImage=function(e){e?$(".meta-image").attr("content",e):this.resetMetaImage(),$(".meta-image").attr("content",e)},e.prototype.resetMetaImage=function(){$(".meta-image").attr("content",u.a.getLivebookCdn()+"assets/images/cover.png")},e.prototype.updateCanonicalLink=function(e,t,o){$("link[rel='canonical']").attr("href",u.a.getAbsoluteBookElementUrl(e,t,o))},e.prototype.updateStructureScript=function(){},e.prototype.resetStructureScript=function(){},e.prototype.resetMetaContent=function(){$(".meta-description").attr("content","liveBooks are enhanced books. They add narration, interactive exercises, code execution, and other features to eBooks.")},e.prototype.matchesListingRegEx=function(e){return this.matchesRegEx(e,this.listingRegEx)},e.prototype.matchesFigureRegEx=function(e){return this.matchesRegEx(e,this.figureRegEx)},e.prototype.matchesTableRegEx=function(e){return this.matchesRegEx(e,this.tableRegEx)},e.prototype.matchesRegEx=function(e,t){return!(null==e||""==e||!e.match)&&(null!=t&&e.match(t))},e.prototype.matchesBrowsableRegEx=function(e){return!(!e||!e.match)&&!!(e.match(this.listingRegEx)||e.match(this.figureRegEx)||e.match(this.tableRegEx))},e.prototype.getContainedScrambledAndUnscrambledParagraphs=function(e,t){var o={scrambledParagraphs:[],unscrambledParagraphs:[],neverScrambledParagraphs:[]},n=e.text().trim();if(l.a.isChapterOrAppendix(n)){for(var r=document.querySelectorAll(".readable-text.scrambled"),i=0;i<r.length;i++)o.scrambledParagraphs.push(r[i]);var s=document.querySelectorAll(".readable-text.unscrambled");for(i=0;i<s.length;i++)o.unscrambledParagraphs.push(s[i]);var a=document.querySelectorAll(".readable-text:not(.unscrambled):not(.scrambled)");for(i=0;i<a.length;i++)o.neverScrambledParagraphs.push(a[i]);return o}var c=t.index(e),u=t.slice(c+1),d=l.a.isSection(n),p=l.a.isSubsection(n),h=null;u.each((function(e,t){var o=$(t),n=o.text().trim();if(d){if(l.a.isSection(n))return h=o,!1}else if(p&&(l.a.isSubsection(n)||l.a.isSection(n)))return h=o,!1}));var f=parseInt(e.attr("refid")),g=parseInt(null!=h&&h.length>0?h.attr("refid"):$(".readable-text.scrambled:last-of-type, .readable-text.unscrambled:last-of-type").last().attr("refid"));if(!Number.isNaN(f)&&!Number.isNaN(g))for(i=f;i<=g;i++){var m=document.getElementById(""+i),v=$(m);v.is(".readable-text")&&(v.is(".scrambled")?o.scrambledParagraphs.push(m):v.is(".unscrambled")?o.unscrambledParagraphs.push(m):v.hasClass("scrambled")||v.hasClass("unscrambled")||o.neverScrambledParagraphs.push(m))}return o},e.prototype.restoreOriginalHtml=function(e){if(e&&e.originalInnerHTML){var t=$(e);t.find(".highlighted-text").off(),e.innerHTML=e.originalInnerHTML;var o=t.find("img");o.addClass("clickable"),a.a.onEventWithCooldown(o,"click touchstart",(function(e){return s.a.handleCueBallClick(e)}))}},e.prototype.getCodeMirrorSyntaxHighlightMode=function(e,t){void 0===t&&(t="");var o=(e.programmingLanguage||"").toLowerCase();return"n/a"!==o?o:""},e.prototype.getTextFragmentDuration=function(e){if(!e||!e.cues||0==e.cues.length)return 0;var t=e.cues;return t[t.length-1].endTime-t[0].startTime},e.prototype.extractFileNameNumber=function(e){if(!e||!e.match)return null;var t=e.match(/([0-9]+)\.[a-zA-Z]+$/);return!t||t.length<2?this.extractNumberFromStringFileNameNumber(e):parseInt(t[1])},e.prototype.extractNumberFromStringFileNameNumber=function(e){var t=e.match(/([a-zA-Z]+)\.[a-zA-Z]+$/);if(!t||t.length<2)return null;switch(t[1].trim().toLowerCase()){case"one":return 1;case"two":return 2;case"three":return 3;case"four":return 4;case"five":return 5;case"six":return 6;case"seven":return 7;case"eight":return 8;case"nine":return 9}return null},e.prototype.hasBrowsables=function(e){return!!e&&(null!=e.browsables&&e.browsables.length>0)},e.prototype.getMostImportantBrowsable=function(e){if(!e||0==e.length)return null;if(1==e.length)return e[0];for(var t=null,o=null,n=0;n<e.length;n++){var r=e[n];$(r).is(".listing-container")?t=r:o=r}return t||o},e.prototype.getMatchingBrowsable=function(e,t){if(!e||null==e.length)return null;for(var o=null,n=0;n<e.length;n++){if(o=e[n],-1!=$(o).find("h5").text().indexOf(t))return o}return o},e.prototype.getNextCueForPlaying=function(e){if(!e)return null;var t=!1;return $(e).is(".fragment-played")&&(t=!0),!t&&e.lastPlayedCue?e.lastPlayedCue:e.cues?e.cues[0]:null},e.prototype.getAllFocusableElements=function(){var e=$("#book-markup-container"),t=[];return e.children().each((function(e,o){if(0!=e&&-1==o.className.indexOf("introduction-summary")){var n=$(o);n.is(".callout-container, ul, ol")?(n.is(".callout-container")&&t.push(o),n.find(".readable-text").each((function(e,o){t.push(o)}))):t.push(o)}})),t},e.prototype.getTextFragmentElements=function(){return Array.prototype.slice.call(document.querySelectorAll(".readable-text"))},e.prototype.getBookmarkableAndNotableItems=function(){for(var e=this.getTextFragmentElements(),t=1;t<e.length&&"LI"===e[t].nodeName;t++)e.splice(t,1),t--;return e},e.prototype.getTextElementPositionPointCenter=function(e){return e&&0!==e.length?e.position().top+e.height()/2:0},e.prototype.getTextElementPositionPointTop=function(e){if(!e||0===e.length)return 0;var t=e.position().top;if(e.find("h1").length>0&&(t+=r.a.getElementLineHeight(e)/2),e.find("h2").length>0&&(t+=r.a.getElementLineHeight(e)/11),e.is(".collapsible-panel")){var o=e.find(".button-collapsible-panel");t=e.position().top+1.5*o.height()}return e.is(".listing-line-group")&&(t=e.offset().top-$("#book-main-content-container").offset().top-r.a.getElementLineHeight(e)),t},e.prototype.elementContainsCueball=function(e,t){if(!e)return!1;var o=i.a.getAllDescendantTextNodes(e),n=i.a.createTextNodeTextRanges(o),r=n.value.indexOf(t),s=r+t.length;if(-1===r&&(s=(r=n.value.indexOf(t.replace("<","&lt;").replace(">","&gt;")))+t.length,-1===r))return!1;for(var a=i.a.splitRanges(n,r,s).matchingRanges,c=0;c<a.length;c++){var l=a[c],u=l.textNode;if(u&&u.nextSibling&&(c!=a.length-1||l.end<=1.1*s))for(var d=u.nextSibling;null!=d;){if("IMG"==d.nodeName)return this.extractFileNameNumber(d.src);if("#text"===d.nodeName&&d.textContent.trim())break;d=d.nextSibling}}return!1},e.prototype.getOwnerSectionHeading=function(e,t){if(null==e||0==e.length)return null;var o=e.text().trim();if(!l.a.isSubsection(o))return null;for(var n=t.index(e)-1;n>=0;n--){var r=t.eq(n);if(l.a.isSection(r.text().trim()))return r}return null},e.prototype.getHeadings=function(){return this.getSecAndSubsecFragElements().filter((function(e,t){var o=$(t),n=o.text().trim();return o.children("h1").length>0||l.a.isChapterOrAppendix(n)||l.a.isSection(n)||l.a.isSubsection(n)}))},e.prototype.getSecAndSubsecFragElements=function(){return $(this.getTextFragmentElements()).filter((function(e,t){return $(t).children("h1, h2, h3, h4").length>0}))},e.prototype.figureOutSectionOrSubsectionFromRefId=function(e){var t=$(this.getSecAndSubsecFragElements()).filter((function(t,o){return parseInt($(o).attr("refId"))<e})).last();return/(([0-9]+\.?)+)/.test(t.children("h1, h2, h3, h4").first().text())?t.children("h1, h2, h3, h4").first().text().match(/(([0-9]+\.?)+)/)[0]:void 0},e.prototype.getClosestHeading=function(e,t){var o=parseInt(e.attr("refid"));if((!o||Number.isNaN(o))&&(e.is("ul, ol")&&(o=parseInt(e.children().first().attr("refid"))),!o||Number.isNaN(o)))return null;var n=null;return t.each((function(e,t){var r=$(t);if(parseInt(r.attr("refid"))>o)return!1;n=r})),n},e.prototype.expandListOfScrambledParagraphsIfNecessary=function(e){for(var t=[],o=0,n=e;o<n.length;o++){var r=n[o].closest("ul, ol");if(r.length>0){var i=r.find("li.readable-text.scrambled");this.isListWithLargeItems(r)||i.each((function(e,o){t.push($(o))}))}}for(var s={},a=[],c=0,l=e.concat(t);c<l.length;c++){var u=l[c],d=u.attr("refid");s[d]||(s[d]=!0,a.push(u))}return a.sort((function(e,t){return parseInt(e.attr("refid"))-parseInt(t.attr("refid"))})),a},e.prototype.isListWithLargeItems=function(e){if(null==e||0==e.length)return!1;for(var t=e.find("li.readable-text"),o=0;o<t.length;o++)if(c.a.getNumberOfWords(t.eq(o).text())>=40)return!0;return!1},e.prototype.updateBookOverviewIfNecessary=function(e,t){if(null!=e&&null!=t&&t.isBookOverview){var o=e.highResolutionCover;o=o?u.a.getMarketplaceHiqhQualityProductCoverUrl(o):e.bookCoverPath,h.b.isApp()&&(t.content=t.content.replace(/\/assets\/images\//g,"assets/images/")),t.content=(-1==t.content.indexOf("book-overview-cover-container")?'<div class="browsable-container figure-container book-overview-cover-container" refid=\'0\' id=\'0\'>\n                               <img class="book-overview-cover" onload-image-src="'+o+'" src="'+u.a.getLivebookCdn()+'assets/images/cover-large.png" alt="book cover"/>\n                             </div>':"")+t.content+(-1==t.content.indexOf("toc-summary-container")?'<div class="browsable-container toc-summary-container" refid=\'100000\' id=\'100000\'>\n                                  <h5>In this book </h5>\n                                  <div class="toc-summary-content">\n                                      <div class="toc-summary-loading-container">\n                                          <i class="fa fa-spin fa-circle-o-notch fa-3x fa-fw"></i>\n                                      </div>\n                                  </div>\n                               </div>':"")}},e}();t.a=new f},16:function(e,t,o){"use strict";var n=function(){function e(){this.titleRegExes=[/Chapter (\d+\.?)\s*:?/,/(?:Part|Section|Lesson|Unit) (\d+\.?)/,/Appendix ([A-Z]\.?)/,/^\d+(\.)?\s+/],this.sectionSubsectionRegEx=/(\d+\.?)+/,this.appendixSectionSubsectionRegEx=/([A-Z]\.?(?:\d+\.?)+)/,this.bookElementTypeRegex=/^(?:Chapter|Part|Section|Lesson|Unit|Appendix)\s+(?:\d+\.?)/,this.bookElementTypeNumberingRegex=/^\d+\.?\s+/,this.bookElementAppendixRegex=/^[A-Z]\.?\s+/,this.sectionRegEx=/^((\d+|[A-Z])\.)(\d+(\.)?)/,this.subsectionRegEx=/^((\d+|[A-Z])\.)(\d+\.)(\d+(\.)?)/}return e.prototype.isSpecialPathPartInsteadOfBookElement=function(e){return this.isSpecialDiscussionPart(e)||this.isDiscussionErrata(e)||this.isSpecialCommentPart(e)},e.prototype.isSpecialDiscussionPart=function(e){return"discussion"==e||"discussions"==e},e.prototype.isDiscussionErrata=function(e){return"discussion-errata"==e},e.prototype.isSpecialCommentPart=function(e){return 0==(e||"").indexOf("comment-")},e.prototype.isSpecialFreeEbookOpenPart=function(e){return"fb"==e},e.prototype.isChapterOrAppendix=function(e){if(!e)return!1;for(var t=0,o=this.titleRegExes;t<o.length;t++){var n=o[t];if(e.match(n))return!0}return!1},e.prototype.isSection=function(e){return!!e&&(null!=e.match(this.sectionRegEx)&&!this.isSubsection(e))},e.prototype.isSubsection=function(e){return!!e&&null!=e.match(this.subsectionRegEx)},e.prototype.extractNumbering=function(e){if(!e||!e.trim())return"";for(var t=null,o=0,n=this.titleRegExes;o<n.length;o++){var r=n[o];if((t=e.match(r))&&t.length>=2)return t[1]}return(t=e.match(this.appendixSectionSubsectionRegEx))?t[0]:(t=e.match(this.sectionSubsectionRegEx))?t[0]:""},e.prototype.getBookElementOrdinalFromToc=function(e,t){var o=e.frontMatter,n=e.parts,r=e.backMatter,i=0;if(o&&o.length)for(var s=0;s<o.length;s++,i++)if(o[s].shortName==t)return i;if(n&&n.length)for(s=0;s<n.length;s++,i++){var a=n[s];if(a.shortName==t)return i;if(a.chapters&&a.chapters.length)for(var c=0;c<a.chapters.length;c++,i++)if(a.chapters[c].shortName==t)return i}if(r&&r.length)for(s=0;s<r.length;s++,i++)if(r[s].shortName==t)return i;return-1},e.prototype.extractTitle=function(e){for(var t=0,o=this.titleRegExes;t<o.length;t++){var n=o[t],r=e.match(n);if(r&&r[0]){e=e.replace(r[0],"");break}}return e.replace(this.extractNumbering(e),"")},e.prototype.extractBookElementType=function(e){var t=e.match(this.bookElementTypeRegex);return null!=t?(t[0]||"").trim():null!=(t=e.match(this.bookElementTypeNumberingRegex))?"Chapter "+(t[0]||"").trim():null!=(t=e.match(this.bookElementAppendixRegex))?"Appendix "+(t[0]||"").trim():""},e.prototype.extractCleanBookElementTitle=function(e){if(!e)return e;for(var t=0,o=this.titleRegExes;t<o.length;t++){var n=o[t],r=e.match(n);if(r)return e.replace(r[0],"")}var i=e.match(this.bookElementAppendixRegex);return null!=i?e.replace(i[0],""):e},e.prototype.beautifyBookElementShortName=function(e,t){if(void 0===t&&(t=!1),!e)return e;var o=e.replace(/-/g," ");return t&&(o=o.replace(/./,o.toUpperCase()[0])),o},e}();t.a=new n},17:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(14),r=new(function(){function e(){this.isShoppingCartBusy=!1,this.isUnlockingWholeContentThroughPointingLink=!1,this.shouldImmediatelyPlayLiveaudio=!1,this.isShoppingCartDisabledInApp=!0,this.refreshDataAfter=24e5,this.zenModeShow=!1}return e.prototype.isFreePreviewActive=function(){return this.isInFreePreview},e.prototype.setFreePreviewActive=function(e){return this.isInFreePreview=e},e.prototype.isFirstTimeBookVisit=function(){if(null==this.book)return!1;try{return!JSON.parse(n.a.getItem("VISITED_BOOKS")||"{}")[this.book.shortName]}catch(e){return!1}},e.prototype.markCurrentBookAsVisited=function(){if(null!=this.book)try{var e=JSON.parse(n.a.getItem("VISITED_BOOKS")||"{}");e[this.book.shortName]=!0,n.a.setItem("VISITED_BOOKS",JSON.stringify(e))}catch(e){return!1}},e}())},174:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(5),r=new(function(){function e(){}return e.prototype.buildAndSaveBookIndex=function(e){this.getSearchFallbackProviderSource().then((function(t){return t.SearchFallbackProvider.buildAndSaveBookIndex(e)}))},e.prototype.getSearchFallbackProviderSource=function(){return this.searchFallbackSourcePromise||(this.searchFallbackSourcePromise=n.a.importWebpackModuleWithRetry(this.constructSearchFallbackSourcePromise)),this.searchFallbackSourcePromise},e.prototype.constructSearchFallbackSourcePromise=function(){return Promise.all([o.e(51),o.e(30)]).then(o.bind(null,349))},e}())},175:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(8),r=new(function(){function e(){this.handleLiveaudioDisabledClick=this.handleLiveaudioDisabledClick.bind(this)}return e.prototype.initialize=function(){$("#disable-live-audio-checkbox, #disable-live-audio-label").on("click",this.handleLiveaudioDisabledClick)},e.prototype.handleLiveaudioDisabledClick=function(){this.setLiveaudioDisabled(!$("#disable-live-audio-checkbox").is(".selected")),$(document).trigger("settingsMenuItemClick")},e.prototype.setLiveaudioDisabled=function(e){$("#disable-live-audio-checkbox").toggleClass("selected",e),n.a.set("live-audio-disabled",e),$("body").toggleClass("live-audio-disabled",e)},e}())},176:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(5),r=new(function(){function e(){}return e.prototype.showProfileImageUploadModal=function(){this.getSource().then((function(e){e.ProfileImageUploadModal.show()}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=n.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(3),o.e(0),o.e(1),o.e(50),o.e(28)]).then(o.bind(null,352))},e}())},178:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(125),r=new(function(){function e(){this.inactivityInterval=3e5,this.refreshAllInactivityInterval=24e5}return e.prototype.initialize=function(){var e=this;this.lastActiveTime=Date.now(),n({callback:function(){$(document).trigger("appIdle")},activeCallback:function(){var t=Date.now()-e.lastActiveTime;e.lastActiveTime=Date.now(),t>e.refreshAllInactivityInterval&&$(document).trigger("appActivatedAfterLongTime"),$(document).trigger("appActivated",t)},idleTime:this.inactivityInterval})},e.prototype.initalizeFreePreviewActivityTracker=function(e,t){null!=this.freePreviewActivityTimer&&this.freePreviewActivityTimer.destroy(),this.freePreviewActivityTimer=n({callback:e,activeCallback:t,idleTime:3e4})},e.prototype.destroyFreePreviewActivityTracker=function(){null!=this.freePreviewActivityTimer&&(this.freePreviewActivityTimer.destroy(),this.freePreviewActivityTimer=null)},e}())},179:function(e,t,o){"use strict";var n=o(1),r=o(0),i=o(138),s=o.n(i),a=o(8),c=function(){function e(){}return e.prototype.syncWithServer=function(e){return new Promise((function(t,o){r.a.postToOurBackend(r.a.getAbsoluteUrl("api/events/syncReadingData"),(function(){return t()}),(function(e){return o(e)}),{items:e},!0,!0,!1,!0)}))},e.prototype.logReading=function(e,t,o,n,i,c,l,u,d,p){return new Promise((function(h,f){"visible"==s.a.state()&&(a.a.get("position-and-reading-info-disabled")||r.a.postToOurBackend(r.a.getAbsoluteUrl("api/events/view"),(function(e){return h(e)}),(function(e){return f(e)}),{bookShortName:e,element:t,elementPosition:o,bookSectionNumber:n,userOwnsBook:i,meapVersion:l,manningId:u,sessionId:d,readLogIntervalDuration:p,isOpenChapter:c}))}))},e}(),l=o(4),u=function(){function e(e){this.webService=e}return e.prototype.syncWithServer=function(e){var t=this;return new Promise((function(o,n){t.getItemsMap().then((function(r){null!=(e=e||t.getReadingLogItemsFromItemsMap(r))&&e.length>0?t.webService.syncWithServer(e).then((function(){t.saveItemsMap({}),o()})).catch((function(e){return n(e)})):o()})).catch((function(e){return n(e)}))}))},e.prototype.logReading=function(e,t,o,r,i,s,a,c,l,u){return n.b.isConnected()?this.webService.logReading(e,t,o,r,i,s,a,c,l,u):this.storeItem(e,t,o,r,i,a,c,l,u)},e.prototype.storeItem=function(e,t,o,r,i,s,a,c,u){var d=this;return new Promise((function(t,o){d.getItemsMap().then((function(o){var r=l.a.getTodaysDateAsString();o[r]||(o[r]={}),o[r][e]?o[r][e].numberOfTicks++:o[r][e]={bookShortName:e,date:r,manningId:a,numberOfTicks:1,readLogIntervalDuration:u,userOwnsBook:i,platform:n.b.getPlatformAndOsString()},d.saveItemsMap(o).then((function(){return t()}))})).catch((function(e){return o(e)}))}))},e.prototype.getItemsMap=function(){var e=this;return new Promise((function(t,o){e.getUtils().readFile(e.getUtils().getReadingLogLocation()).then((function(e){return t(JSON.parse(e||"{}"))})).catch((function(e){return o(e)}))}))},e.prototype.saveItemsMap=function(e){return this.getUtils().writeToFile(this.getUtils().getReadingLogLocation(),JSON.stringify(e))},e.prototype.getReadingLogItemsFromItemsMap=function(e){var t=[];for(var o in e)for(var n in e[o])t.push(e[o][n]);return t},e.prototype.getUtils=function(){return window.fileSystemUtils},e}();o.d(t,"a",(function(){return d}));var d=new(function(){function e(){this.servicePromise=new Promise((function(e,t){n.b.loadDeviceInfo().then((function(t){e(function(e){var t=new c;switch(e){case n.a.Cordova:case n.a.Electron:return new u(t);case n.a.Browser:default:return t}}(t.platform))})).catch((function(e){return t(e)}))}))}return e.prototype.syncWithServer=function(){var e=this;return new Promise((function(t,o){e.servicePromise.then((function(e){e.syncWithServer().then((function(e){return t(e)})).catch((function(e){return o(e)}))}))}))},e.prototype.logReading=function(e,t,o,n,r,i,s,a,c,l){var u=this;return new Promise((function(d,p){u.servicePromise.then((function(u){u.logReading(e,t,o,n,r,i,s,a,c,l).then((function(e){return d(e)})).catch((function(e){return p(e)}))}))}))},e}())},18:function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));var n={bookElementRoute:"/book/:book/:bookElement?/:additional?",meapElementRoute:"/book/:book/:bookElement/v-:meapVersion/:additional?",reviewElementRoute:"/book/:book/:bookElement/r-:reviewVersion/:additional?",meapEditorRoute:"/edit/:book/:bookElement/v-:meapVersion/:additional?",editorRoute:"/edit/:book/:bookElement?/:additional?",reviewEditorRoute:"/edit/:book/:bookElement/r-:reviewVersion/:additional?",exerciseSuiteRoute:"/exercise-suite/:exerciseSuite?",catalogRoute:"/catalog/:category?",getCurrentRouteInfo:function(){return this.getRouteInfo(this.getCleanRoute(document.location.hash||document.location.pathname))},getRouteInfo:function(e){var t={isEditLink:e.indexOf("/edit/")>=0},o=new page.Route(this.meapElementRoute);return o.match(e,t)?t:(o=new page.Route(this.reviewElementRoute)).match(e,t)?t:(o=new page.Route(this.bookElementRoute)).match(e,t)?t:(o=new page.Route(this.meapEditorRoute)).match(e,t)?t:(o=new page.Route(this.editorRoute)).match(e,t)?t:null},getCleanRoute:function(e){var t=e.indexOf("/");return-1===t?e:e.substr(t)}}},22:function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));var n=o(0),r=o(14),i=o(7),s=new(function(){function e(){}return e.prototype.updateAvatarUrl=function(e){var t=this;null!=this.authInfo&&n.a.postToOurBackend(n.a.getAbsoluteUrl("api/userInfo/saveAvatarUrl"),(function(){t.authInfo.userDetails.avatarUrl=e,$(document).trigger("requestAvatarUrlUpdate",e)}),(function(e){$(document).trigger("requestNotification","Error uploading profile image")}),{avatarUrl:e})},e.prototype.setAuthInfo=function(e){this.authInfo=e,null!=this.authInfo&&null!=this.authInfo.userDetails&&(this.authInfo.userDetails.isNewCustomer||r.a.setItem("isBuyer",!0))},e.prototype.getAuthInfo=function(){return this.authInfo},e.prototype.getUserId=function(){return null==this.authInfo?0:this.authInfo.userDetails.id},e.prototype.getUserInitials=function(){var e=this;return new Promise((function(t,o){i.a.isLoggedIn().then((function(o){return t(!!o.loggedIn&&e.extractInitials(o.userDetails.firstName,o.userDetails.lastName))})).catch((function(e){return o(e)}))}))},e.prototype.extractInitials=function(e,t){return e&&t?e[0]+t[0]:e&&!t?e[0]:!e&&t?t[0]:""},e.prototype.getUserFirstName=function(){return new Promise((function(e,t){i.a.isLoggedIn().then((function(t){t.loggedIn&&t.userDetails.firstName?e(t.userDetails.firstName||""):e("")})).catch((function(e){return t(e)}))}))},e.prototype.getUserEmail=function(){return new Promise((function(e,t){i.a.isLoggedIn().then((function(t){return e(!!t.loggedIn&&t.userDetails.email)})).catch((function(e){return t(e)}))}))},e.prototype.getAvatarUrl=function(){return new Promise((function(e,t){i.a.isLoggedIn().then((function(t){return e(!!t.loggedIn&&t.userDetails.avatarUrl)})).catch((function(e){return t(e)}))}))},e.prototype.isUserAdmin=function(){return new Promise((function(e,t){i.a.isLoggedIn().then((function(t){return e(!!t.loggedIn&&t.userDetails.isAdmin)})).catch((function(e){return t(e)}))}))},e.prototype.getUserDetails=function(){return new Promise((function(e,t){i.a.isLoggedIn().then((function(t){var o=t.loggedIn?t.userDetails:null;o&&(o.name=(o.firstName||"")+" "+(o.lastName||""),o.votes=o.votes||[],o.spamCommentIds=o.spamCommentIds||[],o.authorizedProductIds=o.authorizedProductIds||{}),e(o)})).catch((function(e){return t(e)}))}))},e.prototype.setTokenInfo=function(e){this.authInfo&&this.authInfo.userDetails&&(this.authInfo.userDetails.tokenInfo=e)},e.prototype.saveNotificationPreferences=function(e){return new Promise((function(t,o){n.a.getFromOurBackend(n.a.getAbsoluteUrl("api/comment/saveNotificationPreferences"),(function(){return t()}),(function(e){return o(e)}),{value:e})}))},e}())},24:function(e,t,o){"use strict";var n=o(58),r=o(0),i=o(174),s=window.fileSystemUtils,a=function(){function e(){}return e.prototype.getBookElementFileNames=function(e){return s.getFolderChildren(s.getBooksContentFolderLocation()+"/"+e+"/Content/")},e.prototype.unzipBook=function(e,t){return new Promise((function(o,n){s.unzipFile(e,s.getBookContentFolderLocation(t)).then((function(){s.deleteFileIfExists(e),s.createFolderIfNecessary(s.getBookUserDataFolderLocation(t)).then((function(){console.log("Unzipped",s.getBooksContentFolderLocation()),i.a.buildAndSaveBookIndex(t),o()})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))}))},e.prototype.unzipBookExercises=function(e,t){var o=e.replace(".zip","-exercises.zip");s.fileExists(o).then((function(e){e&&s.unzipFile(o,s.getBookContentFolderLocation(t))})).catch((function(e){return console.log("Error when unzipping exercises")}))},e.prototype.cancelBookDownload=function(e){s.cancelDownload(e+".zip")},e.prototype.requestBookDownload=function(e,t,o){var n=s.getTempDownloadLocation(e+".zip");function i(t){document.dispatchEvent(new CustomEvent("download-error",{detail:{bookShortName:e,bookTitle:o,error:t}}))}s.deleteFileIfExists(n),r.a.postToOurBackend(r.a.getAbsoluteUrl("api/book/getOfflineContentDownloadLink"),(function(t){t.contentLink?s.downloadFile(t.contentLink,e+".zip",{bookShortName:e,bookTitle:o,directory:s.getTempDownloadLocation("")}):i("Error getting offline content download link: "+t.message)}),(function(e){return i("Error getting offline content download link: "+e)}),{bookShortName:e,type:t})},e.prototype.cancelDownload=function(e){s.cancelDownload(e)},e.prototype.deleteBook=function(e){return s.deleteFolderIfExists(s.getBookContentFolderLocation(e))},e.prototype.loadBook=function(e){return new Promise((function(t,o){s.fileExists(s.getBookInfoLocation(e)).then((function(n){if(n)return s.readFile(s.getBookInfoLocation(e)).then((function(e){var o=JSON.parse(e);o.hasBeenDownloaded=!0,t(o)}));o(null)})).catch((function(e){return o(e)}))}))},e.prototype.loadBookContent=function(e,t,o){var r=this;return new Promise((function(i,a){s.fileExists(s.getBookInfoLocation(e)).then((function(c){if(c){var l=[s.readFile(s.getBookInfoLocation(e)),s.readFile(s.getBookElementContentLocation(e,t))];Promise.all(l).then((function(a){var c=JSON.parse(a[0]),l=function(){var o=n.a.convertToBookContent(c,t,s.getBookElementAudioLocation(e,t),s.getBookElementSubtitlesLocation(e,t),r.fixImageUrls(a[1]));o.book.hasBeenDownloaded=!0,i(o)};c.bookElements&&0!=c.bookElements.length||null==o?l():o(e,void 0,!0).then((function(t){t.bookElements?(c.bookElements=t.bookElements,s.writeToFile(s.getBookInfoLocation(e),JSON.stringify(c)),l()):l()})).catch((function(e){return l()}))})).catch((function(e){return a(e)}))}else a(null)})).catch((function(e){return a(e)}))}))},e.prototype.fixImageUrls=function(e){return e.replace(/\{\{BOOK_ROOT_FOLDER\}\}/g,s.getBooksContentFolderLocation())},e.prototype.loadLibrary=function(){return new Promise((function(e,t){s.getFolderChildren(s.getBooksContentFolderLocation()).then((function(t){t.map((function(e){return""+s.getBooksContentFolderLocation()+e+"/"}));return Promise.all(t.map((function(e){return s.readFile(s.getBookInfoLocation(e))}))).then((function(t){for(var o=[],i=0;i<t.length;i++){var a=t[i],c=n.a.convertToBook(JSON.parse(a));c.hasBeenDownloaded=!0,c.bookCoverPath=s.getBookCoverPath(c.shortName),c.bookPath=r.a.getBookUrlFromBook(c),o.push(c)}e(o)})).catch((function(t){e([])}))}))}))},e.prototype.saveLibrary=function(e){},e.prototype.loadTocAndIndex=function(e){return new Promise((function(t,o){s.readFile(s.getTocAndIndexLocation(e.shortName)).then((function(e){if(e){var o=JSON.parse(e);"string"==typeof o.toc&&(o.toc=JSON.parse(o.toc)),"string"==typeof o.index&&(o.index=JSON.parse(o.index)),t(o)}else t({})})).catch((function(e){t({})}))}))},e.prototype.loadVideos=function(e){var t=e.book.shortName;return new Promise((function(o,n){s.readFile(s.getVideosLocation(t,e.shortName)).then((function(e){if(e){var n=JSON.parse(e);if(n instanceof Object)for(var r in n)n.hasOwnProperty(r)&&(n[r].video=s.getBookContentFolderLocation(t)+"/Videos/"+n[r].video);o(n)}else o({})})).catch((function(e){console.log(e,"When loading videos"),o({})}))}))},e.prototype.fetchRunnableListing=function(e,t){var o=this;return new Promise((function(n,r){s.readFile(o.getRunnableListingLocation(e,t)).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))},e.prototype.getRunnableListingLocation=function(e,t){return s.getRunnableListingLocation(e,t)},e.prototype.failSafeRead=function(e){return new Promise((function(t,o){s.readFile(e).then((function(e){return t(e)})).catch((function(){return t("")}))}))},e}();t.a=window.fsa=new a},25:function(e,t,o){"use strict";var n=o(0),r=o(129),i=o(15),s=o(96),a=o(81),c=o(1),l=function(){function e(){}return e.prototype.getGeneralProducts=function(e){return new Promise((function(t,o){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/catalog/getProductsDetails"),(function(e){return t(e)}),(function(e){return o(e)}),{slugs:e.join(",")})}))},e.prototype.getCompleteBookElementPriceInfo=function(e,t,o){return e&&t?new Promise((function(r,i){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/userBook/getBookElementStructurePrices"),(function(e){return r(e)}),(function(e){return i(e)}),{bookShortName:e,bookElementShortName:t,meapVersion:o||0})})):Promise.reject()},e.prototype.getBookElementTokenPrice=function(e,t,o){return new Promise((function(r,i){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/userBook/getBookElementTokenPrice"),(function(e){return r(e.tokenPrice)}),(function(e){return i(e)}),{bookShortName:e,bookElementShortName:t,meapVersion:o})}))},e.prototype.getTocOwnership=function(e){return new Promise((function(t,o){n.a.getFromOurBackend(n.a.getAbsoluteUrl("api/userBook/getOwnedStructure"),(function(e){return t(e)}),(function(e){return o(e)}),{bookShortName:e})}))},e.prototype.getChapterOwnership=function(){return null!=this.chapterOwnershipPromise?this.chapterOwnershipPromise:this.chapterOwnershipPromise=new Promise((function(e,t){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/userBook/getBookChaptersPartialOwnership"),(function(t){return e(t)}),(function(e){return t(e)}))}))},e.prototype.getRelatedProducts=function(e){return new Promise((function(t,o){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/book/getRelatedProducts"),(function(e){return t(e)}),(function(e){return o(e)}),{bookShortName:e})}))},e.prototype.getCustomersAlsoBoughtProducts=function(e){return new Promise((function(t,o){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/cart/getCustomersAlsoBoughtProducts"),(function(e){return t(e)}),(function(e){return o(e)}),{bookShortName:e})}))},e.prototype.getBook=function(e,t,o){var r={};return e&&(r.bookShortNameOrSlug=e),t&&(r.productId=t),new Promise((function(e,t){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/book/getBook"),(function(t){return e(t)}),(function(e){return t(e)}),r)}))},e.prototype.getBookElementIntro=function(e,t,o){return void 0===t&&(t=""),void 0===o&&(o=""),new Promise((function(r,i){n.a.getFromOurBackend(n.a.getAbsoluteUrl("api/book/getBookElementIntro"),(function(e){return r(e&&e.intro||"")}),(function(e){return i(e)}),{bookShortNameOrSlug:e,bookElement:t,meapVersion:o||void 0})}))},e.prototype.getBookElement=function(e,t,o,r){var a=this;return void 0===t&&(t=""),void 0===o&&(o=""),void 0===r&&(r=""),new Promise((function(c,l){n.a.getFromOurBackend(n.a.getAbsoluteUrl("api/book/getBookElement"),(function(e){if(!1===e.success&&e.reason)l(e.reason);else{var t=e.bookElement,o=e.previousBookElement,n=e.nextBookElement;if(e.book&&t){var r=i.a.createBookFromBookData(e.book),s=i.a.createBookElement(t,r,o,n);t.content?(s.content=a.adjustContent(t.content,a.fixOwnedContentWithImageUrls(t.ownedContent),r.shortName,r.slug),i.a.updateBookOverviewIfNecessary(r,s),c({book:r,bookElement:s,previousBookElement:s.previousBookElement,nextBookElement:s.nextBookElement})):(t.intro&&(s.intro=a.adjustContent(t.intro,"",r.shortName,r.slug),$(document).trigger("bookElementIntroArrived",s.intro)),$.ajax({url:t.contentUrl,crossDomain:!0}).done((function(e){s.content=a.adjustContent(e,a.fixOwnedContentWithImageUrls(t.ownedContent),r.shortName,r.slug),i.a.updateBookOverviewIfNecessary(r,s),c({book:r,bookElement:s,previousBookElement:s.previousBookElement,nextBookElement:s.nextBookElement})})).fail((function(e){return l(e)})))}else l("Cannot fetch content")}}),(function(e){return l(e)}),{bookShortNameOrSlug:e,bookElementShortName:t,meapVersion:o||void 0,reviewVersion:r||void 0,freeEbooksAreOpen:s.a.isFreeEbookOpen(e)})}))},e.prototype.fixOwnedContentWithImageUrls=function(e){if(!e||!e.length)return e;for(var t=0;t<e.length;t++)e[t].content=this.fixUrls(e[t].content);return e},e.prototype.adjustContent=function(e,t,o,n){return void 0===o&&(o=""),void 0===n&&(n=""),e=this.fixUrls(e),t?(c.b.isApp()&&(e=e.replace(/\/assets\/images\//g,"assets/images/")),r.b.replaceEncryptedContent($("<div></div>").html(e),t)):e},e.prototype.fixUrls=function(e){return e.replace(/\{\{BOOK_ROOT_FOLDER\}\}/g,n.a.getAwsPublic()).replace(/\#\!\/book\//g,"/book/")},e.prototype.getUserOwnedProducts=function(){return new Promise((function(e,t){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/userInfo/getUserOwnedProducts"),(function(t){"string"==typeof t&&(t=JSON.parse(t)),e(t)}),(function(e){return t(e)}))}))},e.prototype.getCatalog=function(){return new Promise((function(e,t){n.a.getFromOurBackend(n.a.getAbsoluteUrl("api/catalog/getCatalog"),(function(t){return e(t)}),(function(e){return t(e)}))}))},e.prototype.getBestsellers=function(){return new Promise((function(e,t){n.a.getFromOurBackend(n.a.getAbsoluteUrl("api/catalog/getBestsellers"),(function(t){return e(t)}),(function(e){return t(e)}))}))},e.prototype.getUserEditorBooksShortNames=function(){return new Promise((function(e,t){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/userInfo/getCurrentUserBookEditorShortNames"),(function(t){return e(t&&t.bookShortNames||"")}),(function(t){console.log("Error when fetching user editor book short names"),e("")}))}))},e.prototype.requestBookDownload=function(e,t){throw new Error("Cannot download book on the web")},e.prototype.deleteBook=function(e){return Promise.reject("Cannot delete book on the web")},e.prototype.unzipBook=function(e,t){return Promise.reject("Cannot unzip book on the web")},e.prototype.getFreePreviewStatus=function(e){return new Promise((function(t,o){a.a.getAbTestVariant().then((function(r){n.a.postToOurBackend(n.a.getAbsoluteUrl("freePreview/getFreePreviewStatus"),(function(e){t(e)}),(function(e){console.log("Error when fetching free preview status"),o(e)}),{bookShortName:e,durationVariant:r})}))}))},e.prototype.getBookDates=function(e){return new Promise((function(t,o){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/book/dates/"+e),(function(e){return t(e)}),(function(e){return t("")}))}))},e.prototype.getBooksDetails=function(e){return new Promise((function(t,o){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/catalog/getBooksDetails?bookShortNames="+e.join(",")),(function(e){return t(e)}),(function(e){return o(e)}))}))},e.prototype.getDownloadedBooksShortNamesAndSlugs=function(){return Promise.resolve({})},e.prototype.markBookAsDownloaded=function(e,t){return Promise.reject("Cannot download book in browser")},e.prototype.unmarkBookAsDownloaded=function(e,t){return Promise.reject("Cannot download book in browser")},e.prototype.getEpochHours=function(){return Math.round(Date.now()/1e3/60/60)},e}(),u=o(34),d=o(24),p=function(){function e(){this.webService=new l}return e.prototype.getCatalog=function(){var e=this;return c.b.isConnected()?new Promise((function(t,o){e.webService.getCatalog().then((function(o){e.saveCatalogToFileSystem(o),t(o)})).catch((function(n){e.loadCatalogFromFileSystem().then((function(e){return t(e)})).catch((function(e){return o(e)}))}))})):this.loadCatalogFromFileSystem()},e.prototype.getUserOwnedProducts=function(){var e=this;return c.b.isConnected()?new Promise((function(t,o){e.webService.getUserOwnedProducts().then((function(o){e.saveUserOwnedProductsToFileSystem(o),t(o)})).catch((function(n){e.loadUserOwnedProductsFromFileSystem().then((function(e){return t(e)})).catch((function(e){return o(e)}))}))})):this.loadUserOwnedProductsFromFileSystem()},e.prototype.getBookElementIntro=function(e,t,o){var n=this;return void 0===t&&(t=""),void 0===o&&(o=""),new Promise((function(r,i){n.getDownloadedBooksShortNamesAndSlugs().then((function(s){null==s||null==s[e]?n.webService.getBookElementIntro(e,t,o).then((function(e){return r(e)})).catch((function(e){return i(e)})):r("")})).catch((function(s){n.webService.getBookElementIntro(e,t,o).then((function(e){return r(e)})).catch((function(e){return i(e)}))}))}))},e.prototype.getGeneralProducts=function(e){if(!c.b.isConnected())return Promise.resolve([]);this.webService.getGeneralProducts(e)},e.prototype.getFreePreviewStatus=function(e){return c.b.isConnected()?this.webService.getFreePreviewStatus(e):Promise.resolve({remainingDuration:0,previewDuration:0,canFreelyPreview:!1,isPreviewRunning:!1})},e.prototype.getBooksDetails=function(e){return c.b.isConnected()?this.webService.getBooksDetails(e):Promise.resolve({})},e.prototype.getCompleteBookElementPriceInfo=function(e,t,o){return c.b.isConnected()?this.webService.getCompleteBookElementPriceInfo(e,t,o):Promise.resolve({fullTokenPrice:0,tokenPrice:0,sectionSubsectionPrices:[]})},e.prototype.getBookElementTokenPrice=function(e,t,o){return c.b.isConnected()?this.webService.getBookElementTokenPrice(e,e,o):Promise.resolve(0)},e.prototype.getRelatedProducts=function(e){return c.b.isConnected()?this.webService.getRelatedProducts(e):Promise.resolve([])},e.prototype.getCustomersAlsoBoughtProducts=function(e){return c.b.isConnected()?this.webService.getCustomersAlsoBoughtProducts(e):Promise.resolve([])},e.prototype.getBook=function(e,t,o){var n=this;return o?this.webService.getBook(e,t):new Promise((function(o,r){d.a.loadBook(e).then((function(e){return o(e)})).catch((function(i){n.webService.getBook(e,t).then((function(e){return o(e)})).catch((function(e){return r(e)}))}))}))},e.prototype.getBookElement=function(e,t,o,n){var r=this;return void 0===t&&(t=""),void 0===o&&(o=""),void 0===n&&(n=""),new Promise((function(i,s){var a=function(){r.webService.getBookElement(e,t,o,n).then((function(e){return i(e)})).catch((function(e){return s(e)}))};r.getDownloadedBooksShortNamesAndSlugs().then((function(o){if(null!=o&&null!=o[e]){var n=o[e].shortName,s=function(){d.a.loadBookContent(n,t,r.webService.getBook).then((function(e){return i(e)})).catch((function(e){return a()}))};t?s():d.a.getBookElementFileNames(n).then((function(e){e.indexOf("chapter-1")?(t="chapter-1",s()):e.length>0?(t=e[0],s()):s()}))}else a()}))}))},e.prototype.getTocOwnership=function(e){return c.b.isConnected()?this.webService.getTocOwnership(e):Promise.resolve({partialChapterOwnership:[]})},e.prototype.getChapterOwnership=function(){return c.b.isConnected()?this.webService.getChapterOwnership():Promise.resolve({"":{partialChapterOwnership:[]}})},e.prototype.getBestsellers=function(){return c.b.isConnected()?this.webService.getBestsellers():Promise.resolve([])},e.prototype.getUserEditorBooksShortNames=function(){return c.b.isConnected()?this.webService.getUserEditorBooksShortNames():Promise.resolve("")},e.prototype.requestBookDownload=function(e,t,o){return d.a.requestBookDownload(e,t,o)},e.prototype.deleteBook=function(e){return d.a.deleteBook(e)},e.prototype.unzipBook=function(e,t){return d.a.unzipBook(e,t)},e.prototype.getBookDates=function(e){var t=this;return new Promise((function(o,n){t.webService.getBookDates(e).then((function(e){return o(e)})).catch((function(e){d.a.loadLibrary().then((function(e){return o(e)})).catch((function(e){return n(e)}))}))}))},e.prototype.loadCatalogFromFileSystem=function(){var e=this;return new Promise((function(t,o){e.getUtils().readFile(e.getUtils().getCatalogLocation()).then((function(e){return t(JSON.parse(e))})).catch((function(e){return o(e)}))}))},e.prototype.loadUserOwnedProductsFromFileSystem=function(){var e=this;return new Promise((function(t,o){e.getUtils().readFile(e.getUtils().getUserOwnedProductsLocation()).then((function(e){t(JSON.parse(e))})).catch((function(e){o(e)}))}))},e.prototype.saveCatalogToFileSystem=function(e){var t=this;return new Promise((function(o,n){t.getUtils().writeToFile(t.getUtils().getCatalogLocation(),JSON.stringify(e)).then((function(){return o()})).catch((function(e){return n(e)}))}))},e.prototype.saveUserOwnedProductsToFileSystem=function(e){var t=this;return new Promise((function(o,n){t.getUtils().writeToFile(t.getUtils().getUserOwnedProductsLocation(),JSON.stringify(e)).then((function(e){return o(e)})).catch((function(e){return n(e)}))}))},e.prototype.getDownloadedBooksShortNamesAndSlugs=function(){var e=this;return new Promise((function(t,o){e.getUtils().readFile(e.getUtils().getDownloadedBooksSummaryLocation()).then((function(e){t(JSON.parse(e))})).catch((function(e){return t({})}))}))},e.prototype.markBookAsDownloaded=function(e,t){var o=this;return new Promise((function(n,r){o.getDownloadedBooksShortNamesAndSlugs().then((function(n){n[e]=n[t]={shortName:e,slug:t},o.storeDownloadedBooksShortNames(n)})).catch((function(n){var r={};r[e]=r[t]={shortName:e,slug:t},o.storeDownloadedBooksShortNames(r)}))}))},e.prototype.unmarkBookAsDownloaded=function(e,t){var o=this;return new Promise((function(n,r){o.getDownloadedBooksShortNamesAndSlugs().then((function(n){delete n[e],delete n[t],o.storeDownloadedBooksShortNames(n)})).catch((function(e){return r(e)}))}))},e.prototype.storeDownloadedBooksShortNames=function(e){return this.getUtils().writeToFile(this.getUtils().getDownloadedBooksSummaryLocation(),JSON.stringify(e))},e.prototype.getUtils=function(){return window.fileSystemUtils},e}(),h=o(73),f=o(121),g=o(4),m=o(17);o.d(t,"a",(function(){return v}));var v=new(function(){function e(){this.bookElementIntroPromiseMap={},this.tocOwnershipInfoPromiseMap={},this.bookChapterOwnership={},this.startTime=Date.now(),this.bookContentServicePromise=new Promise((function(e,t){c.b.loadDeviceInfo().then((function(t){e(function(e){switch(e){case c.a.Cordova:case c.a.Electron:return new p;case c.a.Browser:default:return new l}}(t.platform))})).catch((function(e){return t(e)}))}))}return e.prototype.resetCache=function(){this.relatedProductsPromiseMap={},this.customersAlsoBoughtPromiseMap={},this.bookElementIntroPromiseMap={},this.userEditorBooksShortNamesPromise=null,this.tocOwnershipInfoPromiseMap={},this.bookChapterOwnership={},this.userLibraryPromise=null,this.userLibrary=null,this.userLibraryAndCatalog=null,this.userLibraryAndCatalogPromise=null,this.bestSellersPromise=null,this.catalogBooks=null,this.catalogPromise=null,this.startTime=Date.now()},e.prototype.markBookAsDownloaded=function(e){var t=null;if(null!=this.userLibrary)for(var o=0,n=this.userLibrary;o<n.length;o++){if((c=n[o]).shortName==e){t=c,c.hasBeenDownloaded=!0;break}}if(null!=this.userLibraryAndCatalog){if(null!=this.userLibraryAndCatalog.userLibrary)for(var r=0,i=this.userLibraryAndCatalog.userLibrary;r<i.length;r++){if((c=i[r]).shortName==e){t=c,c.hasBeenDownloaded=!0;break}}if(null!=this.userLibraryAndCatalog.catalog)for(var s=0,a=this.userLibraryAndCatalog.catalog;s<a.length;s++){var c;if((c=a[s]).shortName==e){t=c,c.hasBeenDownloaded=!0;break}}}this.bookContentServicePromise.then((function(o){o.markBookAsDownloaded(e,null!=t?t.slug:"")}))},e.prototype.unmarkBookAsDownloaded=function(e){var t=null;if(null!=this.userLibrary)for(var o=0,n=this.userLibrary;o<n.length;o++){if((c=n[o]).shortName==e){t=c,c.hasBeenDownloaded=!1;break}}if(null!=this.userLibraryAndCatalog){if(null!=this.userLibraryAndCatalog.userLibrary)for(var r=0,i=this.userLibraryAndCatalog.userLibrary;r<i.length;r++){if((c=i[r]).shortName==e){t=c,c.hasBeenDownloaded=!1;break}}if(null!=this.userLibraryAndCatalog.catalog)for(var s=0,a=this.userLibraryAndCatalog.catalog;s<a.length;s++){var c;if((c=a[s]).shortName==e){t=c,c.hasBeenDownloaded=!1;break}}}this.bookContentServicePromise.then((function(o){o.unmarkBookAsDownloaded(e,null!=t?t.slug:"")})),$(document).trigger("bookDeleted",e)},e.prototype.getBookElement=function(e,t,o,n){var r=this;return new Promise((function(i,s){r.bookContentServicePromise.then((function(r){r.getBookElement(e,t,o,n).then((function(e){return i(e)})).catch((function(e){return s(e)}))})).catch((function(e){return s(e)}))}))},e.prototype.getBookElementIntro=function(e,t,o){var n=this;this.shouldReset()&&this.resetCache();var r=(e||"")+"-"+(t||"")+"-"+(o||"");return null!=this.bookElementIntroPromiseMap[r]?this.bookElementIntroPromiseMap[r]:this.bookElementIntroPromiseMap[r]=new Promise((function(r,i){n.bookContentServicePromise.then((function(n){n.getBookElementIntro(e,t,o).then((function(e){return r(e)})).catch((function(e){return i(e)}))})).catch((function(e){return i(e)}))}))},e.prototype.getBookElementTokenPrice=function(e,t,o){var n=this;return new Promise((function(r,i){n.bookContentServicePromise.then((function(n){n.getBookElementTokenPrice(e,t,o).then((function(e){return r(e)})).catch((function(e){return i(e)}))})).catch((function(e){return i(e)}))}))},e.prototype.deleteBook=function(e){var t=this;return new Promise((function(o,n){t.bookContentServicePromise.then((function(t){t.deleteBook(e).then((function(e){return o()})).catch((function(e){return n(e)}))})).catch((function(e){return n(e)}))}))},e.prototype.getUserEditorBooksShortNames=function(){var e=this;return this.shouldReset()&&this.resetCache(),this.userEditorBooksShortNamesPromise?this.userEditorBooksShortNamesPromise:this.userEditorBooksShortNamesPromise=new Promise((function(t,o){e.bookContentServicePromise.then((function(e){e.getUserEditorBooksShortNames().then((function(e){return t(e)})).catch((function(e){return o(e)}))})).catch((function(e){return o(e)}))}))},e.prototype.getUsersLibrary=function(){var e=this;return this.shouldReset()&&this.resetCache(),null!=this.userLibrary?Promise.resolve(this.userLibrary):this.userLibraryPromise?this.userLibraryPromise:this.userLibraryPromise=new Promise((function(t,o){Promise.all([e.getUserOwnedProducts(),e.getCatalog(),h.a.fetchAllBooksProgress(),e.getDownloadedBooksShortNamesAndSlugs()]).then((function(o){for(var n=o[0],r=o[1],i=o[2],s=o[3],a=[],c={},l=0,d=r;l<d.length;l++){var p=d[l];e.assignBookProgress(p,i);for(var h=0,f=n;h<f.length;h++){var g=f[h];g.shortName===p.shortName&&(p.userOwnsBook=!g.partialBookOwnership,s[p.shortName]&&(p.hasBeenDownloaded=!0),c[p.shortName]||(c[p.shortName]=!0,a.push(p)),p.partialBookOwnership=g.partialBookOwnership,g.isAudio()&&(p.userOwnsAudio=!0))}}a.forEach((function(e){e.lastAccessedTime=Number.isNaN(e.lastAccessedTime)?0:e.lastAccessedTime||0})),u.a.sortBooksDefault(a),e.userLibrary=a,t(a)})).catch((function(e){return o(e)}))}))},e.prototype.getUsersLibraryAndCatalog=function(e){var t=this;return this.shouldReset()&&this.resetCache(),null!=this.userLibraryAndCatalog?Promise.resolve(this.userLibraryAndCatalog):this.userLibraryAndCatalogPromise?this.userLibraryAndCatalogPromise:this.userLibraryAndCatalogPromise=new Promise((function(o,n){Promise.all([e?t.getUserOwnedProducts():Promise.resolve([]),t.getCatalog(),e?h.a.fetchAllBooksProgress():Promise.resolve({}),t.getDownloadedBooksShortNamesAndSlugs()]).then((function(e){for(var n=e[0],r=e[1],i=e[2],s=e[3],a=[],c={},l=0,d=r;l<d.length;l++){var p=d[l];s[p.shortName]&&(p.hasBeenDownloaded=!0),t.assignBookProgress(p,i);for(var h=0,f=n;h<f.length;h++){var g=f[h];g.shortName===p.shortName&&(p.userOwnsBook=!g.partialBookOwnership,p.partialBookOwnership=g.partialBookOwnership,c[p.shortName]||(c[p.shortName]=!0,a.push(p)),g.isAudio()&&(p.userOwnsAudio=!0))}}a.forEach((function(e){e.lastAccessedTime=Number.isNaN(e.lastAccessedTime)?0:e.lastAccessedTime||0})),u.a.sortBooksDefault(a),t.userLibraryAndCatalog={userLibrary:a,catalog:r},o(t.userLibraryAndCatalog)})).catch((function(e){n(e)}))}))},e.prototype.getUserOwnedProducts=function(){var e=this;return new Promise((function(t,o){e.bookContentServicePromise.then((function(e){e.getUserOwnedProducts().then((function(e){var o=e.filter((function(e){return f.a.isAcceptableProductType(e.productType)})).map((function(e){return new f.a(e.externalId,e.title,e.productType,e.productPrice,e.partialBookOwnership)}));t(o)})).catch((function(e){return o(e)}))})).catch((function(e){return o(e)}))}))},e.prototype.getBestsellers=function(){var e=this;return this.shouldReset()&&this.resetCache(),this.bestSellersPromise?this.bestSellersPromise:this.bestSellersPromise=new Promise((function(t,o){e.bookContentServicePromise.then((function(e){Promise.all([v.getCatalog(),e.getBestsellers()]).then((function(e){for(var o=e[0],n=e[1],r={},i=0,s=n;i<s.length;i++){var a=s[i];r[a.id]=!0}t(o.filter((function(e){return r[e.manningId]})))}))})).catch((function(e){return o(e)}))}))},e.prototype.getCompleteBookElementPriceInfo=function(e,t,o){var n=this;return new Promise((function(r,i){n.bookContentServicePromise.then((function(n){n.getCompleteBookElementPriceInfo(e,t,o).then((function(e){return r(e)})).catch((function(e){return i(e)}))})).catch((function(e){return i(e)}))}))},e.prototype.getBook=function(e,t,o){var n=this;return new Promise((function(r,s){n.bookContentServicePromise.then((function(n){n.getBook(e,t,o).then((function(e){return r(i.a.createBookFromBookData(e))})).catch((function(e){return s(e)}))})).catch((function(e){return s(e)}))}))},e.prototype.getFreePreviewStatus=function(e){var t=this;return new Promise((function(o,n){t.bookContentServicePromise.then((function(t){t.getFreePreviewStatus(e).then((function(e){return o(e)})).catch((function(e){return n(e)}))}))}))},e.prototype.getMeaps=function(){var e=this;return new Promise((function(t,o){e.getCatalog().then((function(e){var o=e.filter((function(e){return-1!==e.title.indexOf("MEAP")}));u.a.sortBooksByLastUpdateDate(o),t(o)})).catch((function(e){return o(e)}))}))},e.prototype.getPublished=function(e){var t=this;return new Promise((function(e,o){t.getCatalog().then((function(t){var o=t.filter((function(e){return!e.isMeap}));u.a.sortBooksByLastUpdateDate(o),o=o.slice(0,30),e(o)})).catch((function(e){return o(e)}))}))},e.prototype.getLatestBooks=function(e){var t=this;return new Promise((function(e,o){t.getCatalog().then((function(t){u.a.sortBooksByLastUpdateDate(t),t=t.slice(0,30),e(t)})).catch((function(e){return o(e)}))}))},e.prototype.getCatalog=function(){var e=this;return this.shouldReset()&&this.resetCache(),this.catalogBooks&&this.catalogBooks.length>0?Promise.resolve(this.catalogBooks):this.catalogPromise?this.catalogPromise:this.catalogPromise=new Promise((function(t,o){e.bookContentServicePromise.then((function(n){n.getCatalog().then((function(o){e.catalogBooks=o.map((function(t){return e.createCatalogBookFromWebData(t)})),e.catalogBooks.sort((function(e,t){return e.lastUpdateDate>t.lastUpdateDate?-1:e.lastUpdateDate<t.lastUpdateDate?1:0})),t(e.catalogBooks)})).catch((function(e){return o(e)}))}))}))},e.prototype.getGeneralProducts=function(e){var t=this;return new Promise((function(o,n){t.bookContentServicePromise.then((function(t){t.getGeneralProducts(e).then((function(e){return o(e)})).catch((function(e){return n(e)}))}))}))},e.prototype.getBooksFromCatalog=function(e){return new Promise((function(t,o){for(var n={},r=0,i=e;r<i.length;r++){var s=i[r];n[s]=!0}v.getCatalog().then((function(e){return t(e.filter((function(e){return n[e.shortName]})))})).catch((function(e){return o(e)}))}))},e.prototype.getRelatedProducts=function(e){var t=this;return this.shouldReset()&&this.resetCache(),this.relatedProductsPromiseMap||(this.relatedProductsPromiseMap={}),this.relatedProductsPromiseMap[e]?this.relatedProductsPromiseMap[e]:this.relatedProductsPromiseMap[e]=new Promise((function(o,n){t.bookContentServicePromise.then((function(n){n.getRelatedProducts(e).then((function(e){o(t.expandRelatedProducts(e))})).catch((function(e){return o([])}))}))}))},e.prototype.getCustomersAlsoBoughtProducts=function(e){var t=this;return this.customersAlsoBoughtPromiseMap||(this.customersAlsoBoughtPromiseMap={}),this.customersAlsoBoughtPromiseMap[e]?this.customersAlsoBoughtPromiseMap[e]:this.customersAlsoBoughtPromiseMap[e]=new Promise((function(o,n){t.bookContentServicePromise.then((function(n){n.getCustomersAlsoBoughtProducts(e).then((function(e){return o(t.expandCustomersAlsoBought(e))})).catch((function(e){return o([])}))}))}))},e.prototype.getChapterOwnership=function(e){var t=this;return this.bookChapterOwnership[e]?this.bookChapterOwnership[e]:this.bookChapterOwnership[e]=new Promise((function(o,n){t.bookContentServicePromise.then((function(t){t.getChapterOwnership().then((function(t){k(t[e],e),o(t[e])})).catch((function(e){n(e)}))}))}))},e.prototype.getTocOwnership=function(e){var t=this;return this.tocOwnershipInfoPromiseMap[e]?this.tocOwnershipInfoPromiseMap[e]:this.tocOwnershipInfoPromiseMap[e]=new Promise((function(o,n){t.bookContentServicePromise.then((function(t){t.getTocOwnership(e).then((function(t){k(t,e),o(t)}))}))}))},e.prototype.getBooksDetails=function(e){var t=this;return new Promise((function(o,n){t.bookContentServicePromise.then((function(t){t.getBooksDetails(e).then((function(e){return o(e)})).catch((function(e){return n(e)}))}))}))},e.prototype.getBookDates=function(e){var t=this;return new Promise((function(o,n){t.bookContentServicePromise.then((function(t){t.getBookDates(e).then((function(e){o({meapStart:e.meapStart||"",publishedDate:e.publishedDate||"",expectedPublishDate:e.expectedPublishDate||"",pbookAvailabilityDate:e.pbookAvailabilityDate||"",ebookAvailabilityDate:e.ebookAvailabilityDate||"",expectedPbookAvailabilityDate:e.expectedPbookAvailabilityDate||"",expectedEbookAvailabilityDate:e.expectedEbookAvailabilityDate||""})})).catch((function(e){return n()}))}))}))},e.prototype.getDownloadedBooksShortNamesAndSlugs=function(){var e=this;return new Promise((function(t,o){e.bookContentServicePromise.then((function(e){e.getDownloadedBooksShortNamesAndSlugs().then((function(e){return t(e)})).catch((function(e){return o(e)}))}))}))},e.prototype.assignBookProgress=function(e,t){var o=t[e.shortName];o?(e.progressBookElement=o.bookElementShortName,e.lastBookElementItem=o.contentItemID||"",e.bookPath=n.a.getBookElementUrl(e.slug,e.progressBookElement,e.latestMeapVersion)+e.lastBookElementItem,e.lastAccessedTime=parseInt(""+(o.timeStamp||0))):(e.progressBookElement="",e.lastBookElementItem="",e.bookPath=n.a.getBookElementUrl(e.slug,e.progressBookElement,e.latestMeapVersion),e.lastAccessedTime=0)},e.prototype.createCatalogBookFromWebData=function(e){var t=new u.a;return t.manningId=e.manningId,t.shortName=e.shortName,t.title=e.title,t.cleanTitle=i.a.cleanBookTitle(t.title),t.isReview=!!e.isReview,t.isMeap=!!e.meap,t.isFreeEbook=!!e.isFreeEbook,t.latestMeapVersion=e.latestMeapVersion||0,t.slug=e.slug,t.authors=e.authors,t.userCanViewReviews=!!e.userCanViewReviews,t.userIsReviewer=!!e.userIsReviewer,t.categories=e.categories,t.description=e.description,t.lastUpdateDate=g.a.getDateFromString(e.lastUpdateDate),t.exercisesComingSoon=e.exercisesComingSoon,t.bookPath=n.a.getBookElementUrl(e.slug,"chapter-1",t.latestMeapVersion),t.bookCoverPath=n.a.getBookCoverUrl(e.shortName),t.hasAudio=e.hasAudio,t.hasExercises=e.hasExercises,t.hasTextAddendums=e.hasTextAddendums,t.hasKnowledgeGraph=e.hasKnowledgeGraph,t.isKnowledgeGraphAccessible=e.isKnowledgeGraphAccessible,t.categories=e.categories||"",null!=e.offlineFileSizes&&(t.offlineFileSizes=e.offlineFileSizes),t},e.prototype.expandCustomersAlsoBought=function(e){return(e=(e=e||[]).filter((function(e){return e&&e.livebook}))).forEach((function(e){e.imageUrl=n.a.getBookCoverUrl(e.externalId),e.link=n.a.getBookUrl(e.slug)})),e},e.prototype.expandRelatedProducts=function(e){return(e=(e=e||[]).filter((function(e){return e}))).forEach((function(e){e.livebook?(e.imageUrl=n.a.getBookCoverUrl(e.externalId),e.link=n.a.getBookUrl(e.slug)):(e.imageUrl.startsWith("http")||(e.imageUrl=n.a.getMarketplaceProductCoverUrl(e.imageUrl)),e.link=n.a.getMarketplaceProductUrl(e.slug,e.livevideo))})),e},e.prototype.shouldReset=function(){return c.b.isConnected()&&Date.now()-this.startTime>m.a.refreshDataAfter},e}()),b={};function k(e,t){if(null!=e&&null!=e.partialChapterOwnership)try{var o=b[t];if(o){var n=function(t){var o=e.partialChapterOwnership.find((function(e){return e.shortName==t}));null!=o&&(o.userOwned=!0)};for(var r in o)n(r)}}catch(e){console.log(e)}}$(document).on("unlockSectionSubsectionSuccess",(function(e,t,o,n){b[t]||(b[t]={}),b[t][o]||(b[t][o]={}),n&&(b[t][o][n]=!0)}))},29:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(5),r=new(function(){function e(){}return e.prototype.requestLogin=function(e,t){this.getSource().then((function(o){return o.LoginManager.requestLogin(e,t)}))},e.prototype.requestOpenModal=function(e,t,o,n){void 0===n&&(n=""),this.getSource().then((function(r){return r.LoginManager.openModal(e,t,!1,o,n)}))},e.prototype.requestLogout=function(){this.getSource().then((function(e){return e.LoginManager.performLogout()}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=n.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(0),o.e(1),o.e(25)]).then(o.bind(null,343))},e}())},3:function(e,t,o){"use strict";var n=$(document),r=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){e=!1}return e}(),i=function(){function e(){this.ids=[]}return e.prototype.onPassiveEvent=function(e,t,o){if(e&&e.length&&t&&t.length)for(var n=0;n<e.length;n++)for(var i=0;i<t.length;i++)e[n].addEventListener(t[i],o,!!r&&{passive:!0})},e.prototype.offPassiveEvent=function(e,t,o){if(e&&e.length&&t&&t.length)for(var n=0;n<e.length;n++)for(var r=0;r<t.length;r++)e[n].removeEventListener(t[r],o)},e.prototype.onEventWithCooldown=function(e,t,o){if(o){var n=!0;e.on(t,(function(e){if(n){var t;n=!1;try{t=o.apply(this,arguments)}catch(e){console.log(e)}return setTimeout((function(){return n=!0}),500),t}}))}},e.prototype.handleDragScroll=function(e){var t=!1,o=0,n=0,r=function(r){t&&(Math.abs(n-r.pageX)>=Math.abs(o-r.pageY)?e.scrollLeft(e.scrollLeft()+.1*(n-r.pageX)):e.scrollTop(e.scrollTop()+.1*(o-r.pageY)))};e.mouseleave(),e.on("mousedown",(function(i){t=!0,o=i.pageY,n=i.pageX,e.on("mousemove",r)})),e.on("mouseup mouseleave",(function(){t=!1,e.off("mousemove",r)}))},e.prototype.handleContainerScroll=function(e){var t=e.currentTarget,o=e.originalEvent,n=o.wheelDelta||-o.detail,r=$(t).outerHeight(),i=t.scrollTop+r-t.scrollHeight>=0,s=t.scrollTop<=0;if(n<0&&i||n>0&&s){var a=o.deltaX||o.wheelDeltaX,c=o.deltaY||o.wheelDeltaY;if(null!=a&&null!=c&&Math.abs(a)>Math.abs(c))return;o.preventDefault()}else;},e.prototype.onDescendantEventWithCooldown=function(e,t,o,n){if(n){var r=!0;e.on(t,o,(function(e){if(r){r=!1;try{n.apply(this,arguments)}catch(e){console.log(e)}setTimeout((function(){return r=!0}),500)}}))}},e.prototype.onDelayedMouseEnter=function(e,t){e&&0!=e.length&&(e.on("mouseenter",(function(e){var o=e.currentTarget;clearTimeout(o.timeoutId),o.timeoutId=setTimeout((function(){return t&&t(e)}),100)})),e.on("mouseleave",(function(e){return clearTimeout(e.currentTarget.timeoutId)})))},e.prototype.onScrollStop=function(e,t,o){var n=this,r=0;e.on("scroll",(function(e){clearTimeout(r),r=n.setTimeout((function(){return t&&t(e)}),o)}))},e.prototype.triggerDocumentEventAsync=function(e,t){setTimeout((function(){return n.trigger(e,t)}),10)},e.prototype.setTimeout=function(e,t){var o=setTimeout(e,t);return this.ids.push(o),o},e.prototype.clearTimers=function(){for(var e=0,t=this.ids;e<t.length;e++){var o=t[e];clearTimeout(o)}this.ids=[]},e}();t.a=new i},334:function(e,t,o){var n=o(335);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};o(98)(n,r);n.locals&&(e.exports=n.locals)},335:function(e,t,o){(e.exports=o(97)(!1)).push([e.i,"#offline-operations-modal{padding:1rem;top:50px;max-width:90vw;width:400px;left:0 !important;right:0 !important;margin:0 auto !important;text-align:center}#offline-operations-modal .offline-operations-action-container{margin:0 -1rem;padding:1rem 1rem 0 1rem;border-top:1px solid rgba(98,98,98,0.06)}#offline-operations-modal .offline-operations-delete-message-container{text-align:left;margin:1em 0.5em}#offline-operations-modal .offline-operations-download-types,#offline-operations-modal .offline-operations-delete-message-container{display:none}#offline-operations-modal .offline-operations-book-title{font-style:italic}#offline-operations-modal.download-book-modal .offline-operation-book-button{background-color:#3C67A2}#offline-operations-modal.download-book-modal .offline-operation-book-button:hover{background-color:#4373b5}#offline-operations-modal.download-book-modal .offline-operation-book-button:active{background-color:#5280bf}#offline-operations-modal.download-book-modal .offline-operations-download-types{display:block}#offline-operations-modal.delete-book-modal .offline-operation-book-button{background-color:#F86B5E}#offline-operations-modal.delete-book-modal .offline-operation-book-button:hover{background-color:#f98176}#offline-operations-modal.delete-book-modal .offline-operation-book-button:active{background-color:#fa988f}#offline-operations-modal.delete-book-modal .offline-operations-delete-message-container{display:block}#offline-operations-modal .offline-operations-modal-header{display:flex;align-items:center;justify-content:space-between;font-weight:bold;padding:0 0.5em}#offline-operations-modal .close-reveal-modal{font-size:1.5rem;position:static;padding:0.5em;margin:-0.5em}#offline-operations-modal .offline-operations-modal-content-container{position:relative;margin-top:1em}#offline-operations-modal ul{margin-left:0}#offline-operations-modal .offline-operation-book-button{box-shadow:none;margin:0;width:100%;border-radius:0;height:auto;font-size:1rem;padding:0.5em}#offline-operations-modal .download-type-item{display:flex;align-items:center;justify-content:space-between;color:#3C67A2;cursor:pointer;padding:0.75em 1.25em}#offline-operations-modal .download-type-item:hover{background-color:#f3f8f9}#offline-operations-modal .download-type-item:hover:not(.selected) .download-type-item-selector-inner{display:block}#offline-operations-modal .download-type-item.selected{background-color:#e2eef1}#offline-operations-modal .download-type-item.selected .download-type-item-description-label{color:#3C67A2}#offline-operations-modal .download-type-item.selected .download-type-item-selector{border-color:#3C67A2}#offline-operations-modal .download-type-item.selected .download-type-item-selector-inner{display:block;border-color:#3C67A2;background-color:#3C67A2}#offline-operations-modal .download-type-item-description-label{color:gray}#offline-operations-modal .download-type-item-size-label{font-size:70%;color:gray;margin-left:0.75em;font-weight:300}#offline-operations-modal .download-type-item-selector{border-radius:50%;border:2px solid gray;width:20px;height:20px;display:flex;align-items:center;justify-content:center}#offline-operations-modal .download-type-item-selector-inner{border-radius:50%;border:1px solid gray;background-color:gray;width:10px;height:10px;display:none}\n",""])},337:function(e,t,o){var n=o(338);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};o(98)(n,r);n.locals&&(e.exports=n.locals)},338:function(e,t,o){(e.exports=o(97)(!1)).push([e.i,".download-progress-stripe{display:flex;align-items:center;justify-content:flex-start;position:relative;background-color:rgba(83,83,83,0.95);color:white;text-align:left;font-size:130%;padding:0.75em 0.75em;margin:5px;opacity:0;transform:translateY(100%);transition:transform 0.25s ease-in-out, opacity 0.1s ease-in-out}.download-progress-stripe.appear{opacity:1;transform:translateY(0)}.download-progress-stripe .download-percentage-label{color:#5FC6A3;font-size:80%;margin-left:0.5em;white-space:pre;text-overflow:ellipsis;overflow:hidden;display:none;user-select:none;-webkit-user-select:none}.download-progress-stripe .download-retry-label{display:none}.download-progress-stripe.downloading .download-progress-stripe-line{display:block}.download-progress-stripe.downloading .download-cancel-label{display:block}.download-progress-stripe.downloaded .download-cancel-label,.download-progress-stripe.downloaded .download-retry-label{display:none}.download-progress-stripe.downloaded .download-percentage-label{display:inline-block}.download-progress-stripe.downloaded .book-title-label,.download-progress-stripe.downloaded .download-percentage-label{cursor:pointer;text-decoration:underline}.download-progress-stripe.download-error .download-retry-label{display:block}.download-progress-stripe.download-error .download-progress-stripe-close{display:block}.download-progress-stripe .download-status-container{cursor:pointer;transform:scale(0.7)}.download-progress-stripe .download-cancel-label,.download-progress-stripe .download-retry-label{display:none;cursor:pointer;user-select:none;-webkit-user-select:none;margin-left:auto;margin-right:0.5rem}.download-progress-stripe .download-cancel-label:hover,.download-progress-stripe .download-retry-label:hover{text-decoration:underline}.download-progress-stripe .download-progress-stripe-close{position:absolute;cursor:pointer;top:0.25em;right:0.25em;display:none}.download-progress-stripe .book-title-label{user-select:none;-webkit-user-select:none;margin:0 0.5em;white-space:pre;text-overflow:ellipsis;overflow:hidden}.download-progress-stripe .download-progress-stripe-line-container{position:absolute;bottom:0;left:0;right:0}.download-progress-stripe .download-progress-stripe-line{width:50%;background-color:#5FC6A3;transition:width 0.2s ease-in-out;height:5px;display:none}@media only screen and (max-width: 689px){.download-progress-stripe .download-progress-stripe-line{height:2px}}\n",""])},339:function(e,t,o){var n=o(340);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};o(98)(n,r);n.locals&&(e.exports=n.locals)},34:function(e,t,o){"use strict";var n=o(4),r=function(){function e(e,t,o,r,i,s,a,c,l,u,d,p,h,f,g,m){void 0===e&&(e=-1),void 0===t&&(t=-1),void 0===o&&(o=""),void 0===r&&(r=""),void 0===i&&(i=""),void 0===s&&(s=null),void 0===a&&(a=!1),void 0===c&&(c=""),void 0===l&&(l=!1),void 0===u&&(u=!1),void 0===d&&(d=""),void 0===p&&(p=""),void 0===h&&(h=!1),void 0===f&&(f=!1),void 0===g&&(g=0),void 0===m&&(m=""),this.openChapters=[],this.id=e,this.manningId=t,this.shortName=r,this.title=o,this.isMeap=h,this.isOpen=f,this.latestMeapVersion=g,this.description=i,this.lastUpdateDate=n.a.getDateFromString(s),this.exercisesComingSoon=a,this.userOwnsBook=l,this.userOwnsAudio=u,this.programmingLanguage=c,this.bookCoverPath=d,this.bookPath=p,this.highResolutionCover=m,this.offlineFileSizes={audioHighQuality:"",audioMediumQuality:"",audioLowQuality:"",contentSize:""}}return e.sortBooksDefault=function(e){void 0===e&&(e=[]),e.sort((function(e,t){return Math.max(t.lastAccessedTime,null!=t.lastUpdateDate?t.lastUpdateDate.getTime():0)-Math.max(e.lastAccessedTime,null!=e.lastUpdateDate?e.lastUpdateDate.getTime():0)}))},e.sortBooksAlphabetically=function(e){void 0===e&&(e=[]),e.sort((function(e,t){return e.title<t.title?-1:e.title>t.title?1:0}))},e.sortBooksByLastUpdateDate=function(e){void 0===e&&(e=[]),e.sort((function(e,t){return t.lastUpdateDate.getTime()-e.lastUpdateDate.getTime()}))},e.sortBooksByLastAccess=function(e){void 0===e&&(e=[]),e.sort((function(e,t){return t.lastAccessedTime-e.lastAccessedTime}))},e}();t.a=r},340:function(e,t,o){(e.exports=o(97)(!1)).push([e.i,".download-progress-button{position:relative;width:40px;height:40px;display:flex;align-items:center;justify-content:center}.download-progress-button .download-progress-stop-download-icon,.download-progress-button .download-progress-downloaded-icon,.download-progress-button .download-progress-retry-download-icon{display:none}.download-progress-button.downloading .download-progress-start-download-icon,.download-progress-button.downloading .download-progress-downloaded-icon,.download-progress-button.downloading .download-progress-retry-download-icon{display:none}.download-progress-button.downloading .download-progress-stop-download-icon{display:block}.download-progress-button.downloading .download-progress-button-progress-wrapper{display:block}.download-progress-button.downloaded .download-progress-start-download-icon,.download-progress-button.downloaded .download-progress-stop-download-icon,.download-progress-button.downloaded .download-progress-retry-download-icon{display:none}.download-progress-button.downloaded .download-progress-downloaded-icon{display:block}.download-progress-button.downloaded .download-progress-button-icon-wrapper{background-color:#5FC6A3}.download-progress-button.downloaded:hover .download-progress-button-icon-wrapper{background-color:#72cdae}.download-progress-button.downloaded:active .download-progress-button-icon-wrapper,.download-progress-button.downloaded:focus .download-progress-button-icon-wrapper{background-color:#85d3b9}.download-progress-button.download-error .download-progress-start-download-icon,.download-progress-button.download-error .download-progress-stop-download-icon,.download-progress-button.download-error .download-progress-downloaded-icon{display:none}.download-progress-button.download-error .download-progress-retry-download-icon{display:block}.download-progress-button.download-error .download-progress-button-icon-wrapper{background-color:#e77364}.download-progress-button:hover .download-progress-button-icon-wrapper{background-color:#7299c8}.download-progress-button:hover.download-error .download-progress-button-icon-wrapper{background-color:#ea877a}.download-progress-button:active .download-progress-button-icon-wrapper,.download-progress-button:focus .download-progress-button-icon-wrapper{background-color:#84a6cf}.download-progress-button:active.download-error .download-progress-button-icon-wrapper,.download-progress-button:focus.download-error .download-progress-button-icon-wrapper{background-color:#ee9b90}.download-progress-button-icon-wrapper{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background-color:#407fbf;color:white;border-radius:50%;box-shadow:0 2px 4px 0 rgba(0,0,0,0.12)}.download-progress-button-progress-wrapper{position:absolute;display:none;top:0;left:0}.download-progress-ring-circle{transition:0.35s stroke-dashoffset;transform:rotate(-90deg);transform-origin:50% 50%}\n",""])},342:function(e,t,o){"use strict";o.r(t);var n,r=o(1),i=o(18),s=o(5),a=new(function(){function e(){}return e.prototype.load=function(){var e=this;setTimeout((function(){Promise.all([e.getSource()]).then((function(e){e[0].LandingPage.initialize(),$(document).trigger("landingPageCodeLoaded")}))}),5)},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return o.e(23).then(o.bind(null,1299))},e.prototype.clean=function(){this.sourcePromise&&this.sourcePromise.then((function(e){return e.LandingPage.clean()}))},e}()),c=o(9),l=o(94),u=o(16),d=o(3),p=o(8),h=o(79),f=o(96),g=o(6),m=o(15),v=o(25),b=o(7),k=new(function(){function e(){this.renderErrorReportPopup=this.renderErrorReportPopup.bind(this),$(document).on("bookElementIntroArrived",(function(e,t){t&&($("#book-markup-container").html(t),m.a.insertLoadingBoxes())}))}return e.prototype.load=function(e,t,o,n,i){var s=this,a=g.a.getCurrentMainContentTranslateX();0==$("#main-page-content .backend-main-page-content").length&&$("#main-page-content").html(Mustache.render(l.a,{BOOK_ELEMENT_TITLE:u.a.isSpecialPathPartInsteadOfBookElement(t)||u.a.isSpecialFreeEbookOpenPart(t)?u.a.beautifyBookElementShortName(e,!0):u.a.beautifyBookElementShortName(t,!0)||u.a.beautifyBookElementShortName(e,!0)})),u.a.isSpecialFreeEbookOpenPart(t)&&f.a.openCurrentFreeEbook(e),$("html, body").scrollTop(0),g.a.translateMainContent(a);var h=Date.now(),m=!1;n||0!=$(".backend-main-page-content").length||v.a.getBookElementIntro(e,t,o).then((function(e){m||e&&(r.b.isApp()&&(e=e.replace(/\/assets\/images\//g,"assets/images/")),$(document).trigger("bookElementIntroArrived",e))})),d.a.setTimeout((function(){Promise.all([s.getSource(),v.a.getBookElement(e,t,o,n),s.getTimeoutPromise()]).then((function(n){var r=n[0].BookPage,a=n[1];m=!0,$(document).trigger("bookPageCodeLoaded"),r.initialize(a,e,t,o,i),s.activeBook=e;var c=e!=s.activeBook;b.a.isLoggedIn().then((function(e){if(e.loggedIn&&c&&(clearTimeout(s.errorReportTimer),r.getBook().isMeap)){var t=p.a.get("error-modal-last-shown"),o=(Date.now()-new Date(t))/1e3;o/=604800,!p.a.get("stop-showing-error-reports-modal")&&o>1&&(s.errorReportTimer=setTimeout(s.renderErrorReportPopup,3e5),$(document).trigger("meapErrorReportShow"))}}));try{$(document).trigger("chapterLoadingTime",[Math.round((Date.now()-h)/1e3)])}catch(e){console.log(e)}})).catch((function(t){$(document.body).removeClass("app-code-not-loaded");var o=$("#error-modal"),i=r.b.isConnected();o.find("h3 strong").text(n?"Access denied!":"Unable to load book!"),n?o.find(".error-modal-try-again-message").hide():o.find(".error-modal-try-again-message").show(),o.find(".error-modal-try-again-message").text(i?"(try again in a couple of minutes)":"(check your internet connection and try again)");var s="http://www.manning.com/books/"+e;o.find(".book-name-container").attr("href",s).text(e),o.find(".marketplace-link").attr("href",s),o.find(".homepage-link").attr("href",r.b.isApp()?"#!/landing-page":"https://livebook.manning.com"),c.a.showFoundationModal(o)}))}),5)},e.prototype.renderErrorReportPopup=function(){clearTimeout(this.errorReportTimer),h.a.renderErrorReportModal()},e.prototype.clean=function(){this.sourcePromise&&this.sourcePromise.then((function(e){return e.BookPage.clean()}))},e.prototype.partialClean=function(){this.sourcePromise&&this.sourcePromise.then((function(e){return e.BookPage.partialClean()}))},e.prototype.getSource=function(){return this.sourcePromise||(s.a.loadClipboardCode(),s.a.loadCodeMirrorCode(),this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise),this.sourcePromise.catch((function(e){window.handleLivebookAppLoadingError&&window.handleLivebookAppLoadingError()}))),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(0),o.e(1),o.e(2),o.e(46),o.e(11)]).then(o.bind(null,1296))},e.prototype.getTimeoutPromise=function(){return r.b.isApp()?new Promise((function(e,t){d.a.setTimeout((function(){return e()}),200)})):Promise.resolve()},e}()),y=o(67),w=o(141),P=o(0),S=o(22),C=o(17);!function(e){e[e.WishList=0]="WishList",e[e.Tokens=1]="Tokens",e[e.FreePreview=2]="FreePreview"}(n||(n={}));var E=new(function(){function e(){var e=this;this.handleFormSubmission=this.handleFormSubmission.bind(this),$(document).on("wishListAdd",(function(t,o){setTimeout((function(){e.handleWishListAdd(o)}),1e3)})).on("unlockSectionSubsectionSuccess unlockBookElementSuccess unlockParagraphSuccess",(function(){e.handleTokenUnlockSuccess()})).on("halfWayThroughFreePreview",(function(){return e.handleHalfWayThroughFreePreview()})),$(document.body).append(x),$("#marketing-subscription-form .marketing-subscription-close-button").on("click",(function(){return e.hideSubscribeForm()})),$("#marketing-subscription-form").on("submit",this.handleFormSubmission)}return e.prototype.initialize=function(){},e.prototype.handleHalfWayThroughFreePreview=function(){this.productId=C.a.book&&C.a.book.manningId,this.subscriptionType=n.FreePreview,this.showMarketingSubscriptionFormIfNecessary()},e.prototype.handleTokenUnlockSuccess=function(){this.productId=C.a.book&&C.a.book.manningId,this.subscriptionType=n.Tokens,this.showMarketingSubscriptionFormIfNecessary()},e.prototype.handleWishListAdd=function(e){this.productId=e,this.subscriptionType=n.WishList,this.showMarketingSubscriptionFormIfNecessary()},e.prototype.handleFormSubmission=function(e){return e.preventDefault(),this.sendMarketingSubscription($("#marketing-subscription-form input").val()),this.hideSubscribeForm(),!1},e.prototype.sendMarketingSubscription=function(e){$(document).trigger("marketingEmailSubscription",["submitted",this.subscriptionType]),P.a.getFromOurBackend(P.a.getAbsoluteUrl(this.getAppropriateRoute()),(function(e){p.a.set("email-subscription-given",!0),$(document).trigger("requestNotification","Thank you!")}),(function(e){}),{bookId:this.productId,email:e},!1)},e.prototype.getAppropriateRoute=function(){switch(this.subscriptionType){case n.FreePreview:return"/api/marketingSubscription/createFreePreviewEmailSubscription";case n.Tokens:return"/api/marketingSubscription/createTokensEmailSubscription";case n.WishList:return"/api/marketingSubscription/createWishListEmailSubscription"}},e.prototype.showMarketingSubscriptionFormIfNecessary=function(){b.a.isCurrentlyLoggedIn()&&(p.a.get("email-subscription-offered")||($(document).trigger("marketingEmailSubscription",["offered",this.subscriptionType]),p.a.set("email-subscription-offered",!0),S.a.getUserEmail().then((function(e){$("#marketing-subscription-form input").val(e||"")})),$("#marketing-subscription-form").removeClass("hidden"),d.a.setTimeout((function(){r.b.isTouchDevice()||$("#marketing-subscription-form input").focus(),$("#marketing-subscription-form").addClass("show")}),16)))},e.prototype.hideSubscribeForm=function(){$("#marketing-subscription-form").removeClass("show"),d.a.setTimeout((function(){$("#marketing-subscription-form").addClass("hidden"),$("#marketing-subscription-form input").val("")}),250)},e}()),x='<form id="marketing-subscription-form" class="hidden">\n    <div class="marketing-subscription-title-container">Sign up to our mailing list for exclusive discounts and updates on this and other Manning products.</div>\n    <div class="marketing-subscription-email-input-container">\n        <input type="email" placeholder="email" required/>\n        <button type="submit" class="marketing-subscription-confirm">subscribe</button>\n    </div>\n    <div class="marketing-subscription-close-button"><i class="fa fa-close"></i></div>\n</form>',T=o(80),B=o(81),I=o(130),A=o(131),O=$(document),M={intro:{url:"assets/sounds/intro.mp3",volume:.2},outro:{url:"assets/sounds/Chapter Music_1.mp3",volume:.8},skip:{url:"assets/sounds/skip.mp3",volume:.2},notice:{url:"assets/sounds/notice.mp3",volume:.5},noticeSubtle:{url:"assets/sounds/Pause_Sound_Lite3.mp3",volume:.5},exerciseReached:{url:"assets/sounds/exercise.mp3",volume:.3},exerciseOpen:{url:"assets/sounds/exercise_open.mp3",volume:.3},exerciseClose:{url:"assets/sounds/exercise_close.mp3",volume:.3},exerciseReset:{url:"assets/sounds/erase.mp3",volume:.5},hintExplanationOpen:{url:"assets/sounds/open_hint.mp3",volume:.5},hintExplanationClose:{url:"assets/sounds/close_hint.mp3",volume:.5},exerciseShowAnswers:{url:"assets/sounds/show_answers.mp3",volume:.3},answerGiven:{url:"assets/sounds/true_false_click.mp3",volume:.3},correct:{url:"assets/sounds/correct.mp3",volume:.4},error:{url:"assets/sounds/error.mp3",volume:.4},sideMenu:{url:"assets/sounds/side_menu_woosh.mp3",volume:.2},settingsMenuClick:{url:"assets/sounds/settings_menu_click.mp3",volume:.3},tocClick:{url:"assets/sounds/toc_click.mp3",volume:1},closeCodeModal:{url:"assets/sounds/code_modal_close.mp3",volume:1},codeReset:{url:"assets/sounds/code_reset.mp3",volume:1},codeRun:{url:"assets/sounds/code_run.mp3",volume:1},showResult:{url:"assets/sounds/show_result.mp3",volume:1}},N=new(function(){function e(){this.handleSoundEffectsClick=this.handleSoundEffectsClick.bind(this),this.handleSettingsUpdated=this.handleSettingsUpdated.bind(this)}return e.prototype.initalize=function(){this.initializeAudioElement(),this.$soundEffectsCheckbox=$("#sound-effects-checkbox"),this.$soundEffectLabel=$("#sound-effects-label"),this.$soundEffectsCheckbox.on("click",this.handleSoundEffectsClick),this.$soundEffectLabel.on("click",this.handleSoundEffectsClick),O.on("settingsUpdated",this.handleSettingsUpdated),this.registerEventHandlers()},e.prototype.handleSettingsUpdated=function(){this.setSoundEffectsMode(!!p.a.get("sound-effects-enabled"))},e.prototype.setSoundEffectsMode=function(e){this.$soundEffectsCheckbox.toggleClass("selected",e),this.areSoundEffectsEnabled=e,e&&this.preloadAudio(),p.a.set("sound-effects-enabled",e)},e.prototype.handleSoundEffectsClick=function(){this.setSoundEffectsMode(!this.$soundEffectsCheckbox.is(".selected")),O.trigger("settingsMenuItemClick")},e.prototype.preloadAudio=function(){if(!this.areSoundsPreloaded)for(var e in M)M.hasOwnProperty(e)&&$.ajax({url:M[e].url})},e.prototype.initializeAudioElement=function(){this.audioElement||(this.audioElement=document.createElement("audio"),document.body.appendChild(this.audioElement))},e.prototype.registerEventHandlers=function(){var e=this;O.on("exerciseAnsweredCorrectly",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.correct)})),O.on("exerciseAnsweredIncorrectly",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.error)})),O.on("audioChapterEnded",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.outro)})),O.on("requestAudioMoveToCuePosition",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.skip)})),O.on("requestChapterIntroPlay",(function(){e.areSoundEffectsEnabled?($(e.audioElement).one("ended",(function(){return O.trigger("chapterIntroPlayed")})),e.playAudio(M.intro)):O.trigger("chapterIntroPlayed")})),O.on("browsableReached",(function(){e.areSoundEffectsEnabled&&d.a.setTimeout((function(){return e.playAudio(M.notice)}),400)})),O.on("cueballReached",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.noticeSubtle)})),O.on("exerciseReached",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.exerciseReached)})),O.on("collapsiblePanelOpening",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.exerciseOpen)})),O.on("collapsiblePanelClosing",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.exerciseClose)})),O.on("exerciseHintExplanationOpened",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.hintExplanationOpen)})),O.on("exerciseHintExplanationClosed",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.hintExplanationClose)})),O.on("slideMenuOpened slideMenuClosed",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.sideMenu)})),O.on("tocMenuClick",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.tocClick)})),O.on("exerciseAnswerGiven",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.answerGiven)})),O.on("exerciseAnswersShown",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.exerciseShowAnswers)})),O.on("exerciseReset",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.exerciseReset)})),O.on("settingsMenuItemClick",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.settingsMenuClick)})),O.on("codeReset",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.codeReset)})),O.on("codeRun",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.codeRun)})),O.on("codeShowResult codeHideResult",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.showResult)})),O.on("soundSkipped",(function(){e.areSoundEffectsEnabled&&e.playAudio(M.skip)}))},e.prototype.playAudio=function(e){this.audioElement.src=e.url,this.audioElement.volume=e.volume;try{var t=this.audioElement.play();null!=t&&t.catch instanceof Function&&t.catch((function(e){return console.log("Couldn't play audio")}))}catch(e){console.log("Couldn't play sound effect",e)}},e}()),D=o(57),_=o(75),L=new(function(){function e(){this.loadCodeOnInteraction=this.loadCodeOnInteraction.bind(this),$(document).on("click",".main-token-status-container",this.loadCodeOnInteraction)}return e.prototype.load=function(){this.getSource().then((function(e){return e.TokenModal.initialize()}))},e.prototype.clean=function(){this.sourcePromise&&this.getSource().then((function(e){return e.TokenModal.clean()}))},e.prototype.loadCodeOnInteraction=function(e){$(document).off("click",".main-token-status-container",this.loadCodeOnInteraction),this.getSource().then((function(e){return e.TokenModal.show()})),e&&e.stopImmediatePropagation()},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(5),o.e(0),o.e(1),o.e(2),o.e(26)]).then(o.bind(null,593))},e}()),U=o(4),F=new(function(){function e(){}return e.prototype.load=function(e){void 0===e&&(e=""),this.getSource().then((function(t){t.ExerciseSuitePage.initialize(e)}))},e.prototype.clean=function(){this.sourcePromise&&this.getSource().then((function(e){var t=e.ExerciseSuitePage;$(document).trigger("pageAppCodeLoaded"),t.clean()}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(3),o.e(4),o.e(7),o.e(0),o.e(18)]).then(o.bind(null,1298))},e}()),R=new(function(){function e(){}return e.prototype.load=function(e){this.getSource().then((function(t){var o=t.CatalogPage;$(document).trigger("catalogPageCodeLoaded"),o.initialize(e)}))},e.prototype.clean=function(){this.sourcePromise&&this.getSource().then((function(e){e.CatalogPage.clean()}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return o.e(14).then(o.bind(null,1289))},e}()),z=new(function(){function e(){}return e.prototype.load=function(){this.getSource().then((function(e){var t=e.LibraryPage;$(document).trigger("libraryPageCodeLoaded"),t.initialize()}))},e.prototype.clean=function(){this.sourcePromise&&this.getSource().then((function(e){e.LibraryPage.clean()}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return o.e(24).then(o.bind(null,1290))},e}()),W=new(function(){function e(){}return e.prototype.load=function(){this.getSource().then((function(e){var t=e.TryItPage;$(document).trigger("pageAppCodeLoaded"),t.initialize()}))},e.prototype.clean=function(){this.sourcePromise&&this.getSource().then((function(e){return e.TryItPage.clean()}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return o.e(35).then(o.bind(null,1291))},e}()),q=new(function(){function e(){}return e.prototype.load=function(e,t,o,n){var r=this;$("#main-page-content").html(Mustache.render(l.a,{BOOK_ELEMENT_TITLE:u.a.beautifyBookElementShortName(t,!0)||u.a.beautifyBookElementShortName(e,!0)})),setTimeout((function(){Promise.all([r.getSource(),v.a.getBookElement(e,t,o,n)]).then((function(n){var r=n[0].EditorPage,i=n[1];$(document).trigger("editorPageCodeLoaded"),r.initialize(i,e,t,o)})).catch((function(t){var o=$("#error-modal"),n="http://www.manning.com/books/"+e;o.find(".book-name-container").attr("href",n).text(e),o.find(".marketplace-link").attr("href",n),c.a.showFoundationModal(o)}))}),5)},e.prototype.clean=function(){this.sourcePromise&&this.sourcePromise.then((function(e){return e.EditorPage.clean()}))},e.prototype.partialClean=function(){this.sourcePromise&&this.sourcePromise.then((function(e){return e.EditorPage.partialClean()}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(0),o.e(1),o.e(6),o.e(16)]).then(o.bind(null,1292))},e}()),H=o(136),V=o(135),j=o(144),K=o(14),J=o(29),G=function(){function e(){}return e.prototype.insertNecessaryElements=function(){null==document.getElementById("liveaudio-corner")&&($(document.body).append(Y),$(document.body).append(X),$(document.body).append(Z),$(document.body).append(Q))},e}(),Y='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792" style="display: none;"><symbol id="liveaudio-corner"><path d="M 1792,0 V 1792 H 0 Z" style="fill:#ffcc00" /><path style="fill:#000000"d="m 1225.7239,1040.0538 v 463.2689 q 0,11.0707 -8.0902,19.1609 -8.0902,8.0902 -19.1609,8.0902 -11.0708,0 -19.161,-8.0902 L 1037.5209,1380.6927 H 925.9617 q -11.07076,0 -19.16093,-8.0902 -8.09018,-8.0902 -8.09018,-19.161 v -163.5066 q 0,-11.0708 8.09018,-19.161 8.09017,-8.0901 19.16093,-8.0901 h 111.5592 l 141.7909,-141.791 q 8.0902,-8.0901 19.161,-8.0901 11.0707,0 19.1609,8.0901 8.0902,8.0902 8.0902,19.161 z m 163.5067,231.6344 q 0,32.3607 -18.0965,60.2505 -18.0964,27.8898 -47.9023,39.8122 -4.258,2.129 -10.645,2.129 -11.0708,0 -19.1609,-7.8773 -8.0902,-7.8773 -8.0902,-19.3738 0,-8.9418 5.1096,-15.1159 5.1096,-6.1741 12.3481,-10.645 7.2386,-4.4708 14.4772,-9.7933 7.2386,-5.3225 12.3482,-15.3288 5.1095,-10.0062 5.1095,-24.0576 0,-14.0514 -5.1095,-24.0576 -5.1096,-10.0063 -12.3482,-15.3288 -7.2386,-5.3225 -14.4772,-9.7933 -7.2385,-4.4709 -12.3481,-10.645 -5.1096,-6.1741 -5.1096,-15.1159 0,-11.4965 8.0902,-19.3738 8.0901,-7.8773 19.1609,-7.8773 6.387,0 10.645,2.129 29.8059,11.4966 47.9023,39.5993 18.0965,28.1027 18.0965,60.4634 z m 109.0044,0 q 0,65.1472 -36.1929,120.2881 -36.1929,55.1409 -95.8047,80.2631 -5.5353,2.129 -10.6449,2.129 -11.4966,0 -19.5868,-8.0902 -8.0901,-8.0902 -8.0901,-19.161 0,-16.6061 16.6061,-25.1221 23.8447,-12.3481 32.3607,-18.7351 31.5091,-22.9931 49.1797,-57.6957 17.6707,-34.7026 17.6707,-73.8761 0,-39.1735 -17.6707,-73.8761 -17.6706,-34.7025 -49.1797,-57.6957 -8.516,-6.387 -32.3607,-18.7351 -16.6061,-8.516 -16.6061,-25.1221 0,-11.0708 8.0901,-19.161 8.0902,-8.0901 19.161,-8.0901 5.5354,0 11.0707,2.1289 59.6118,25.1222 95.8047,80.2631 36.1929,55.1409 36.1929,120.2881 z m 109.0045,0 q 0,97.9337 -54.0765,179.8999 -54.0764,81.9663 -143.9199,120.7139 -5.5354,2.129 -11.0708,2.129 -11.0707,0 -19.1609,-8.0901 -8.0902,-8.0902 -8.0902,-19.161 0,-15.3287 16.6062,-25.1221 2.9806,-1.7032 9.5804,-4.4709 6.5999,-2.7677 9.5805,-4.4709 19.5867,-10.6449 34.9155,-21.7157 52.3732,-38.7477 81.7533,-96.6563 29.3801,-57.9086 29.3801,-123.0558 0,-65.1472 -29.3801,-123.0558 -29.3801,-57.9086 -81.7533,-96.6563 -15.3288,-11.0707 -34.9155,-21.7157 -2.9806,-1.7032 -9.5805,-4.4709 -6.5998,-2.7677 -9.5804,-4.4709 -16.6062,-9.7933 -16.6062,-25.12205 0,-11.07076 8.0902,-19.16093 8.0902,-8.09018 19.1609,-8.09018 5.5354,0 11.0708,2.129 89.8435,38.74766 143.9199,120.71386 54.0765,81.9662 54.0765,179.8999 z"/></symbol></svg>',X='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10.583333 10.583334" height="40" width="40" style="display: none"><symbol id="token-icon"><g transform="translate(0,-286.41666)"> <path transform="matrix(0.26458334,0,0,0.26458334,0,286.41666)" d="M 20 0 A 19.999999 19.999999 0 0 0 0 20 A 19.999999 19.999999 0 0 0 20 40 A 19.999999 19.999999 0 0 0 40 20 A 19.999999 19.999999 0 0 0 20 0 z M 20 3 A 16.999999 16.999999 0 0 1 37 20 A 16.999999 16.999999 0 0 1 20 37 A 16.999999 16.999999 0 0 1 3 20 A 16.999999 16.999999 0 0 1 20 3 z M 20 6 C 12.268001 6 6 12.267994 6 20 C 6 27.731968 12.268001 34 20 34 C 27.732 34 34 27.731968 34 20 C 34 12.267994 27.732 6 20 6 z M 12 14 L 28 14 L 28 18 L 22 18 L 22 29 L 18 29 L 18 18 L 12 18 L 12 14 z " style="opacity:1;fill-opacity:1;stroke:none;stroke-width:2.90095091;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" fill="currentColor" /></g></symbol></svg>',Z='<div id="books-menu" class="slide-in-menu closed"><div class="slide-in-menu-container"><div class="loading-container"><i class="fa fa-spin fa-circle-o-notch fa-3x fa-fw"></i></div></div></div>',Q='<div id="confirm-modal" class="reveal-modal" data-reveal data-options="close_on_background_click: false; close_on_esc:false;"></div>',ee=new G,te=new(function(){function e(){}return e.prototype.initialize=function(){this.getSource().then((function(e){return e.GeoMapManager.initialize()}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(41),o.e(0),o.e(1),o.e(2),o.e(21)]).then(o.bind(null,1293))},e}()),oe=o(74),ne=new(function(){function e(){}return e.prototype.load=function(){this.getSource().then((function(e){var t=e.EpubPreviewPage;$(document).trigger("pageAppCodeLoaded"),t.initialize()}))},e.prototype.clean=function(){this.sourcePromise&&this.getSource().then((function(e){return e.EpubPreviewPage.clean()}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=s.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(6),o.e(17)]).then(o.bind(null,1300))},e}()),re=o(73),ie=o(133),se=o(179),ae=new(function(){function e(){}return e.prototype.triggerSynchronization=function(){var e=this;return this.synchronization?this.synchronization:this.synchronization=new Promise((function(t,o){return Promise.all([re.a.syncProgressWithServer(),ie.a.syncTextAddonsWithServer(),se.a.syncWithServer()]).then((function(){e.synchronization=null,t()})).catch((function(t){e.synchronization=null,o(t)}))}))},e}()),ce=new(function(){function e(){this.isUpdatingBooks=!1}return e.prototype.initialize=function(){var e=this;$(document).on("requestBookUpdates",(function(){b.a.isLoggedIn().then((function(t){t.loggedIn&&e.updateDownloadedBooks()}))}))},e.prototype.updateDownloadedBooks=function(){var e=this;r.b.isConnected()&&!this.isUpdatingBooks&&(this.isUpdatingBooks=!0,v.a.getDownloadedBooksShortNamesAndSlugs().then((function(t){var o=[],n={};for(var r in t)n[t[r].shortName]||t[r].shortName&&(o.push(t[r].shortName),n[t[r].shortName]=!0);e.updateBooks(o)})))},e.prototype.updateBooks=function(e){var t=this;if(null!=e&&0!=e.length){var o=e.pop();this.updateBook(o).then((function(){t.updateBooks(e)})).catch((function(o){t.updateBooks(e)}))}else this.isUpdatingBooks=!1},e.prototype.updateBook=function(e){return new Promise((function(t,o){Promise.all([v.a.getBook(e,"-1",!1),v.a.getBook(e,"-1",!0)]).then((function(e){var n=e[0],r=e[1];null!=n&&null!=r&&(n.isMeap&&!r.isMeap||n.isMeap&&r.isMeap&&n.latestMeapVersion<r.latestMeapVersion)?T.a.performAutomaticBookDownload(r).then((function(){return t()})).catch((function(e){return o(e)})):t()})).catch((function(e){return o(e)}))}))},e}()),le=new(function(){function e(){this.HTML='<div id="zen-mode-button">\n                        <i class="fa fa-eye" aria-hidden="true"></i>\n                        <i class="fa fa-eye-slash" aria-hidden="true"></i>\n                    </div>'}return e.prototype.initialize=function(){var e=this;C.a.zenModeShow&&($("#zen-mode-button").length>0||($(document.body).append(this.HTML),$("#zen-mode-button").on("click",(function(){return e.setZenMode(!e.zen)})),$(document).on("fullscreenchange",(function(t){e.setZenMode(null!=document.fullscreenElement)}))))},e.prototype.setZenMode=function(e){this.zen=e,$(document.body).toggleClass("zen-mode",this.zen),this.zen?this.enterFullScreen():this.exitFullScreen()},e.prototype.enterFullScreen=function(){document.documentElement.requestFullscreen()},e.prototype.exitFullScreen=function(){null!=document.fullscreenElement&&document.exitFullscreen&&document.exitFullscreen()},e}()),ue=o(178),de=$(document),pe=void 0;try{window.hasLivebookVendorLoadingErrors&&window.handleLivebookAppLoadingError()}catch(e){}B.a.initializeAnalyticsIfNecessary(),ue.a.initialize();var he=[];r.b.loadDeviceInfo().then((function(e){$("body").addClass(e.platformString),N.initalize(),V.a.initialize(),U.a.containsAtLeastOneOf(document.location.hash||document.location.pathname,["token-ledger","token-modal","token-cashout","get-tokens"])&&($(document).trigger("requestNotification","loading token data ..."),L.load()),I.a.initialize(),A.a.initialize(),le.initialize(),E.initialize(),y.a.initialize(),w.a.initialize(),H.a.initialize(),h.a.initialize(),te.initialize(),pe&&(T.a.initialize(),oe.a.initialize(),b.a.isLoggedIn().then((function(e){e.loggedIn||J.a.requestOpenModal("","","",K.a.getItem("email"))})))}));var fe,ge=Date.now(),me=0;function ve(e){var t=e||function(){var e="";try{(e=(e=-1!=document.location.pathname.indexOf("/book/")?document.location.pathname:document.location.hash||("/"!=document.location.pathname?document.location.pathname:"")||document.location.search||"").replace("?_escaped_fragment_=/","").replace("#%21/","#!/").replace("#!//","").replace("#!/","").replace("#!book","book")).startsWith("/")&&(e=e.substring(1))}catch(e){return""}return e}();if(t.indexOf("index.html")>=0&&(t=(t=t.substring(t.lastIndexOf("index.html")+"index.html".length)).replace("//","/")).startsWith("/")&&(t=t.substring(1)),t.startsWith("catalog")){var o={};if(new page.Route(i.a.catalogRoute,{}).match("/"+t,o))return void Te({params:o})}else if(t.startsWith("library"))xe();else if(t.startsWith("book")){o={};if(new page.Route(i.a.meapElementRoute,{}).match("/"+t,o))return void ye({params:o});if(new page.Route(i.a.reviewElementRoute,{}).match("/"+t,o))return void ye({params:o});new page.Route(i.a.bookElementRoute).match("/"+t,o)?ye({params:o}):be()}else if(t.startsWith("exercise-examples"))Pe();else if(t.startsWith("exercise-suite")){o={};new page.Route(i.a.exerciseSuiteRoute).match("/"+t,o)?Pe({params:o}):be()}else if(t.startsWith("try-it"))Se();else if(t.startsWith("epub-preview"))Ce();else if(t.startsWith("edit")){o={};if(new page.Route(i.a.meapEditorRoute).match("/"+t,o))return void Ee({params:o});if(new page.Route(i.a.reviewEditorRoute).match("/"+t,o))return void Ee({params:o});new page.Route(i.a.editorRoute).match("/"+t,o)?Ee({params:o}):be()}else t.startsWith("discussion")?(be(),setTimeout((function(){return y.a.requestOpen()}),1e3)):t.startsWith("signin")?(document.location.hash="",be(),b.a.isLoggedIn().then((function(e){e.loggedIn||J.a.requestOpenModal("signin","sign in to complete your registration","registration",K.a.getItem("email"))})).catch((function(e){J.a.requestOpenModal("signin","sign in to complete your registration","registration",K.a.getItem("email"))}))):t.startsWith("sitemap")?(Ae("sitemap"),de.trigger("sitemapPageCodeLoaded")):be()}function be(){ke()}function ke(){Ae("#!/landing-page"),Be(),a.load(),j.a.initialize(),de.trigger("pageLoaded")}function ye(e){var t=i.a.getCurrentRouteInfo();Ae(e&&e.params.book?"book/"+e.params.book+"/"+(e.params.bookElement||""):""),t&&t.book===e.params.book&&e.params.bookElement?Ie():Be(),e.params.reviewVersion?b.a.isLoggedIn().then((function(t){t.loggedIn?we(e):J.a.requestLogin("","")})):!b.a.isCurrentlyLoggedIn()&&P.a.hasSsoCookie()?b.a.isLoggedIn().then((function(t){we(e)})):we(e),me++,de.trigger("pageLoaded")}function we(e){k.load(e.params.book,(e.params.bookElement||"").replace(/^search-/,""),e.params.meapVersion,e.params.reviewVersion,e.params.additional)}function Pe(e){Ae(e&&e.canonicalPath),Be(),F.load(null!=e&&null!=e.params?e.params.exerciseSuite:""),de.trigger("pageLoaded")}function Se(){Ae("try-it"),Be(),W.load(),de.trigger("pageLoaded")}function Ce(){Ae("epub-preview"),Be(),ne.load(),de.trigger("pageLoaded")}function Ee(e){Ae(e&&e.canonicalPath),Be(),q.load(e.params.book,(e.params.bookElement||"").replace(/^search-/,""),e.params.meapVersion,e.params.reviewVersion),de.trigger("pageLoaded")}function xe(){b.a.isLoggedIn().then((function(e){e.loggedIn?(Ae("library"),Be(),z.load(),de.trigger("pageLoaded")):page("/")}))}function Te(e){Ae(e&&e.canonicalPath),Be(),R.load(e&&e.params&&e.params.category),de.trigger("pageLoaded")}function Be(){Ie(),0==$("#main-page-content .backend-main-page-content").length&&$("#main-page-content").html('<div class="book-content-loader loader"></div>'),z.clean(),k.clean(),a.clean(),R.clean(),F.clean(),L.clean(),W.clean(),q.clean()}function Ie(){d.a.clearTimers(),z.clean(),k.partialClean(),R.clean(),D.a.hideNotification()}function Ae(e,t){if(void 0===e&&(e=""),pe&&(0==he.length&&"#!/landing-page"!=e&&he.push("#!/landing-page"),he[he.length-1]!=e&&he.push(e),function(){if(pe){var e=$("#livebook-button");he.length<=1?(e.removeClass("history-back-button"),e.find("i").removeClass().addClass("fa fa-home")):(e.addClass("history-back-button"),e.removeAttr("style"),e.find("i").removeClass().addClass("fa fa-arrow-left"),e.attr("title","go back"))}}()),!pe&&(Date.now()-ge>C.a.refreshDataAfter||me>15||t)){if(ge=Date.now(),e)return 0==e.indexOf("book/")&&(e="/"+e),void(location.href=e);P.a.reloadPage()}}!function(){page(i.a.meapElementRoute,(function(e){return ye(e)})),page(i.a.reviewElementRoute,(function(e){return ye(e)})),page(i.a.bookElementRoute,(function(e){return ye(e)})),page(i.a.exerciseSuiteRoute,(function(e){return Pe(e)})),page("/",(function(){return be()})),page(i.a.catalogRoute,(function(e){return Te(e)})),page("/library",(function(){return xe()})),page("/exercise-examples",(function(e){return Pe(e)})),page("/landing-page",(function(){return ke()})),page("/try-it",(function(e){return Se()})),page("/sitemap",(function(e){document.location=e.path})),page("epub-preview",(function(){return Ce()})),page(i.a.editorRoute,(function(e){return Ee(e)})),page(i.a.meapEditorRoute,(function(e){return Ee(e)})),page(i.a.reviewEditorRoute,(function(e){return Ee(e)})),page("*",(function(){return setTimeout((function(){return ve()}),50)})),page({hashbang:!!pe,dispatch:!1}),document.location.hash||"/"!=document.location.pathname?ve():-1!=document.location.href.indexOf("_escaped_fragment_=")?ve():be();P.a.isAdditionalInstruction("openShoppingCart")&&(P.a.removeAdditionalInstruction(),setTimeout((function(){return _.a.requestMenuOpen()}),400))}(),ee.insertNecessaryElements();try{$(document).foundation()}catch(e){console.error("Error initializing foundation",e)}function Oe(e){if($(e.currentTarget).is(".history-back-button")){he.pop();var t=he.pop();return t&&page(t),!1}page("#!/landing-page")}de.on("ready",(function(){$("#top-bar-container .product-title").on("click",(function(){page("/")}))})),pe&&(r.b.isConnected()?($(document.body).addClass("online").removeClass("offline"),ae.triggerSynchronization()):$(document.body).removeClass("online").addClass("offline"),(fe=document.createElement("base")).setAttribute("href",document.location.href),document.head.appendChild(fe),ce.initialize(),$(document).trigger("requestBookUpdates")),pe&&(r.b.isTouchDevice()?$("#livebook-button").on("touchstart",Oe):$("#livebook-button").on("click",Oe))},4:function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));var n=o(3),r=["January","February","March","April","May","June","July","August","September","October","November","December"],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],s=new(function(){function e(){}return e.prototype.hasNumberProperties=function(e){if(!e)return!1;try{var t=!1;for(var o in e)if(t=!0,"number"!=typeof e[o])return!1;return t}catch(e){return!1}},e.prototype.getShortMonthName=function(e){return null==e?"":i[e.getMonth()]},e.prototype.getTodaysDateAsString=function(){var e=(new Date).toISOString(),t=e.indexOf("T");return t<=0?e:e.substring(0,t)},e.prototype.startsWithNumber=function(e){return null!=(e||"").match(/^\d/)},e.prototype.separateNumber=function(e){if(!e)return e;var t=(e||"").match(/^\d+/);return null==t?e:t[0]?this.trimAndCollapseMultipleWhitespace(e.replace(t[0],t[0]+" ")):e},e.prototype.joinNumber=function(e){if(!e)return e;var t=(e||"").match(/^\d+\s/);return null==t?e:t[0]?e.replace(t[0],t[0].trim()):e},e.prototype.formatMoney=function(e){return(e||0).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")},e.prototype.b64DecodeUnicode=function(e){try{return decodeURIComponent(atob(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}catch(t){return atob(e)}},e.prototype.getArrayIntersection=function(e,t){var o=[];if(null==e||null==t||0==e.length||0==t.length)return o;for(var n=0,r=e;n<r.length;n++){var i=r[n];t.indexOf(i)>=0&&o.push(i)}return o},e.prototype.groupInto=function(e,t){void 0===t&&(t=10);var o=[];if(!e||0==e.length)return o;for(var n=[],r=0;r<e.length;r++)r%t==0&&(n=[],o.push(n)),n.push(e[r]);return o},e.prototype.isNumber=function(e){try{return!isNaN(+e)}catch(e){return!1}},e.prototype.isEmptyObject=function(e){return!!e&&(0===Object.keys(e).length&&e.constructor===Object)},e.prototype.containsAtLeastOneOf=function(e,t){if(!e||!t||!t.length)return!1;for(var o=0,n=t;o<n.length;o++){var r=n[o];if(-1!=e.indexOf(r))return!0}return!1},e.prototype.getTimeoutPromise=function(e){return void 0===e&&(e=500),new Promise((function(t){setTimeout(t,e)}))},e.prototype.isToday=function(e){if(null==e||!(e instanceof Date))return!1;var t=new Date;return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},e.prototype.getDifferenceInDays=function(e,t){if(null==e||null==t)return 0;return Math.round(Math.abs((e.getTime()-t.getTime())/864e5))},e.prototype.getDateFromString=function(e){var t=new Date(e);try{if("Invalid Date"==t&&e){var o=e.indexOf("T");o>0&&(t=new Date(e.substring(0,o)))}}catch(e){console.log("Error getting date from string",e)}return t},e.prototype.getDateAsString=function(e){if(!e)return"";var t=e.getMonth(),o=e.getFullYear();return Number.isNaN(t)||Number.isNaN(o)?"":r[t]+" "+o},e.prototype.removeItemFromArray=function(e,t){if(!e)return null;var o=e.indexOf(t);return o>=0?e.splice(o,1):null},e.prototype.turnIntoMapByProperty=function(e,t){for(var o={},n=0,r=e;n<r.length;n++){var i=r[n];o[i[t]]=i}return o},e.prototype.getUniqueStringItems=function(e){for(var t=[],o={},n=0,r=e;n<r.length;n++){var i=r[n];o[i]||(t.push(i),o[i]=!0)}return t},e.prototype.getUniqueNumbers=function(e){for(var t=[],o={},n=0,r=e;n<r.length;n++){var i=r[n];o[i]||(t.push(i),o[i]=!0)}return t},e.prototype.getUniqueEntries=function(e,t){var o=this.turnIntoMapByProperty(e,t),n=[];for(var r in o)n.push(o[r]);return n},e.prototype.getRandomArrayItem=function(e){return e&&0!==e.length?e[Math.floor(Math.random()*e.length)]:null},e.prototype.getRandomNumber=function(e,t){return Math.floor(Math.random()*t)+e},e.prototype.getMonthAndYear=function(e){if(!e)return null;var t=e.toLocaleString("en-us",{month:"long"});return e.getFullYear,t+" "+e.getFullYear()},e.prototype.getAllRegExMatches=function(e,t){e=new RegExp(e);for(var o=[],n=[];null!==(n=e.exec(t));)o.push(n[0]);return o},e.prototype.flatten=function(e){return[].concat.apply([],e)},e.prototype.insertAtPosition=function(e,t,o){return e?e.slice(0,o)+t+e.slice(o):t},e.prototype.trimAndCollapseMultipleWhitespace=function(e){return e.trim().replace(/\s{2,}/g," ")},e.prototype.trimEnd=function(e,t){if(void 0===t&&(t=" "),!e)return e;for(var o=e.length-1;o>=0&&e.charAt(o)==t;)o--;return e.substring(0,o+1)},e.prototype.mapToArray=function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(e[o]);return t},e.prototype.asyncForIn=function(e,t,o){e||o&&o();var n=[];for(var r in e)e.hasOwnProperty(r)&&n.push({key:r,value:e[r]});this.asyncEach(n,(function(e){return t&&t(e.key,e.value)}),(function(){return o&&o()}))},e.prototype.asyncEach=function(e,t,o,r){void 0===r&&(r=1),e&&0!=e.length||o&&o();var i=0,s=!1;!function a(){if(!s){var c=e[i++];c?(t&&t(c),n.a.setTimeout(a,r)):(s=!0,o&&o())}}()},e.prototype.randomizeArray=function(e){if(e&&null!=e.length){for(var t,o,n=e.length;0!==n;)o=Math.floor(Math.random()*n),t=e[n-=1],e[n]=e[o],e[o]=t;return e}},e.prototype.endsWithOneOf=function(e,t,o){if(void 0===o&&(o=!1),!e)return!1;if(!t||!t.length)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(this.endsWith(e,i,o))return!0}return!1},e.prototype.endsWith=function(e,t,o,n){void 0===o&&(o=!1),("number"!=typeof n||!isFinite(n)||Math.floor(n)!==n||n>e.length)&&(n=e.length),o&&(e=(e||"").toLowerCase(),t=(t||"").toLowerCase()),n-=t.length;var r=e.lastIndexOf(t,n);return-1!==r&&r===n},e.prototype.turnToOldFormatShortName=function(e){return e?this.capitalizeFirstLetter(e.replace("-"," ")):e},e.prototype.capitalizeFirstLetter=function(e){return null==!e?e:e.substring(0,1).toUpperCase()+e.substring(1)},e.prototype.areApproximatelyEqual=function(e,t,o){return void 0===o&&(o=.001),Math.abs(e-t)<o},e.prototype.getWithoutLastWordOrFullIfSingleWord=function(e){if(!e)return e;var t=e.lastIndexOf(" ");return-1!=t?e.substring(0,t):e},e.prototype.getLastWordOrEmptyIfSingleWord=function(e){if(!e)return e;var t=e.lastIndexOf(" ");return-1!=t?e.substring(t):""},e.prototype.getNumberOfWords=function(e){if(!e||!e.match)return 0;var t=e.match(/\b(\w+)\b/g);return null==t?0:t.length},e.prototype.roundToTwoDecimalPoints=function(e){return Math.round(100*e)/100},e.prototype.arrayIntersection=function(e,t){var o=[];if(null==e||0==e.length||null==t||0==t.length)return o;for(var n=0,r=e;n<r.length;n++){var i=r[n];t.indexOf(i)>=0&&o.push(i)}return o},e.prototype.arrayDifference=function(e,t){var o=[];if(null==e||0==e.length)return o;if(null==t||0==t.length)return o.concat(e);for(var n=0,r=e;n<r.length;n++){var i=r[n];-1==t.indexOf(i)&&o.push(i)}return o},e.prototype.formatTimeInSeconds=function(e){var t=~~(e/3600),o=~~(e%3600/60),n=e%60,r="";return t>0&&(r+=t+":"+(o<10?"0":"")),r+=o+":"+(n<10?"0":""),r+=""+n},e.prototype.escapeHtml=function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):e},e.prototype.extractDataProperties=function(e){if(!e)return e;if(!(e instanceof Object))return e;var t={};for(var o in e)e[o]instanceof Function||(t[o]=e[o]);return t},e.prototype.numberWithCommas=function(e){try{return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}catch(t){return e}},e.prototype.getCurrentTimezone=function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){return""}},e.prototype.countOccurences=function(e,t){if(!e||!t)return 0;for(var o=0,n=0,r=e.length;!((n=t.indexOf(e,n))<0);)o++,n+=r;return o},e}())},5:function(e,t,o){"use strict";o.d(t,"a",(function(){return i}));var n=o(57),r=o(0),i=new(function(){function e(){}return e.prototype.importWebpackModuleWithRetry=function(e){return new Promise((function(t,o){e().then((function(e){return t(e)})).catch((function(r){setTimeout((function(){e().then((function(e){return t(e)})).catch((function(r){setTimeout((function(){e().then((function(e){return t(e)})).catch((function(e){console.log(e),n.a.showNotification('<div class="code-loading-error-notification">Error loading code: <a href="https://www.refreshyourcache.com/en/home/" target="_blank">clear the browser cache</a>, contact our <a target="_blank" href="mailto:lb-feedback@manning.com">support</a>, or <a href=\'\' onclick=\'location.reload(true)\'>reload livebook</a>.</div>'),$(document).trigger("codeLoadingError",["loadingError",null!=e&&(e.request||e.message)]),o()}))}),200)}))}),100)}))}))},e.prototype.loadSlickSliderCode=function(){return this.slickSliderCodePromise||(this.slickSliderCodePromise=Promise.all([this.loadJsCode("vendor/slick/slick.min.js"),this.loadCssStylesheet("vendor/slick/slick.min.css")])),this.slickSliderCodePromise},e.prototype.loadHopscotchCode=function(){return this.hopscotchCodePromise||(this.hopscotchCodePromise=Promise.all([this.loadJsCode("vendor/hopscotch/dist/js/hopscotch.min.js"),this.loadCssStylesheet("vendor/hopscotch/dist/css/hopscotch.min.css")])),this.hopscotchCodePromise},e.prototype.loadHighlightCode=function(){return this.highlightCodePromise||(this.highlightCodePromise=Promise.all([this.loadJsCode("vendor/highlight.js/highlight.pack.js"),this.loadCssStylesheet("vendor/highlight.js/default.css?with-dark-mode")])),this.highlightCodePromise},e.prototype.loadCodeMirrorCode=function(){return this.codeMirrorCodePromise||(this.codeMirrorCodePromise=Promise.all([o.e(47).then(o.t.bind(null,346,7)),this.loadCssStylesheet("vendor/codemirror/lib/codemirror.css")])),this.codeMirrorCodePromise},e.prototype.loadClipboardCode=function(){return this.clipboardCodePromise||(this.clipboardCodePromise=this.loadJsCode("vendor/clipboard/dist/clipboard.min.js")),this.clipboardCodePromise},e.prototype.loadVttCode=function(){return this.vttCodePromise||(this.vttCodePromise=this.loadJsCode("vendor/vtt/vtt.min.js")),this.vttCodePromise},e.prototype.loadJsCode=function(e){return new Promise((function(t,o){$.getScript(r.a.getLivebookCdn()+e).then((function(){return t()})).fail((function(){return o()}))}))},e.prototype.loadCssStylesheet=function(e){return new Promise((function(t){var o=$("<link>");$("head").append(o),o.attr({rel:"stylesheet",type:"text/css",href:r.a.getLivebookCdn()+e}),t()}))},e}())},56:function(e,t,o){"use strict";var n=o(6),r=o(3),i=o(0),s=o(123),a=$(window),c=function(){function e(){this.handleMouseLeave=this.handleMouseLeave.bind(this)}return e.prototype.initialize=function(e,t){this.book=e,$("#link-preview-popup").css("display","").on("mouseleave",this.handleMouseLeave)},e.prototype.handleMouseLeave=function(){var e=this;clearTimeout(this.linkPreviewMouseLeaveTimer),this.linkPreviewMouseLeaveTimer=r.a.setTimeout((function(){e.hidePreview(!0)}),200)},e.prototype.clean=function(){this.book=null,this.hidePreview(!1,!0)},e.prototype.showBrowsablePreview=function(e,t){if(e&&null!=t&&0!=t.length){var o=$("#link-preview-popup");try{o.removeClass("book-element-preview is-cover-left is-cover-right").addClass("browsable-preview");var n=o.find(".browsable-preview-container"),r=t.find(".code-area > .hljs:not(.hljs-line-numbers)");if(r.length>0){var i=$("<h5></h5>");i.html(t.find("h5").html());var s=$("<pre></pre>");s.text(r.text()),n.html(""),n.append(i),n.append(s)}else n.html(t.html());o.removeClass("closed").addClass("open"),o.css({opacity:0}),o.find("img").css({cursor:"initial"}),this.positionPreviewPopup($(e))}catch(e){}}},e.prototype.showWithinChapterPreview=function(e,t){if(e&&null!=t&&0!=t.length){for(var o=[],n=parseInt(t.attr("refid")),r=$("#book-markup-container").find("h1, h2, h3, h4"),s=null,a=0;a<r.length;a++){var c=r.eq(a).closest(".browsable-container, .readable-text");if(c.length>0){if(parseInt(c.attr("refid"))>n)break;s=c}}var l=null!=s?s.text():"";if(l!=t.text())o.push(t.html());else try{var u=document.getElementById(""+(n+1));u&&o.push($(u).html())}catch(e){}this.showBookElementPreview(e,{coverUrl:i.a.getBookCoverUrl(null!=this.book?this.book.shortName:""),title:l,paragraphs:o})}},e.prototype.showBookElementPreview=function(e,t){if(t&&this.referentLink!=e){var o=$(e),r=$("#link-preview-popup");r.addClass("book-element-preview").removeClass("browsable-preview"),r.css({"max-width":.9*$("#book-markup-container").width()});var a=r.find(".chapter-preview-paragraphs-container"),c=r.find(".book-cover"),l=r.find(".chapter-preview-title");r.removeClass("closed").addClass("open"),r.css({opacity:0}),c.attr("src",i.a.getLivebookCdn()+"assets/images/cover.png"),c.attr("data-src",t.coverUrl),l.text(t.title),a.html(t.paragraphs.join("<br>")),r.find(".browsable-preview-container").html(""),n.a.replaceBookCoversOnImageLoad(r,[t.coverUrl]),this.referentLink=e;try{l&&l.length&&s(l.get(0),{clamp:2}),a&&a.length&&s(a.get(0),{clamp:4})}catch(e){}this.positionPreviewPopup(o)}},e.prototype.hidePreview=function(e,t){var o=$("#link-preview-popup");e&&o.is(":hover")||(o.is(".open")&&!t?o.velocity({translateY:(o.is(".is-arrow-up")?"":"-")+"25%",opacity:0},{duration:100,complete:function(){o.removeClass("open").addClass("closed")}}):o.removeClass("open").addClass("closed"),this.referentLink=null)},e.prototype.positionPreviewPopup=function(e){if(null!=e&&0!=e.length){var t=$("#link-preview-popup"),o=$("#book-markup-container"),n=t.width(),r=t.height(),i=e.width(),s=e.height(),c=e.offset(),l=e.get(0).getBoundingClientRect(),u=c.left+.5*i,d=o.offset(),p=o.width(),h=l.top+r<a.height()-100;if(t.toggleClass("is-arrow-up",h),t.toggleClass("is-arrow-down",!h),t.is(".browsable-preview"))t.removeClass("is-cover-left is-cover-right");else{var f=u>=a.width()/2;t.toggleClass("is-cover-left",f),t.toggleClass("is-cover-right",!f)}var g=Math.max(u-.5*n,d.left+50),m=d.left+.9*p;g+n>m&&(g=Math.max(m-n,50)),t.css({top:h?c.top+s+10:c.top-r-30,left:g}),t.find(".arrow-up, .arrow-down").css({left:Math.min(u-g,n-20)}),t.velocity({translateY:(h?"":"-")+"25%",opacity:0},0),t.velocity({translateY:"0",opacity:1},200)}},e}();t.a=new c},57:function(e,t,o){"use strict";var n=o(9),r=o(6),i=$(document),s=function(){function e(){var e=this;this.$notificationBox=$("#notification-box"),0==this.$notificationBox.length&&($(document.body).append('<div id="notification-box" class="alert-box success radius hover-box">\n                    <span class="notification-content"></span>\n                    <a href="javascript:void(0)" class="close">&times;</a>\n                </div>'),this.$notificationBox=$("#notification-box")),this.$notificationContent=this.$notificationBox.find(".notification-content"),this.$notificationBox.on("click","a",(function(){return e.hideNotificationBox()})),i.on("requestNotification",(function(t,o){return e.showTemporaryNotification(o)})),i.on("requestPermanentNotification",(function(t,o){return e.showNotification(o)})),i.on("requestLongNotification",(function(t,o,n){return e.showLongNotification(o,n)})),i.on("requestNotificationTextChange",(function(t,o){return e.setNotificationMessage(o)})),i.on("hideNotification",(function(t){return e.hideNotificationBox()})),i.on("modalClosed",(function(e,t){var o=$(t);o.is("#notifications-modal")&&o.find(".notifications-modal-message").html("")}))}return e.prototype.showNotificationModal=function(e,t,o,r){void 0===o&&(o=!0);var i=$("#notifications-modal");i.find(".notifications-modal-title").text(e),i.find(".notifications-modal-message").html(t),i.find(".modal-command-row").toggleClass("hidden",!o),r&&i.find(".modal-action-button").one("click",(function(){r&&r(i)})),n.a.showFoundationModal(i)},e.prototype.hideNotificationModal=function(){var e=$("#notifications-modal");e.find(".modal-action-button").off("click"),n.a.hideFoundationModal(e)},e.prototype.showNotification=function(e){this.setNotificationMessage(e),this.showNotificationBox()},e.prototype.hideNotification=function(){this.hideNotificationBox()},e.prototype.showTemporaryNotification=function(e){var t=this;this.showNotification(e),this.hideNotificationTimeout&&clearTimeout(this.hideNotificationTimeout),this.hideNotificationTimeout=setTimeout((function(){return t.hideNotificationBox()}),5e3)},e.prototype.showLongNotification=function(e,t){var o=this;this.showNotification(e),t&&this.$notificationBox.find(".close").addClass(t),this.hideNotificationTimeout&&clearTimeout(this.hideNotificationTimeout),this.hideNotificationTimeout=setTimeout((function(){return o.hideNotificationBox()}),15e3)},e.prototype.setNotificationMessage=function(e){this.$notificationContent.html(e)},e.prototype.showNotificationBox=function(){this.$notificationBox.css({display:"block",bottom:1.2*r.a.getFooterHeight()+"px"})},e.prototype.hideNotificationBox=function(){this.$notificationBox.css({display:"none"}),this.$notificationBox.find(".close").attr("class","close"),this.hideNotificationTimeout=null},e}();t.a=new s},58:function(e,t,o){"use strict";var n=o(34),r=o(95),i=o(66),s=o(0),a=o(15),c=o(17),l=function(){function e(){this.numberedBookItemIndexRegExp=/(\d+\.?)+/,this.appendixIndexRegExp=/[A-Z]\.(\d+\.?)*/}return e.prototype.pretifyShortName=function(e){return e?e.replace("-"," "):e},e.prototype.convertToBookContent=function(e,t,o,n,r){var i=this.convertToBook(e);return{book:i,bookElement:this.getCurrentBookElement(i,e,t,o,n,r),previousBookElement:this.getPreviousBookElement(e,t),nextBookElement:this.getNextBookElement(e,t)}},e.prototype.convertToBook=function(e){if(!e)return null;var t=new n.a(e.id,e.manningId,e.title,e.shortName,e.description,e.lastUpdateDate,e.exercisesComingSoon,e.programmingLanguage,!0,e.userOwnsAudio,"","",e.meap,e.open,e.latestMeapVersion||0,e.highResolutionCover);return t.authors=e.authors,t.cleanTitle=a.a.cleanBookTitle(t.title),t.slug=e.slug,t.openChapters=e.openChapters||[],t.hasAudio=!!e.hasAudio,t.hasTextAddendums=!!e.hasTextAddendums,t.hasKnowledgeGraph=!!e.hasKnowledgeGraph,t.isKnowledgeGraphAccessible=!!e.isKnowledgeGraphAccessible,t.hasExercises=!!e.hasExercises,t.isReview=!!e.isReview,t.userCanViewReviews=!!e.userCanViewReviews,t.userIsReviewer=!!e.userIsReviewer,t.userOwnsPBook=!!e.userOwnsPBook,t.categories,e.categories,null!=e.offlineFileSizes&&(t.offlineFileSizes=e.offlineFileSizes),t},e.prototype.extractBookElementIndex=function(e){var t=new RegExp(this.appendixIndexRegExp).exec(e),o=new RegExp(this.numberedBookItemIndexRegExp).exec(e);return t&&!o?t[0]:o?o[0]:t?t[0]:""},e.prototype.extractSegmentedBookElementIndex=function(e){var t=this.extractBookElementIndex(e);return t?t.split(".").filter((function(e){return e.trim()})):[]},e.prototype.compareBookItemIndexes=function(e,t){for(var o=this.extractSegmentedBookElementIndex(e),n=this.extractSegmentedBookElementIndex(t),r=Math.max(o.length,n.length),i=0;i<r;i++){var s=o[i],a=n[i];if(!s)return-1;if(!a)return 1;var c=parseInt(s),l=parseInt(a);if(Number.isNaN(c)&&!Number.isNaN(l))return 1;if(!Number.isNaN(c)&&Number.isNaN(l))return-1;if(Number.isNaN(c)&&Number.isNaN(l)){if(s===a)continue;return s<a?-1:1}if(c!==l)return c<l?-1:1}return 0},e.prototype.cleanBookElementType=function(e){if(!e)return e;var t=this.extractBookElementIndex(e);return e.trim().replace(/^(Chapter|Part|Section|Appendix)/,"").replace(t,"").trim()},e.prototype.getCurrentBookElement=function(e,t,o,n,i,s){if(t&&t.bookElements&&0!==t.bookElements.length){var a=t.bookElements.find((function(e){return e.shortName===o}));return a?((a=new r.a(e,a.id,a.title,a.shortName,a.userOwnsBookElement,a.ordinal,a.wordCount||0,a.freeWordCount||0,n,i,!0,a.meapVersion,a.location,a.isBookOverview)).content=s,a.reviewVersion=a.reviewVersion,a):null}},e.prototype.getPreviousBookElement=function(e,t){if(e&&e.bookElements&&0!==e.bookElements.length){var o=this.getCurrentBookElementIndex(e.bookElements,t);if(-1===o)return null;var n=e.bookElements[o-1];return n?new i.a(n.shortName,n.title,n.link||s.a.getBookElementUrl(e.slug,n.shortName,e.meapVersion,e.reviewVersion),n.introItems):null}},e.prototype.getNextBookElement=function(e,t){if(e&&e.bookElements&&0!==e.bookElements.length){var o=this.getCurrentBookElementIndex(e.bookElements,t);if(-1===o)return null;var n=e.bookElements[o+1];return n?new i.a(n.shortName,n.title,s.a.getBookElementUrl(e.slug,n.shortName,e.meapVersion,e.reviewVersion),n.introItems):null}},e.prototype.getCurrentBookElementIndex=function(e,t){if(!e||0===e.length)return-1;for(var o=0;o<e.length;o++)if(e[o].shortName===t)return o;return-1},e.prototype.isFreePreviewAtBeginningAndNotStarted=function(e){return null!=e&&0==e.previewDuration&&e.remainingPreviewDuration>0},e.prototype.isFreePreviewAvailable=function(e){return null!=e&&e.previewDuration>0&&e.remainingPreviewDuration>5},e.prototype.isFreePreviewAvailableAndContinuing=function(e){return null!=e&&e.previewDuration>0&&e.remainingPreviewDuration>0&&e.shortName==c.a.lastFreePreviewStartedBookShortName},e.prototype.canFreePreviewBePaused=function(e,t){return null!=e&&!e.isOpen&&(!!t&&e.remainingPreviewDuration>0)},e.prototype.hasFreePreviewExpired=function(e){return null!=e&&(!e.remainingPreviewDuration||e.remainingPreviewDuration<5)},e}();t.a=new l},6:function(e,t,o){"use strict";var n=o(58),r=o(15),i=o(140),s=o(9),a=$(window),c=$(document),l=function(){function e(){}return e.prototype.isDocumentVisible=function(){return document.visibilityState&&"visible"===document.visibilityState},e.prototype.getCurrentMainContentTranslateX=function(){var e=$("#book-main-content-container");return 0==e.length?0:this.getComputedTranslateX(e.get(0))},e.prototype.translateMainContent=function(e){$("#book-main-content-container").velocity({translateX:e||0},{duration:0})},e.prototype.loadPlaceholderImages=function(){var e=$("img[image-src]");e.slice(0,5).each((function(e,t){var o=$(t);o.attr("src",o.attr("image-src"))})),e.slice(5,e.length).each((function(e,t){i(t,(function(){var e=$(t);e.attr("src",e.attr("image-src"))}))})),$("img[onload-image-src]").each((function(e,t){var o=$(t).attr("onload-image-src"),n=new Image;n.onload=function(){$(t).attr("src",o)},n.src=o}))},e.prototype.getSectionHeading=function(e){void 0===e&&(e="");var t=e.substring("section-".length);return t=t.replace(/\-/g,"."),this.getSectionTitle(t)},e.prototype.getSectionTitle=function(e){for(var t=document.querySelectorAll("#book-markup-container h1, #book-markup-container h2, #book-markup-container h3, #book-markup-container h4, #book-markup-container h5"),o=[],r=0;r<t.length;r++){if(0!==r)if(!((a=(s=t[r]).textContent.trim()).startsWith("Table")||a.startsWith("Figure")||a.startsWith("Listing"))){var i=$(s);i.is(".intro-header")||i.closest(".callout-container").length||o.push(s)}}for(r=0;r<o.length;r++){var s,a=(s=o[r]).textContent.trim(),c=n.a.extractBookElementIndex(a);if(c===e)return s;if(c===e+".")return s}return this.fallbackForGetSectionTitle(o,e)},e.prototype.fallbackForGetSectionTitle=function(e,t){if(!e||0===e.length)return null;var o=n.a.extractSegmentedBookElementIndex(t);!!t.match(/^[A-Z]/i)||o.shift();var r=e[0].nodeName,i=[];if(e.forEach((function(e){e.nodeName===r?i.push({heading:e,children:[]}):i[i.length-1]&&i[i.length-1].children.push(e)})),0===o.length)return null;if(1===o.length){var s=+o[0]-1;return i[s]?i[s].heading:null}var a=+o[0]-1;if(i[a]){var c=+o[1]-1;return i[a].children[c]?i[a].children[c]:i[a].heading}return null},e.prototype.replaceBookCoversOnImageLoad=function(e,t,o){void 0===o&&(o=!1);var n=function(t){var o=t.target;s.a.cacheImageIfNeeded(o),e.find('.book-cover[data-src="'+o.getAttribute("data-src")+'"]').attr("src",o.src)},r=$(t.map((function(e){var t=new Image;return t.src=e,t.setAttribute("data-src",e),t.complete&&n({target:t}),t})));r.on("load",n),o&&r.on("error",(function(t){var o=t.target;s.a.loadFromCacheIfPossible(o,(function(){$(e.find('.book-cover[data-src="'+o.src+'"]')).closest(".book-item-container").remove()}))}))},e.prototype.closeMenuIfTakesTooMuchSpace=function(e){if(e&&0!==e.length)try{var t=$("#book-main-content-container");if(0===t.length)return;var o=e.offset(),n=t.offset(),r={start:o.left,end:o.left+e.width()},i={start:n.left,end:n.left+t.width()};if(r.start<=i.start){if(r.end<=i.start)return;if(Math.abs(r.end-i.start)/t.width()<=.3)return}else{if(r.start>=i.end)return;if(Math.abs(i.end-r.start)/t.width()<=.3)return}c.trigger("slideMenuCloseRequested")}catch(e){console.log(e)}},e.prototype.hideScrollOnBody=function(){$(document.body).css({overflow:"hidden"})},e.prototype.showScrollOnBody=function(){$(document.body).css({overflow:"auto"})},e.prototype.getTopNavBarHeight=function(e){void 0===e&&(e=!1);var t=$("#top-bar-container"),o=t.length>0?this.getComputedTranslateY(t.get(0)):0;o<0&&(o=0);var n=t.height()-o;return e&&(n-=$("#header-notification-container").height()),Math.max(n,0)},e.prototype.getFooterHeight=function(){return $("#footer").height()},e.prototype.getNavbarHeightInPx=function(){return this.getTopNavBarHeight()-1+"px"},e.prototype.isHeadingVisible=function(e,t){return null!=e&&0!=e.length&&e.offset().top-10<t},e.prototype.isElementVisible=function(e){if(!e)return!1;var t=e.getBoundingClientRect(),o=$(window);return t.top>=this.getTopNavBarHeight()&&t.left>=0&&t.bottom<=o.height()-100&&t.right<=o.width()},e.prototype.isElementVisibleEvenALittle=function(e,t){if(void 0===t&&(t=!1),null==e)return!1;var o=e.getBoundingClientRect(),n=o.height,r=$(window),i=o.top+.82*n>=this.getTopNavBarHeight()&&o.bottom<=r.height()+.7*n,s=o.left>=0&&o.right<=r.width();return t?i:i&&s},e.prototype.canBothElementsFitIntoScreen=function(e,t){var o=$(e),n=$(t),r=o.offset().top,i=n.offset().top,s=r+o.height(),c=i+n.height(),l=Math.min(r,i);return Math.max(s,c)-l<a.height()-$("#footer").height()-this.getTopNavBarHeight()},e.prototype.areElementsVisible=function(e){for(var t=0;t<e.length;t++)if(!this.isElementVisible(e[t]))return!1;return!0},e.prototype.getElementLineHeight=function(e){return parseFloat(e.css("line-height"))},e.prototype.getClosestToOffset=function(e,t){var o,n,r=null,i=t.left,s=t.top;return e.each((function(){var e=$(this),t=e.offset(),a={left:t.left,top:t.top,right:t.left+e.width(),bottom:t.top+e.height()};if(i>=a.left&&i<=a.right&&s>=a.top&&s<=a.bottom)return r=$(this),!1;for(var c=0,l=[{x:a.left,y:a.top},{x:a.right,y:a.top},{x:a.left,y:a.bottom},{x:a.right,y:a.bottom}];c<l.length;c++){var u=l[c],d=u.x-i,p=u.y-s;o=Math.sqrt(d*d+p*p),(void 0===n||o<n)&&(n=o,r=$(this))}})),r},e.prototype.getComputedTranslateY=function(e){if(null==e)return 0;var t=getComputedStyle(e),o=t.transform||t.webkitTransform||t.mozTransform,n=o.match(/^matrix3d\((.+)\)$/);if(n)return parseFloat(n[1].split(", ")[13]);if(n=o.match(/^matrix\((.+)\)$/))return parseFloat(n[1].split(", ")[5]);var r=$(e).attr("style");if(null==r)return 0;var i=r.indexOf("translateY(");return-1==i?0:parseFloat(r.substring(i+"translateY(".length))},e.prototype.getComputedTranslateX=function(e){if(!e)return 0;var t=$(e).attr("style");if(!t)return 0;var o=t.indexOf("translateX(");if(-1==o)return 0;var n=parseFloat(t.substring(o+"translateX(".length));return isNaN(n)?0:n},e.prototype.getClosestScrambledParagraph=function(e){if(null!=e){var t=$(e);if(t.is(".scrambled"))return e;if(!t.is(".readable-text")&&!t.is(".browsable-container")&&0==(t=t.closest(".readable-text, .browsable-container")).length)return null;var o=parseInt(t.attr("refid"));if(Number.isNaN(o))return null;for(var n=o+1;n<o+20;n++){var r=document.querySelector(".readable-text.scrambled[refid='"+n+"']");if(null!=r)return r}return null}},e.prototype.getVisibleParagraphs=function(e){void 0===e&&(e=!1);for(var t=[],o=a.scrollTop()+this.getTopNavBarHeight(),n=this.getLastHeader(o),r=parseInt(n.attr("refid")),i=r;i>=Math.max(r-30,0)&&r>=0;i--){if(null!=(s=document.getElementById(""+i))&&(!e||s.classList.contains("readable-text"))){if(!this.isElementVisibleEvenALittle(s,!0))break;t.push(s)}}for(i=r+1;i<r+250;i++){var s;null==(s=document.getElementById(""+i))||e&&!s.classList.contains("readable-text")||this.isElementVisibleEvenALittle(s,!0)&&t.push(s)}return t},e.prototype.getLastHeader=function(e){var t=this,o=r.a.getHeadings(),n=o.filter((function(o,n){return t.isHeadingVisible($(n),e)})).last();return 0==n.length?o.first():n},e.prototype.hasScrambledParagraphs=function(){return null!=document.querySelector("#book-markup-container > .readable-text.scrambled")},e}();t.a=new l},63:function(e,t,o){"use strict";var n=function(){function e(e,t,o,n,r,i,s,a,c,l,u,d,p,h){void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===h&&(h=!1),this.id=e,this.bookElementShortName=t,this.bookElementOrdinal=o||-1,this.contentID=n,this.contentHash=r,this.annotatedText=i,this.noteText=s,this.section=a,this.timestamp=c,this.meapVersion=l||0,this.reviewVersion=u||0,this.hasNotBeenStoredOnServer=d,this.shouldBeDeleted=p,this.hasNotBeenEditedToServer=h}return e.fromJSON=function(t){var o=new e(parseInt(t.id||t.noteID)||0,t.bookElementShortName,t.bookElementOrdinal,t.contentID||t.contentItemID,t.contentHash,t.annotatedText,t.noteText,t.section||t.contentLocation,t.timeCreated||t.timestamp,t.meapVersion,t.reviewVersion,!!t.hasNotBeenStoredOnServer,!!t.shouldBeDeleted,!!t.hasNotBeenEditedToServer);return o.user=t.user||"",o.userId=t.userId,o},e}();t.a=n},64:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=function(){function e(e,t,o,n,r,i,s,a,c,l,u,d){void 0===l&&(l=!1),void 0===u&&(u=!1),void 0===d&&(d=!1),this.id=e,this.bookShortName=t,this.bookElementShortName=o,this.bookElementOrdinal=n,this.meapVersion=r,this.color=i,this.highlightedParagraphs=s,this.timestamp=a,this.offset=c,this.hasNotBeenStoredOnServer=l,this.shouldBeDeleted=u,this.hasNotBeenEditedToServer=d}return e.fromJSON=function(t){return new e(t.id,t.bookShortName,t.bookElementShortName,t.bookElementOrdinal,t.meapVersion,t.color,t.highlightedParagraphs.map((function(e){return r.fromJSON(e)})),t.timeStamp||t.timeCreated,t.offset||0,t.hasNotBeenStoredOnServer||!1,t.shouldBeDeleted||!1,t.hasNotBeenEditedToServer||!1)},e}();t.b=n;var r=function(){function e(e,t,o){this.ordinal=e,this.hash=t,this.selectedText=o}return e.fromJSON=function(t){return new e(t.ordinal,t.hash,t.selectedText)},e}()},65:function(e,t,o){"use strict";var n=function(){function e(e,t,o,n,r,i,s,a,c,l,u){void 0===l&&(l=!1),void 0===u&&(u=!1),this.id=e,this.contentID=n,this.contentHash=r,this.bookmarkedText=i,this.bookElementShortName=t,this.bookElementOrdinal=o,this.section=s,this.timestamp=a,this.meapVersion=c||0,this.hasNotBeenStoredOnServer=l,this.shouldBeDeleted=u}return e.fromJSON=function(t){return new e(parseInt(t.id||t.bookmarkID)||0,t.bookElementShortName,t.bookElementOrdinal,t.contentID||t.contentItemID,t.contentHash,t.bookmarkedText,t.section||t.contentLocation,t.timeCreated||t.timestamp,t.meapVersion,!!t.hasNotBeenStoredOnServer,!!t.shouldBeDeleted)},e}();t.a=n},66:function(e,t,o){"use strict";var n=o(128),r=function(e,t,o,r){void 0===r&&(r=[]),this.shortName=e,this.title=t,this.link=n.a.adjustBookLink(o||""),this.introItems=r};t.a=r},67:function(e,t,o){"use strict";o.d(t,"a",(function(){return l}));var n=o(3),r=o(1),i=o(17),s=o(29),a=o(5),c=o(7),l=new(function(){function e(){}return e.prototype.initialize=function(){this.loadCodeOnInteraction=this.loadCodeOnInteraction.bind(this)},e.prototype.clean=function(){Promise.all([this.getSource()]).then((function(e){return e[0].DiscussionsMenu.clean()}))},e.prototype.load=function(e){void 0===e&&(e=""),this.getSource().then((function(t){return t.DiscussionsMenu.initialize(i.a.book,i.a.bookElement,e)}))},e.prototype.loadCodeOnInteraction=function(e){var t=this,o="click"==e.type||r.b.isTouchEventOnTouchDevice(e.type);n.a.offPassiveEvent(document.querySelectorAll(".discussions-menu-button"),[e.type],this.loadCodeOnInteraction),this.getSource().then((function(r){var s=r.DiscussionsMenu;o&&(s.initialize(i.a.book,i.a.bookElement),s.open()),n.a.offPassiveEvent(document.querySelectorAll(".discussions-menu-button"),o?["mouseenter","touchstart","click"]:[e.type],t.loadCodeOnInteraction)})),e&&e.stopImmediatePropagation()},e.prototype.requestOpen=function(){Promise.all([this.getSource()]).then((function(e){return e[0].DiscussionsMenu.open()}))},e.prototype.requestShowCommentWhenReady=function(e,t,o,n){void 0===t&&(t=0);var r="",i=!1,a=!1,l=!1;0==e.indexOf("not-spam-")?(a=!0,r=e.substring("not-spam-".length)):0==e.indexOf("spam-")?(i=!0,r=e.substring("spam-".length)):0==e.indexOf("edit-suggestion-")?(l=!0,r=e.substring("edit-suggestion-".length)):r=e,Promise.all([this.getSource()]).then((function(e){var u=e[0].DiscussionsMenu;function d(e){void 0===e&&(e=o),u.showCommentWhenReady(r,t,e,n)}i||l||a?c.a.isLoggedIn().then((function(e){e.loggedIn?i?d((function(){u.markAsSpam(r),o&&o()})):a?d((function(){$(document).trigger("requestNotification","Removing spam flags"),u.clearSpamFlags(r).then((function(){$(document).trigger("requestNotification","Spam flags removed!")})).catch((function(e){return $(document).trigger("requestNotification","Error removing spam flags")}))})):l&&u.markAsEditSuggestion(r).then((function(){return d()})).catch((function(){return d()})):s.a.requestLogin("sign in to discuss","discussion")})):d()}))},e.prototype.requestOpenParagraphSideMenu=function(e){Promise.all([this.getSource()]).then((function(t){t[0].DiscussionsMenu.openParagraphSideMenu(e)}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=a.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(3),o.e(40),o.e(0),o.e(1),o.e(15)]).then(o.bind(null,347))},e}())},7:function(e,t,o){"use strict";var n=o(1),r=o(0),i=o(22),s=o(4),a=!1,c=!1,l=function(){function e(){}return e.prototype.isLoggedIn=function(e){var t=this;return void 0===e&&(e=!1),e&&(this.isLoggedInPromise=null,i.a.setAuthInfo(null)),null!=i.a.getAuthInfo()?Promise.resolve(i.a.getAuthInfo()):this.isLoggedInPromise?this.isLoggedInPromise:this.isLoggedInPromise=new Promise((function(e,o){r.a.getFromOurBackend(r.a.getAbsoluteUrl("auth/userIsLoggedIn"),(function(t){a=!!t.loggedIn,t.userDetails&&t.userDetails.firstLoginDate&&(t.userDetails.firstLoginDate=s.a.getDateFromString(t.userDetails.firstLoginDate)),t.userDetails&&(c=!!t.userDetails.isAdmin),i.a.setAuthInfo(t),e(t)}),(function(){i.a.setAuthInfo(null),a=!1,c=!1,e({loggedIn:!1,status:"not",userDetails:t.getEmptyUserDetails()})}))}))},e.prototype.createAuthorizedProductsMap=function(e){var t={};if(!e||!e.length)return t;for(var o=0,n=e;o<n.length;o++){t[n[o]]=!0}return t},e.prototype.getEmptyUserDetails=function(){return{id:-1,firstName:"",lastName:"",email:"",avatarUrl:"",tokenInfo:null,name:"",votes:[],spamCommentIds:[],authorizedProductIds:{},isNewCustomer:!0}},e.prototype.attemptLogin=function(e,t){var o=this;return this.lastEmail=e,null!=this.loginAttemptPromise?this.loginAttemptPromise:this.loginAttemptPromise=new Promise((function(n,i){r.a.attemptLogin(r.a.getAbsoluteUrl("api/auth/login"),(function(e){n(e),o.loginAttemptPromise=null}),(function(e){i(e),o.loginAttemptPromise=null}),{username:e,password:t})}))},e.prototype.logout=function(){var e=this;return new Promise((function(t,o){r.a.getFromOurBackend(r.a.getAbsoluteUrl("api/auth/logout"),(function(){e.deleteAuthCookies(),t()}),(function(){e.deleteAuthCookies(),o()}),{},!1)}))},e.prototype.isCurrentlyLoggedIn=function(){return a},e.prototype.isCurrentUserAdmin=function(){return c},e.prototype.isExistingUser=function(){try{var e=i.a.getAuthInfo();return!(!e||!e.userDetails)&&!e.userDetails.isNewCustomer}catch(e){}return!1},e.prototype.getUserAccountStatus=function(e){return new Promise((function(t,o){r.a.getFromOurBackend(r.a.getAbsoluteUrl("api/registration/userAccountStatus"),(function(e){console.log("userAccountStatus: ",e),t(e.userAccountStatus)}),(function(e){t("UNKNOWN"),console.log("Error retrieving user account status",e)}),{email:e})}))},e.prototype.registerUser=function(e,t,o,n,i){var s=this;return this.lastEmail=o,null!=this.registerUserPromise?this.registerUserPromise:this.registerUserPromise=new Promise((function(a,c){r.a.postToOurBackend(r.a.getAbsoluteUrl("api/registration/createNewUserAccount"),(function(){$(document).trigger("registrationSubscribeInfo",i),s.registerUserPromise=null,a()}),(function(){s.registerUserPromise=null,c()}),{firstName:e,lastName:t,email:o,password:n,subscribe:i})}))},e.prototype.deleteAuthCookies=function(){r.a.clearCookies()},e}(),u=!1,d=!1,p=function(){function e(){this.webService=new l}return e.prototype.isLoggedIn=function(e){var t=this;return void 0===e&&(e=!1),n.b.isConnected()?new Promise((function(o,n){return t.webService.isLoggedIn(e).then((function(e){t.storeAuthInfo(e),o(e)}))})):this.loadAuthInfo()},e.prototype.attemptLogin=function(e,t){return n.b.isConnected()?this.webService.attemptLogin(e,t):this.loadAuthInfo()},e.prototype.logout=function(){var e=this;return new Promise((function(t,o){e.webService.logout(),e.getFsUtils().writeToFile(e.getFsUtils().getAuthInfoLocation(),"").then(t)}))},e.prototype.isCurrentlyLoggedIn=function(){return u},e.prototype.isCurrentUserAdmin=function(){return d},e.prototype.isExistingUser=function(){try{var e=i.a.getAuthInfo();return!(!e||!e.userDetails)&&!e.userDetails.isNewCustomer}catch(e){}return!1},e.prototype.getUserAccountStatus=function(e){var t=this;return n.b.isConnected()?this.webService.getUserAccountStatus(e):new Promise((function(e,o){return t.loadAuthInfo().then((function(t){return t?e(t.status):o("No authentication information found")}))}))},e.prototype.registerUser=function(e,t,o,r,i){if(!n.b.isConnected())throw Error("Device needs connection to internet to register a new user");return this.webService.registerUser(e,t,o,r,i)},e.prototype.loadAuthInfo=function(){var e=this;return new Promise((function(t,o){return e.getFsUtils().readFile(e.getFsUtils().getAuthInfoLocation()).then((function(e){var o=JSON.parse(e);d=o&&o.userDetails&&!!o.userDetails.isAdmin,u=o&&o.loggedIn,t(o)}))}))},e.prototype.storeAuthInfo=function(e){var t=this;return new Promise((function(o,n){return t.getFsUtils().writeToFile(t.getFsUtils().getAuthInfoLocation(),JSON.stringify(e)).then(o)}))},e.prototype.getFsUtils=function(){return window.fileSystemUtils},e}(),h=o(14);o.d(t,"a",(function(){return f}));var f=new(function(){function e(){var e=this;this.currentlyLoggedIn=!1,this.currentUserAdmin=!1,this.existingUser=!1,this.authServicePromise=new Promise((function(e,t){n.b.loadDeviceInfo().then((function(t){e(function(e){switch(e){case n.a.Cordova:case n.a.Electron:return new p;case n.a.Browser:default:return new l}}(t.platform))})).catch((function(e){return t(e)}))})),this.authServicePromise.then((function(t){e.currentlyLoggedIn=t.isCurrentlyLoggedIn(),e.existingUser=t.isExistingUser(),e.currentUserAdmin=t.isCurrentUserAdmin()}))}return e.prototype.getLatestUserFirstName=function(){return h.a.getItem("latestUserFirstName")||""},e.prototype.isLoggedIn=function(e){var t=this;return void 0===e&&(e=!1),new Promise((function(o,n){return t.authServicePromise.then((function(n){return n.isLoggedIn(e).then((function(e){t.currentlyLoggedIn=e.loggedIn,null!=e&&null!=e.userDetails&&e.userDetails.firstName&&h.a.setItem("latestUserFirstName",e.userDetails.firstName),o(e)}))}))}))},e.prototype.isCurrentlyLoggedIn=function(){return this.currentlyLoggedIn},e.prototype.isCurrentUserAdmin=function(){return this.currentUserAdmin},e.prototype.isExistingUser=function(){return this.existingUser},e.prototype.attemptLogin=function(e,t){var o=this;return this.lastEmail=e,new Promise((function(n,r){return o.authServicePromise.then((function(o){return o.attemptLogin(e,t).then((function(e){return n(e)})).catch((function(e){return r(e)}))}))}))},e.prototype.logout=function(){var e=this;return new Promise((function(t,o){return e.authServicePromise.then((function(e){return e.logout().then((function(){return t()})).catch((function(){return o()}))})).catch((function(){return o()}))}))},e.prototype.registerUser=function(e,t,o,n,r){var i=this;return new Promise((function(s,a){return i.authServicePromise.then((function(i){return i.registerUser(e,t,o,n,r).then((function(){return s()}))}))}))},e.prototype.getUserAccountStatus=function(e){var t=this;return new Promise((function(o,n){return t.authServicePromise.then((function(t){return t.getUserAccountStatus(e).then((function(e){return o(e)}))}))}))},e}())},73:function(e,t,o){"use strict";var n=o(0),r=o(4),i=function(){function e(){}return e.prototype.fetchAllBooksProgress=function(){return new Promise((function(e,t){n.a.getFromOurBackend(n.a.getAbsoluteUrl("api/progress/getAllBooksProgress"),(function(t){return e(t)}),(function(e){return t(e)}))}))},e.prototype.fetchAudioProgress=function(e){return new Promise((function(t,o){n.a.getFromOurBackend(n.a.getAbsoluteUrl("api/progress/getBookElementProgress"),(function(e){e&&"null"!=e&&e.text&&"null"!=e.text||t({});var o=JSON.parse(e.text);if(!r.a.hasNumberProperties(o))if(o.text){if(o=JSON.parse(o.text),r.a.hasNumberProperties(o))return void t(o);t({})}else t({});t(o)}),(function(e){return o(e)}),{book:e.book.shortName,bookElement:e.shortName,meapVersion:e.meapVersion})}))},e.prototype.storeProgress=function(e,t,o,r){return new Promise((function(i,s){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/progress/save"),(function(){return i()}),(function(){return s()}),{book:e.book.shortName,bookElement:e.shortName,contentItemIDs:JSON.stringify(t),contentItemID:o,meapVersion:e.meapVersion},!1,!r)}))},e.prototype.syncProgressWithServer=function(e){return void 0===e&&(e=void 0),e?new Promise((function(t,o){return n.a.postToOurBackend(n.a.getAbsoluteUrl("api/progress/syncProgress"),(function(){return t(!0)}),(function(e){return document.dispatchEvent(new CustomEvent("sync-error",{detail:{error:e}}))}),{items:e},!0,!0,!1,!0)})):Promise.resolve(!0)},e}(),s=o(1),a=function(){function e(){this.webService=new i}return e.prototype.loadSyncProgressFromFileSystem=function(){var e=this;return new Promise((function(t,o){e.getFsUtils().readFile(e.getFsUtils().getSyncProgressLocation()).then((function(e){return t(e?JSON.parse(e):[])})).catch((function(e){return o(e)}))}))},e.prototype.loadAllBooksProgressFromFileSystem=function(){var e=this;return new Promise((function(t,o){e.getFsUtils().readFile(e.getFsUtils().getBookProgressLocation()).then((function(e){return t(JSON.parse(e))})).catch((function(e){return o(e)}))}))},e.prototype.loadBookElementAudioProgressFromFileSystem=function(e,t){var o=this;return new Promise((function(n,i){return o.getFsUtils().readFile(o.getFsUtils().getBookElementAudioProgressLocation(e,t)).then((function(e){e&&"null"!=e||n({});var t=JSON.parse(e);r.a.hasNumberProperties(t)||n({}),n(t)})).catch((function(e){n({})}))}))},e.prototype.fetchAllBooksProgress=function(){var e=this;return s.b.isConnected()?new Promise((function(t,o){e.webService.fetchAllBooksProgress().then((function(o){e.getFsUtils().writeToFile(e.getFsUtils().getBookProgressLocation(),JSON.stringify(o)),t(o)})).catch((function(o){e.loadAllBooksProgressFromFileSystem().then((function(e){return t(e)}))}))})):this.loadAllBooksProgressFromFileSystem()},e.prototype.fetchAudioProgress=function(e){var t=this;return new Promise((function(o,n){var r=t.loadBookElementAudioProgressFromFileSystem(e.book.shortName,e.shortName),i=t.webService.fetchAudioProgress(e);Promise.all([r,i]).then((function(n){var r=Object.assign({},n[0],n[1]);t.storeProgress(e,r,t.getMaxPropertyNumber(r)),o(r)})).catch((function(r){return t.loadBookElementAudioProgressFromFileSystem(e.book.shortName,e.shortName).then((function(e){return o(e)})).catch((function(e){return n(e)}))}))}))},e.prototype.storeProgress=function(e,t,o){var n=this;return this.getUpdatedStoredProgress(this.loadAllBooksProgressFromFileSystem(),e.shortName,e.book.shortName,o).then((function(i){n.getFsUtils().writeToFile(n.getFsUtils().getBookProgressLocation(),JSON.stringify(i)),s.b.isConnected()?n.webService.storeProgress(e,t,o).catch((function(e){return console.log("Couldn't save book progress to central server")})):(r.a.isEmptyObject(t)||n.getFsUtils().writeToFile(n.getFsUtils().getBookElementAudioProgressLocation(e.book.shortName,e.shortName),JSON.stringify(t)),n.getUpdatedStoredProgress(n.loadSyncProgressFromFileSystem(),e.shortName,e.book.shortName,o).then((function(e){n.getFsUtils().writeToFile(n.getFsUtils().getSyncProgressLocation(),JSON.stringify(e))})))}))},e.prototype.syncProgressWithServer=function(){var e=this;return new Promise((function(t,o){return e.loadSyncProgressFromFileSystem().then((function(n){n.length?e.webService.syncProgressWithServer(n).then((function(o){e.getFsUtils().writeToFile(e.getFsUtils().getSyncProgressLocation(),""),t(o)})).catch((function(e){return o(!1)})):t(!0)}))}))},e.prototype.getUpdatedStoredProgress=function(e,t,o,n){return new Promise((function(r,i){return e.then((function(e){var i=e&&e.find((function(e){return e.bookShortName===o}));i?(i.bookElementShortName=t,i.contentItemID=n,i.timeStamp=Date.now()):e.push({bookShortName:o,bookElementShortName:t,contentItemID:n,timeStamp:Date.now()}),r(e)}))}))},e.prototype.getMaxPropertyNumber=function(e){var t=1;for(var o in e){var n=parseInt(o);!Number.isNaN(n)&&n>t&&(t=n)}return""+t},e.prototype.getFsUtils=function(){return window.fileSystemUtils},e}();o.d(t,"a",(function(){return c}));var c=new(function(){function e(){var e=this;this.progressServicePromise=new Promise((function(e,t){s.b.loadDeviceInfo().then((function(t){e(function(e){switch(e){case s.a.Browser:return new i;case s.a.Cordova:case s.a.Electron:return new a}}(t.platform))})).catch((function(e){return t(e)}))})),$(document).on("appActivatedAfterLongTime",(function(){e.allBooksProgressPromise=null}))}return e.prototype.fetchAllBooksProgress=function(){var e=this;return this.allBooksProgressPromise?this.allBooksProgressPromise:this.allBooksProgressPromise=new Promise((function(t,o){e.progressServicePromise.then((function(n){n.fetchAllBooksProgress().then((function(o){return t(e.transformBookProgress(o))})).catch((function(e){return o(e)}))}))}))},e.prototype.clear=function(){this.allBooksProgressPromise=null},e.prototype.getBookProgress=function(e){var t=this;return new Promise((function(o,n){t.fetchAllBooksProgress().then((function(t){o(t[e])})).catch((function(e){return n(e)}))}))},e.prototype.fetchAudioProgress=function(e){var t=this;return new Promise((function(o,n){t.progressServicePromise.then((function(t){t.fetchAudioProgress(e).then((function(e){return o(e)})).catch((function(e){return n(e)}))}))}))},e.prototype.storeProgress=function(e,t,o,n){var r=this;return $(document).trigger("progressStore",t),this.syncProgressWithServer(),new Promise((function(i,s){r.progressServicePromise.then((function(r){r.storeProgress(e,t,o,n).then((function(e){return i()})).catch((function(e){return s(e)}))}))}))},e.prototype.syncProgressWithServer=function(){var e=this;return new Promise((function(t,o){return e.progressServicePromise.then((function(e){return e.syncProgressWithServer().then((function(e){return t(e)})).catch((function(e){console.error("Failed to synchronize progress with server, error: ",e),o(!1)}))}))}))},e.prototype.transformBookProgress=function(e){for(var t={},o=0,n=e;o<n.length;o++){var r=n[o];t[r.bookShortName]=r}return t},e}())},74:function(e,t,o){"use strict";o.d(t,"a",(function(){return c}));var n=o(9),r=o(24),i=(o(334),o(25)),s=function(){function e(){this.onListItemClick=this.onListItemClick.bind(this),this.closeModal=this.closeModal.bind(this)}return e.prototype.initialize=function(){null==document.getElementById("offline-operations-modal")&&$(document.body).append(a),this.$offlineOperationsModal=$("#offline-operations-modal"),this.handleAction(),this.$offlineOperationsModal.find(".download-type-item").off("click touchstart",this.onListItemClick).on("click touchstart",this.onListItemClick),this.$offlineOperationsModal.find(".close-reveal-modal").on("touchstart",this.closeModal)},e.prototype.showDownloadBookModal=function(e){this.userLibraryBook=e,this.$offlineOperationsModal.find(".offline-operations-header-title").text("Download"),e.offlineFileSizes&&($(".download-type-item-with-audio .download-type-item-size-label").text(""+e.offlineFileSizes.audioMediumQuality),$(".download-type-item-without-audio .download-type-item-size-label").text(""+e.offlineFileSizes.contentSize)),this.$offlineOperationsModal.find(".offline-operation-book-button").text("download"),this.$offlineOperationsModal.addClass("download-book-modal").removeClass("delete-book-modal"),n.a.showFoundationModal(this.$offlineOperationsModal,!0)},e.prototype.showDeleteBookModal=function(e){this.userLibraryBook=e,this.$offlineOperationsModal.find(".offline-operations-header-title").text("Delete book"),this.$offlineOperationsModal.find(".offline-operation-book-button").text("delete"),this.$offlineOperationsModal.find(".offline-operations-book-title").text(e.cleanTitle||e.title),this.$offlineOperationsModal.addClass("delete-book-modal").removeClass("download-book-modal"),n.a.showFoundationModal(this.$offlineOperationsModal,!0)},e.prototype.handleAction=function(){var e=this;this.$offlineOperationsModal.find(".offline-operation-book-button").on("click touchstart",(function(t){e.$offlineOperationsModal.is(".download-book-modal")?r.a.requestBookDownload(e.userLibraryBook.shortName,e.getSelectedContentDownloadType(),e.userLibraryBook.cleanTitle||e.userLibraryBook.title):(r.a.deleteBook(e.userLibraryBook.shortName).then((function(){i.a.unmarkBookAsDownloaded(e.userLibraryBook.shortName)})),$(document).trigger("requestNotification",(e.userLibraryBook.cleanTitle||e.userLibraryBook.title)+" deleted from this device")),e.closeModal()}))},e.prototype.onListItemClick=function(e){$(".download-type-item.selected").removeClass("selected"),$(e.currentTarget).addClass("selected")},e.prototype.getSelectedContentDownloadType=function(){return this.$offlineOperationsModal.find(".download-type-item.selected.download-type-item-with-audio").length>0?"audioMediumQuality":"content"},e.prototype.closeModal=function(){var e=$("#offline-operations-modal");e.find(".close-reveal-modal").off("touchstart",this.closeModal),n.a.hideFoundationModal(e)},e}(),a='\n<div id="offline-operations-modal" class="reveal-modal" data-reveal data-options="close_on_background_click:false; close_on_esc:false;">\n    <div class="offline-operations-modal-header no-user-select">\n        <span class="offline-operations-header-title">Download</span>\n        <span class="close-reveal-modal">&times;</span>\n    </div>\n\n    <div class="offline-operations-modal-content-container">\n        <ul class="offline-operations-download-types">\n            <li class="download-type-item selected download-type-item-with-audio no-user-select">\n                <div>\n                    <span class="download-type-item-description-label text-label">with audio</span>\n                    <span class="download-type-item-size-label text-label"></span>\n                </div>\n                <div class="download-type-item-selector">\n                    <div class="download-type-item-selector-inner"></div>\n                </div>\n            </li>\n\n            <li class="download-type-item download-type-item-without-audio no-user-select">\n                <div>\n                    <span class="download-type-item-description-label text-label">without audio</span>\n                    <span class="download-type-item-size-label text-label"></span>\n                </div>\n                <div class="download-type-item-selector">\n                    <div class="download-type-item-selector-inner"></div>\n                </div>\n            </li>\n        </ul>\n\n        <div class="offline-operations-delete-message-container">\n            <span class="offline-operations-book-title"></span> resourcess will be deleted from this device. You can still access the book when online.\n        </div>\n\n        <div class="offline-operations-action-container">\n            <a href="javascript: void(0)" class="emphasized-button offline-operation-book-button text-label">download</a>\n        </div>\n    </div>\n</div>',c=new s},75:function(e,t,o){"use strict";o.d(t,"a",(function(){return c}));var n=o(3),r=o(1),i=o(5),s=o(14),a=o(25),c=new(function(){function e(){this.loadCodeOnInteraction=this.loadCodeOnInteraction.bind(this),n.a.onPassiveEvent(document.querySelectorAll(".shopping-cart-button"),["mouseenter","touchstart","click"],this.loadCodeOnInteraction)}return e.prototype.loadCodeOnInteraction=function(e){var t=this,o="click"==e.type||r.b.isTouchEventOnTouchDevice(e.type);n.a.offPassiveEvent(document.querySelectorAll(".shopping-cart-button"),[e.type],this.loadCodeOnInteraction),this.getSource().then((function(e){var r=e.ShoppingCartManager;o&&r.requestMenuOpen(),n.a.offPassiveEvent(document.querySelectorAll(".shopping-cart-button"),["mouseenter","touchstart","click"],t.loadCodeOnInteraction)}))},e.prototype.requestMenuOpen=function(){Promise.all([this.getSource()]).then((function(e){var t=e[0].ShoppingCartManager;t&&t.requestMenuOpen()}))},e.prototype.requestAddBookToCartByBookShortName=function(e,t){return Promise.all([this.getSource(),a.a.getCatalog()]).then((function(o){var n=o[0].ShoppingCartManager,r=o[1],i=null!=r&&r.length>0?r.find((function(t){return t.shortName==e})):null;null!=i&&n&&n.requestAddBookToCart(i,!1,t)}))},e.prototype.requestAddBookToCart=function(e,t,o,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1),Promise.all([this.getSource()]).then((function(i){var s=i[0].ShoppingCartManager;s&&s.requestAddBookToCart(e,t,o,n,r)}))},e.prototype.requestAddNewerEditionToCart=function(e){Promise.all([this.getSource()]).then((function(t){t[0].ShoppingCartManager.requestAddNewerEditionToCart(e)}))},e.prototype.getProductOfferings=function(e){var t=this;return new Promise((function(o,n){Promise.all([t.getSource()]).then((function(t){var n=t[0].ShoppingCartManager;o(n.getProductOfferings(e))})).catch((function(e){return n(e)}))}))},e.prototype.getNewestEditionProduct=function(e){var t=this;return new Promise((function(o,n){Promise.all([t.getSource()]).then((function(t){var n=t[0].ShoppingCartManager;o(n.getNewestEditionProduct(e))})).catch((function(e){return n(e)}))}))},e.prototype.getProductDiscounts=function(e,t){var o=this;return new Promise((function(n,r){Promise.all([o.getSource()]).then((function(o){var r=o[0].ShoppingCartManager;n(r.getProductDiscounts(e,t))})).catch((function(e){return r(e)}))}))},e.prototype.isDotd=function(e){var t=this;return new Promise((function(o,n){Promise.all([t.getSource()]).then((function(t){var n=t[0].ShoppingCartManager;o(n.isDotd(e))})).catch((function(e){return n(e)}))}))},e.prototype.getTokenProductOffering=function(){var e=this;return new Promise((function(t,o){Promise.all([e.getSource()]).then((function(e){var o=e[0].ShoppingCartManager;t(o.getTokenProductOffering())}))}))},e.prototype.addTokensToCart=function(e){var t=this;return new Promise((function(o,n){Promise.all([t.getSource()]).then((function(t){var n=t[0].ShoppingCartManager;o(n.addTokensToCart(e))})).catch((function(e){return n(e)}))}))},e.prototype.automaticallyOpenWhenInitialized=function(){Promise.all([this.getSource()]).then((function(e){e[0].ShoppingCartManager.automaticallyOpenWhenInitialized()}))},e.prototype.getBookPrice=function(e){var t=this;return new Promise((function(o,n){Promise.all([t.getSource()]).then((function(t){var n=t[0].ShoppingCartManager;o(n.getBookPrice(e))})).catch((function(e){return n(e)}))}))},e.prototype.initializeShoppingCartStore=function(){var e=this;return new Promise((function(t,o){Promise.all([e.getSource()]).then((function(e){var o=e[0].ShoppingCartManager;t(o.initializeShoppingCartStore())})).catch((function(e){return o(e)}))}))},e.prototype.getProductSpendingInfo=function(e){var t=this;return new Promise((function(o,n){Promise.all([t.getSource()]).then((function(t){var n=t[0].ShoppingCartManager;o(n.getProductSpendingInfo(e))})).catch((function(e){return n(e)}))}))},e.prototype.isEbookInShoppingCart=function(e){if(e)return null!=this.getShoppingCartItems().find((function(t){return t.productId===e.manningId&&!t.isCombo}))},e.prototype.isComboInShoppingCart=function(e){if(e)return null!=this.getShoppingCartItems().find((function(t){return t.productId===e.manningId&&t.isCombo}))},e.prototype.isAudioInShoppingCart=function(e){if(e)return null!=this.getShoppingCartItems().find((function(t){return t.productId===e.manningId&&null!=t.childItems&&t.childItems.length>0&&null!=t.childItems.find((function(e){return e.isSelected}))}))},e.prototype.isInShoppingCartByManningId=function(e){return!!e&&null!=this.getShoppingCartItems().find((function(t){return t.productId==e}))},e.prototype.getShoppingCartItems=function(){return JSON.parse(s.a.getItem("shopping-cart-items")||"[]")},e.prototype.requestOpenLogin=function(){var e=this;return new Promise((function(t,o){Promise.all([e.getSource()]).then((function(e){var o=e[0].ShoppingCartManager;t(o.showLoginModal())})).catch((function(e){return o(e)}))}))},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=i.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(43),o.e(0),o.e(1),o.e(2),o.e(32)]).then(o.bind(null,354))},e}())},76:function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));var n=o(5),r=o(75),i=o(4),s=o(132),a=new(function(){function e(){}return e.prototype.initialize=function(e,t,o){var n=this;this.getUnlockManagerSource().then((function(o){return o.UnlockContentManager.initialize(e,t)})),this.getModalSource().then((function(o){return o.UnlockModal.initialize(e,t)})),this.getUnlockTextSource().then((function(o){o.UnlockText.initialize(e,t)}));var a=this.getFreePreviewManagerSource();e.isOpen?a.then((function(o){return o.FreePreviewManager.initialize(e,t)})):Promise.all([a,r.a.getProductDiscounts(e,s.a.getNewUserDiscountCode())]).then((function(o){var r=o[0].FreePreviewManager;e.isOpen=!i.a.isEmptyObject(o[1])&&n.isNotNewUserDiscount(o[1]),r.initialize(e,t)})).catch((function(o){a.then((function(o){return o.FreePreviewManager.initialize(e,t)}))}))},e.prototype.clean=function(){this.unlockManagerSourcePromise&&(this.getUnlockManagerSource().then((function(e){return e.UnlockContentManager.clean()})),this.getModalSource().then((function(e){return e.UnlockModal.clean()})),this.getUnlockTextSource().then((function(e){return e.UnlockText.clean()})),this.getFreePreviewManagerSource().then((function(e){return e.FreePreviewManager.clean()})))},e.prototype.tryToSearchUnlockFragmentInCurrentBookElement=function(e){this.getUnlockManagerSource().then((function(t){return t.UnlockContentManager.tryToSearchUnlockFragmentInCurrentBookElement(e)}))},e.prototype.refreshTokenStateInToolbar=function(e){this.getUnlockManagerSource().then((function(t){return t.UnlockContentManager.refreshTokenStateInToolbar(e)}))},e.prototype.fetchAndDisplayLatestTokenInfo=function(e){this.getUnlockManagerSource().then((function(t){return t.UnlockContentManager.fetchAndDisplayLatestTokenInfo(e)}))},e.prototype.tryToUnlockPointedParagraph=function(e,t,o,n){this.getUnlockManagerSource().then((function(r){return r.UnlockContentManager.tryToUnlockPointedParagraph(e,t,o,n)}))},e.prototype.unlockFragments=function(e,t,o,n,r,i,s,a){var c=this;return new Promise((function(l,u){c.getUnlockManagerSource().then((function(c){var u=c.UnlockContentManager;return l(u.unlockFragments(e,t,o,n,r,i,s,a))}))}))},e.prototype.showModalForCurrentBookElementPurchases=function(e,t){void 0===t&&(t=null),this.getModalSource().then((function(o){return o.UnlockModal.showModalForCurrentBookElementPurchases(e,t)}))},e.prototype.getUnlockManagerSource=function(){return this.unlockManagerSourcePromise||(this.unlockManagerSourcePromise=n.a.importWebpackModuleWithRetry(this.constructUnlockManagerSourcePromise)),this.unlockManagerSourcePromise},e.prototype.constructUnlockManagerSourcePromise=function(){return Promise.all([o.e(5),o.e(0),o.e(1),o.e(2),o.e(36)]).then(o.bind(null,345))},e.prototype.getFreePreviewManagerSource=function(){return this.freePreviewManagerSourcePromise||(this.freePreviewManagerSourcePromise=n.a.importWebpackModuleWithRetry(this.constructFreePreviewSourcePromise)),this.freePreviewManagerSourcePromise},e.prototype.constructFreePreviewSourcePromise=function(){return Promise.all([o.e(0),o.e(1),o.e(20)]).then(o.bind(null,348))},e.prototype.getModalSource=function(){return this.modalSourcePromise||(this.modalSourcePromise=n.a.importWebpackModuleWithRetry(this.constructUnlockModalSourcePromise)),this.modalSourcePromise},e.prototype.constructUnlockModalSourcePromise=function(){return Promise.all([o.e(5),o.e(0),o.e(1),o.e(2),o.e(37)]).then(o.bind(null,355))},e.prototype.getUnlockTextSource=function(){return this.unlockTextSourcePromise||(this.unlockTextSourcePromise=n.a.importWebpackModuleWithRetry(this.constructUnlockTextSourcePromise)),this.unlockTextSourcePromise},e.prototype.constructUnlockTextSourcePromise=function(){return o.e(38).then(o.bind(null,344))},e.prototype.isNotNewUserDiscount=function(e){if(null==e)return!0;try{for(var t in e)if(e[t]&&e[t].isNewCustomerDiscount)return!1}catch(e){return!0}return!0},e}())},77:function(e,t,o){"use strict";var n=o(3),r=o(15),i=o(6),s=o(9),a=o(1),c=o(78),l=$(window),u=$(document);a.b.loadDeviceInfo().then((function(e){e.isIOS}));var d=function(){function e(){var e=this;this.isInAudioVideoMode=!1,this.shouldAutomaticallyScroll=!0,l.on("wheel DOMMouseScroll mousewheel",(function(){e.shouldAutomaticallyScroll=!1})),u.on("textSideMenuOpened",(function(){e.isTextSideMenuOpened=!0,e.shouldAutomaticallyScroll=!1})),u.on("textSideMenuClosed",(function(){e.isTextSideMenuOpened=!1,e.shouldAutomaticallyScroll=!0})),u.on("tooltipOpened",(function(){e.isTextSelectionMenuOpened=!0,e.shouldAutomaticallyScroll=!1})),u.on("tooltipClosed",(function(){e.isTextSelectionMenuOpened=!1,e.shouldAutomaticallyScroll=!0})),u.on("audioModeLeft videoModeLeft",(function(){e.isInAudioVideoMode=!1,e.shouldAutomaticallyScroll=!0,u.trigger("restoreAutomaticScrolling",i.a.isElementVisible(e.currentTextFragment))})),u.on("audioModeEntered videoModeEntered",(function(){e.isInAudioVideoMode=!0,e.shouldAutomaticallyScroll=!1})),u.on("restoreAutomaticScrolling",(function(t,o){e.isInAudioVideoMode||e.isTextSideMenuOpened||e.isTextSelectionMenuOpened||(e.shouldAutomaticallyScroll=!0,o&&e.scrollToElement(e.currentTextFragment))})),u.on("playingTextFragmentChange",(function(t,o){e.currentTextFragment=o})),u.on("positionPointPositionReached",(function(t,o){e.currentTextFragment&&e.scrollToElementIfNeeded(o&&o[0]||e.currentTextFragment)})),u.on("browsableReached exerciseReached videoReached",(function(t,o){e.shouldAutomaticallyScroll&&o&&(i.a.isElementVisible(o)||n.a.setTimeout((function(){e.isScrolling||e.scrollToElement(o)}),400))})),u.on("requestScrollToElement",(function(t,o){e.scrollToElement(o)}))}return e.prototype.initialize=function(){this.clean()},e.prototype.clean=function(){this.currentTextFragment=null},e.prototype.scrollToElement=function(e,t){e&&this.scrollToPosition($(e).offset().top-1.5*i.a.getTopNavBarHeight(),t)},e.prototype.scrollToPosition=function(e,t){var o=this,r=1e3,i=Math.abs(window.scrollY-e);r=Math.min(3*i,r),this.isScrolling=!0;var s=$("html,body");a.b.isIOSCordova()?(window.scrollTo(0,e),t&&t()):(s.velocity("scroll",{duration:r,offset:e,mobileHA:!1}),n.a.setTimeout((function(){o.isScrolling=!1,t&&t()}),r))},e.prototype.scrollToElementIfNeeded=function(e){if(this.shouldAutomaticallyScroll)if(c.a.isSideMenuOpened)n.a.triggerDocumentEventAsync("playingElementInView",e);else if(r.a.hasBrowsables(e)){var t=r.a.getMostImportantBrowsable(e.browsables);i.a.canBothElementsFitIntoScreen(e,t)?this.scrollToElementWithBrowsablesIfNeeded(e):this.scrollToElementWithoutBrowsablesIfNeeded(e)}else this.scrollToElementWithoutBrowsablesIfNeeded(e);else n.a.triggerDocumentEventAsync("playingElementInView",e)},e.prototype.scrollToElementWithBrowsablesIfNeeded=function(e){var t=r.a.getMostImportantBrowsable(e.browsables),o=t;i.a.isElementVisible(e)&&i.a.isElementVisible(t)&&i.a.isElementVisible(o)?n.a.triggerDocumentEventAsync("playingElementInView",e):i.a.canBothElementsFitIntoScreen(e,o)?this.positionScreenThatBothFit(e,o):this.scrollToElementWithoutBrowsablesIfNeeded(e)},e.prototype.positionScreenThatBothFit=function(e,t){var o=s.a.precedesElement(e,t)?t:e;this.scrollToElementAfterPause(o,e)},e.prototype.scrollToElementWithoutBrowsablesIfNeeded=function(e){var t=e,o=i.a.isElementVisible(e);if(null!=t.previousHeading)o=o&&i.a.isElementVisible(t.previousHeading),t=t.previousHeading;else if("LI"===t.nodeName){var r=t.parentElement.firstElementChild;i.a.canBothElementsFitIntoScreen(t,r)&&(o=o&&i.a.isElementVisible(r),t=r)}o?n.a.triggerDocumentEventAsync("playingElementInView",e):this.scrollToElementAfterPause(t,e)},e.prototype.scrollToElementAfterPause=function(e,t){var o=this;n.a.setTimeout((function(){o.isScrolling?n.a.triggerDocumentEventAsync("playingElementInView",t):o.scrollToElement(e,(function(){n.a.triggerDocumentEventAsync("playingElementInView",t)}))}),400)},e}();t.a=new d},78:function(e,t,o){"use strict";var n=o(3),r=o(1),i=o(6),s=$(document),a=$(window),c=r.b.isIE(),l=r.b.isIOS(),u=function(){function e(e,t,o,r,i,c,u){var d=this;this.isMenuOpening=!1,this.isPinned=!1,this.$button=e,this.$menu=t,this.$additionalAssociatedElements=u,this.beforeOpenMenuCallback=o,this.afterMenuOpenedCallback=r,this.onMenuClosedCallback=c,this.$topBar=$("#top-bar-container"),this.$footer=$("#footer"),this.$input=this.$menu.find("input").filter((function(e,t){return"text"===t.type})),this.$input.length&&l&&this.$input.on("touchstart",(function(){return window.scrollTo(0,0)})),this.$menu.is(".closed")&&this.$menu.css("transform","translateY(-"+this.$menu.height()+"px)"),i||this.$menu.children().first().on("mousewheel DOMMouseScroll",(function(e){return d.handleScroll(e)})),n.a.onEventWithCooldown(this.$menu.find(".pin"),"click touchstart",(function(e){var t=$(e.currentTarget);d.isPinned=!d.isPinned,t.toggleClass("unpinned",!d.isPinned)})),s.on("topbarToggled",(function(){d.dontCloseOnTopBarToggle||d.closeMenu(!0)})),s.on("click",(function(e){return d.handleDocumentClick(e.target)})),s.on("slideMenuOpened",(function(e,t){return d.handleSlideMenuOpened(t)})),s.on("slideMenuCloseRequested",(function(){return d.isMenuOpened()&&d.closeMenu()})),s.on("slideMenuOpenRequested",(function(e,t){return t===d.$button[0]&&d.openMenu()})),n.a.onEventWithCooldown(e,"click touchstart",(function(){return d.handleToggleMenuButtonClick()}));this.$topBar.height();this.lastScreenWidth=a.width(),this.handleResize=this.handleResize.bind(this),a.on("resizestop",this.handleResize)}return e.prototype.handleResize=function(e,t){var o=this,r=this.$topBar.height(),s=a.width();this.isMenuOpened()&&(this.$menu.css("transform","translateY("+(i.a.getComputedTranslateY(this.$topBar.get(0))+r)+"px)"),this.lastScreenWidth!=s&&(this.positionMenuHorizontally(),this.lastScreenWidth=s)),t||n.a.setTimeout((function(){return o.handleResize(null,!0)}),200)},e.prototype.setAssociatedElement=function(e){this.$additionalAssociatedElements=e},e.prototype.openMenu=function(e){var t=this;this.isMenuOpened()||(this.beforeOpenMenuCallback&&this.beforeOpenMenuCallback(),this.$menu.velocity({translateY:-this.$menu.height()},{duration:0}),l||c?setTimeout((function(){return t.performActualOpening(e)}),5):this.performActualOpening(e))},e.prototype.performActualOpening=function(t){var o=this;this.isMenuOpening=!0,s.trigger("slideMenuStartOpening",[this.$menu]),s.trigger("slideMenuOpened",[this.$menu]),this.$button.addClass("selected");var n=0;this.shouldHorizontallyCenter&&(n="-50%"),this.positionMenuHorizontally();var r=i.a.getComputedTranslateY(this.$topBar.get(0)),c=a.height()-this.$topBar.height()-r-1-$("#footer").height();this.dontGoFullScreenHeight||this.$menu.children(".slide-in-menu-container").css("height",c),this.$menu.removeClass("closed"),n&&this.$menu.velocity({translateX:n},{duration:0}),this.$menu.velocity({translateX:n,translateY:this.$topBar.height()+r,opacity:1},{duration:300,complete:function(){e.isSideMenuOpened=!0,e.$openedMenu=o.$menu,o.isMenuOpening=!1,o.afterMenuOpenedCallback&&o.afterMenuOpenedCallback(),t&&t()}}),e.isSideMenuOpened=!0,e.$openedMenu=this.$menu},e.prototype.positionMenuHorizontally=function(){var e=this.$menu.width(),t=this.$button.filter((function(e,t){return jQuery.expr.filters.visible(t)}));if(null!=t&&0!=t.length||(t=this.$button),this.shouldHorizontallyCenter)this.$menu.css({left:"50%",transform:"translate(-50%, 0)"});else{var o=t.offset().left+t.width()/2,n=a.width();o+e/2<n&&o-e/2>0?this.$menu.css({left:o-e/2}):o-e/2<0?this.$menu.css({left:0}):o+e/2>n&&this.$menu.css({left:"",right:0})}},e.prototype.closeMenu=function(t){var o=this;this.$button.removeClass("selected"),this.isMenuClosed()&&!this.isMenuOpening||(s.trigger("slideMenuClosed"),this.$button.removeClass("selected"),this.$menu.velocity({translateY:-this.$menu.height(),opacity:0},{duration:t?0:150,complete:function(){o.$menu.addClass("closed"),e.isSideMenuOpened=!1,e.$openedMenu=null,o.onMenuClosedCallback&&o.onMenuClosedCallback()}}))},e.prototype.isMenuClosed=function(){return!this.$menu[0]||(this.$menu.offset().top<0||this.$menu.is(".closed"))},e.prototype.isMenuOpened=function(){return!this.$menu[0]||this.$menu.offset().top>0&&!this.$menu.is(".closed")},e.prototype.handleToggleMenuButtonClick=function(){this.isMenuOpened()?this.closeMenu():this.openMenu()},e.prototype.handleDocumentClick=function(e){if(0!==this.$button.filter((function(e){return jQuery.expr.filters.visible(e)})).length){var t=this.$menu,o=this.$button,n=this.$additionalAssociatedElements||$(null);t.is(e)||0!==t.has(e).length||o.is(e)||0!==o.has(e).length||!this.isMenuOpened()||$(e).is(".hopscotch-next")||n.is(e)||0!==n.has(e).length||this.isPinned||this.closeMenu()}},e.prototype.handleSlideMenuOpened=function(e){e!==this.$menu&&this.closeMenu(!0)},e.prototype.handleScroll=function(e){var t=e.originalEvent,o=e.currentTarget,n=t.wheelDelta||-t.detail,r=o.scrollTop+$(o).outerHeight()-o.scrollHeight>=-5,i=o.scrollTop<=0;if(n<0&&r||n>0&&i)return e.preventDefault(),!1},e}();t.a=u},79:function(e,t,o){"use strict";o.d(t,"a",(function(){return s}));var n=o(3),r=o(1),i=o(5),s=new(function(){function e(){this.loadCodeOnInteraction=this.loadCodeOnInteraction.bind(this),n.a.onPassiveEvent(document.querySelectorAll(".faq-link, .tour-link, .help-button"),["mouseenter","touchstart","click"],this.loadCodeOnInteraction),$(document).on("click",".more-information-link",this.loadCodeOnInteraction)}return e.prototype.initialize=function(){var e=this;this.getSource().then((function(){e.unsubscribeInteractionEvents()}))},e.prototype.loadCodeOnInteraction=function(e){var t=this,o=$(e.target),i="click"==e.type||r.b.isTouchEventOnTouchDevice(e.type);n.a.offPassiveEvent(document.querySelectorAll(".faq-link, .tour-link, .help-button"),[e.type],this.loadCodeOnInteraction),this.getSource().then((function(e){var n=e.HelpInfoFeedback;i&&(o.is(".more-information-link")?n.openTooltip():n.showMoreInformationModal()),t.unsubscribeInteractionEvents()}))},e.prototype.unsubscribeInteractionEvents=function(){$(document).off("click",".more-information-link",this.loadCodeOnInteraction),n.a.offPassiveEvent(document.querySelectorAll(".faq-link, .tour-link, .help-button, .more-information-link"),["mouseenter","touchstart","click"],this.loadCodeOnInteraction)},e.prototype.getSource=function(){return this.sourcePromise||(this.sourcePromise=i.a.importWebpackModuleWithRetry(this.constructSourcePromise)),this.sourcePromise},e.prototype.renderMeapInfoModal=function(e,t){this.getSource().then((function(o){o.HelpInfoFeedback.showMeapNotification(e,t)}))},e.prototype.renderErrorReportModal=function(){i.a.importWebpackModuleWithRetry(this.constructSourcePromiseErrorManager).then((function(e){e.ErrorReportManager.render(!0)}))},e.prototype.constructSourcePromise=function(){return Promise.all([o.e(0),o.e(1),o.e(22)]).then(o.bind(null,356))},e.prototype.constructSourcePromiseErrorManager=function(){return Promise.all([o.e(0),o.e(1),o.e(22)]).then(o.bind(null,350))},e.prototype.clean=function(){this.sourcePromise&&this.sourcePromise.then((function(e){return e.HelpInfoFeedback.clean()}))},e}())},8:function(e,t,o){"use strict";var n=o(0),r=function(){function e(){}return e.prototype.fetch=function(){return this.settingsPromise?this.settingsPromise:this.settingsPromise=new Promise((function(e,t){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/userInfo/getUserSettings"),(function(t){"string"==typeof t&&("[]"===t&&(t="{}"),t=JSON.parse(t)),e(t)}),(function(t){console.log("Getting settings failed",t),e({})}))}))},e.prototype.update=function(e){return new Promise((function(t,o){n.a.postToOurBackend(n.a.getAbsoluteUrl("api/userInfo/storeUserSettings"),(function(e){return t()}),(function(e){return o()}),e)}))},e}(),i=o(1),s=function(){function e(){this.webService=new r}return e.prototype.fetch=function(){var e=this;return this.settingsPromise?this.settingsPromise:i.b.isConnected()?new Promise((function(t,o){return e.webService.fetch().then((function(){return e.loadSettings().then(t)}))})):this.loadSettings()},e.prototype.update=function(e){return i.b.isConnected()?(this.updateSettings(e),this.webService.update(e)):this.updateSettings(e)},e.prototype.loadSettings=function(){var e=this;return new Promise((function(t,o){e.getFsUtils().readFile(e.getFsUtils().getSettingsLocation()).then((function(e){t(e?JSON.parse(e):{})})).catch((function(e){console.log("No settings present - defaulting",e),t({})}))}))},e.prototype.updateSettings=function(e){var t=this;return new Promise((function(o,n){t.getFsUtils().writeToFile(t.getFsUtils().getSettingsLocation(),JSON.stringify(e)),o()}))},e.prototype.getFsUtils=function(){return window.fileSystemUtils},e}(),a=o(14),c=o(7),l=$(document),u=function(){function e(){var e=this;this.internalStorage=this.getDefaultSettings(),i.b.loadDeviceInfo().then((function(t){e.settingsService=e.getSettingsService(t.platform),c.a.isLoggedIn().then((function(t){return!!t.loggedIn&&e.fetchSettings()}))}))}return e.prototype.fetchSettings=function(){var e=this;this.settingsService.fetch().then((function(t){e.internalStorage=Object.assign(e.internalStorage,t),l.trigger("settingsUpdated",e.internalStorage)}))},e.prototype.set=function(e,t){var o=this;this.internalStorage[e]!=t&&(this.internalStorage[e]=t,clearTimeout(this.syncTimerID),this.syncTimerID=setTimeout((function(){return o.sync()}),1500),l.trigger("settingsUpdated",this.internalStorage))},e.prototype.get=function(e){return this.internalStorage[e]},e.prototype.getHighlightColor=function(){return this.get("highlightColor")},e.prototype.setHighlightColor=function(e){this.set("highlightColor",e)},e.prototype.sync=function(){this.settingsService.update(this.internalStorage),a.a.setItem("settings",JSON.stringify(this.internalStorage))},e.prototype.getSettingsService=function(e){switch(e){case i.a.Browser:return new r;case i.a.Cordova:case i.a.Electron:return new s}},e.prototype.getDefaultSettings=function(){var e={"browsable-pause-type":"browsable-pause-pause","sound-effects-enabled":!1,"night-mode":!1,volume:1,speed:1,"unread-text-visibility":"full-visible",highlightColor:"yellow","text-size":"standard","feedback-submitted":!1,"tour-taken":!1,"tour-offered":!1,"live-audio-disabled":!1,"update-history-on-scroll":!0,"discussions-offered":!1,"discussions-email-notifications-offered":!1,"discussions-code-of-conduct-shown":!1,"stop-showing-error-reports-modal":!1,"error-modal-last-shown":null,"email-subscription-offered":!1,"email-subscription-taken":!1,"settings-menu-highlighted":!1,"position-and-reading-info-disabled":!1,"hide-indexed-terms":!1};try{e=Object.assign(e,JSON.parse(a.a.getItem("settings")))}catch(e){}return e},e}();t.a=new u},80:function(e,t,o){"use strict";var n=o(24),r=o(25),i=o(57),s=o(74),a=(o(337),o(142)),c=o(3),l=o(0),u=function(){function e(e,t){this.bookShortName=e,this.bookTitle=t,this.insertContent()}return e.prototype.insertContent=function(){var e=this;if(!(this.getProgressStripe().length>0)){var t=$("#footer");t.prepend("\n            <div class='download-progress-stripe' data-book-short-name=\""+this.bookShortName+'">\n                <div class="download-status-container" data-book-short-name="'+this.bookShortName+'"></div>\n                <span class="book-title-label"><span class="book-title-label-action">Downloading </span>'+this.bookTitle+'</span>\n                <span class="download-percentage-label">100% complete</span>\n                <span class="download-cancel-label">cancel</span>\n                <span class="download-retry-label">retry</span>\n                <div class="download-progress-stripe-line-container">\n                    <div class="download-progress-stripe-line"></div>\n                </div>\n                <div class="download-progress-stripe-close">\n                    <i class="fa fa-close"/>\n                </div>\n            </div>\n        ');var o=t.find(".download-progress-stripe[data-book-short-name='"+this.bookShortName+"']"),n=t.find(".download-status-container[data-book-short-name='"+this.bookShortName+"']");this.downloadProgressButton=new a.a(n[0]),n.on("click touchstart",(function(){o.is(".downloading")&&$(document).trigger("requestDownloadCancel",e.bookShortName)})),o.find(".download-progress-stripe-close").on("click touchstart",(function(){e.remove()})),c.a.setTimeout((function(){o.addClass("appear")}),16),o.find(".book-title-label, .download-percentage-label").on("click touchstart",(function(){o.is(".downloaded")&&(e.remove(),page(l.a.getBookElementUrl(e.bookShortName,"")))}))}},e.prototype.setProgress=function(e){this.markAsDownloading(),this.downloadProgressButton&&this.downloadProgressButton.setProgress(e),this.getProgressStripe().find(".download-progress-stripe-line").css({width:e+"%"})},e.prototype.setUnzipping=function(){this.getProgressStripe().find(".book-title-label-action").text("Unzipping ")},e.prototype.markAsDownloading=function(){this.getProgressStripe().removeClass("downloaded download-error").addClass("downloading").find(".book-title-label-action").text("Downloading "),this.downloadProgressButton&&this.downloadProgressButton.markAsDownloading()},e.prototype.markAsDownloaded=function(){this.getProgressStripe().removeClass("downloading download-error").addClass("downloaded").find(".book-title-label-action").text("Open "),this.downloadProgressButton&&this.downloadProgressButton.markAsDownloaded()},e.prototype.markAsError=function(){this.getProgressStripe().removeClass("downloading downloaded").addClass("download-error").find(".book-title-label-action").text("Error in "),this.downloadProgressButton&&this.downloadProgressButton.markAsError()},e.prototype.remove=function(){var e=$("#footer"),t=e.find(".download-progress-stripe[data-book-short-name='"+this.bookShortName+"']");e.find(".download-status-container[data-book-short-name='"+this.bookShortName+"']").off("click touchstart"),t.find(".download-progress-stripe-close").off("click touchstart"),this.downloadProgressButton=null,t.removeClass("appear"),c.a.setTimeout((function(){return t.remove()}),150)},e.prototype.getProgressStripe=function(){return $("#footer .download-progress-stripe[data-book-short-name='"+this.bookShortName+"']")},e}(),d=o(7);o.d(t,"a",(function(){return p}));var p=new(function(){function e(){this.currentDownloadsMap={},this.downloadedBooks={},this.downloadStripesMap={}}return e.prototype.initialize=function(){void 0},e.prototype.initializeEvents=function(){var e=this;document.addEventListener("download-started",(function(t){var o=t.detail,n=o.bookShortName,r=o.bookTitle;e.handleDownloadStarted(n,r),e.currentDownloadsMap[n]=!0})),document.addEventListener("download-progress",(function(t){var o=t.detail,n=o.bookShortName,r=o.bookTitle,i=o.progress;e.handleDownloadProgress(n,r,i),e.currentDownloadsMap[n]=!0})),document.addEventListener("download-complete",(function(t){var o=t.detail,n=o.bookShortName,r=o.bookTitle,i=o.targetLocation;e.handleDownloadComplete(n,r,i),delete e.currentDownloadsMap[n],e.downloadedBooks[n]=!0})),document.addEventListener("download-canceled",(function(t){var o=t.detail,n=o.bookShortName,r=o.bookTitle;e.handleDownloadCanceled(n,r),delete e.currentDownloadsMap[n]})),document.addEventListener("download-error",(function(t){var o=t.detail,n=o.bookShortName,r=o.bookTitle;e.handleDownloadError(n,r)})),$(document).on("downloadCanceled",(function(t,o){var n=o.replace(".zip","");e.handleDownloadCanceled(n,"")})),$(document).on("bookDeleted",(function(t,o){e.getMatchingDownloadProgressButtons(o).forEach((function(e){return e.markAsNotDownloaded()})),e.getMatchingBookCoverItems(o).forEach((function(e){return e.addClass("not-downloaded-book")})),delete e.downloadedBooks[o]})),$(document).on("click touchstart",".download-cancel-label",(function(e){var t=$(e.target);$(document).trigger("requestDownloadCancel",t.closest("[data-book-short-name]").attr("data-book-short-name"))})),$(document).on("requestDownloadCancel",(function(e,t){n.a.cancelBookDownload(t)}))},e.prototype.requestBookCancel=function(e){n.a.cancelBookDownload(e)},e.prototype.requestBookDownload=function(e){null!=this.currentDownloadsMap&&null!=e&&this.currentDownloadsMap[e.shortName]||this.downloadedBooks[e.shortName]||null!=e&&e.hasBeenDownloaded||(e.hasAudio&&(e.userOwnsAudio||d.a.isCurrentUserAdmin())?s.a.showDownloadBookModal(e):n.a.requestBookDownload(e.shortName,"content",e.cleanTitle||e.title))},e.prototype.performAutomaticBookDownload=function(e){return new Promise((function(t,o){var r=function(){s(),t()},i=function(){s(),o()},s=function(){document.removeEventListener("download-complete",r),document.removeEventListener("download-canceled",i),document.removeEventListener("download-error",i),$(document).off("downloadCanceled",i)};document.addEventListener("download-complete",r),document.addEventListener("download-canceled",i),document.addEventListener("download-error",i),$(document).on("downloadCanceled",i),n.a.requestBookDownload(e.shortName,"content",e.cleanTitle||e.title)}))},e.prototype.requestBookDeletion=function(e){s.a.showDeleteBookModal(e)},e.prototype.handleDownloadStarted=function(e,t){this.handleDownloadProgress(e,t,0)},e.prototype.handleDownloadProgress=function(e,t,o){var n=parseInt(""+100*o);this.getMatchingDownloadProgressButtons(e).forEach((function(e){return e.setProgress(n)})),null==this.downloadStripesMap[e]&&(this.downloadStripesMap[e]=new u(e,t)),this.downloadStripesMap[e].setProgress(n)},e.prototype.handleDownloadComplete=function(e,t,o){var s=this;this.downloadStripesMap[e].setUnzipping(),n.a.unzipBook(o,e).then((function(){i.a.hideNotification(),r.a.markBookAsDownloaded(e),s.getMatchingDownloadProgressButtons(e).forEach((function(e){return e.markAsDownloaded()})),s.getMatchingBookCoverItems(e).forEach((function(e){return e.removeClass("not-downloaded-book")})),s.downloadStripesMap[e]&&s.downloadStripesMap[e].markAsDownloaded(),setTimeout((function(){s.downloadStripesMap[e]&&s.downloadStripesMap[e].remove(),delete s.currentDownloadsMap[e],delete s.downloadStripesMap[e]}),5e3)})).catch((function(e){console.log("Error unzipping book: "+e)}))},e.prototype.handleDownloadCanceled=function(e,t){this.getMatchingDownloadProgressButtons(e).forEach((function(e){return e.markAsNotDownloaded()})),this.downloadStripesMap[e]&&this.downloadStripesMap[e].remove(),delete this.currentDownloadsMap[e],delete this.downloadStripesMap[e]},e.prototype.handleDownloadError=function(e,t){this.getMatchingDownloadProgressButtons(e).forEach((function(e){return e.markAsError()})),this.downloadStripesMap[e]&&this.downloadStripesMap[e].markAsError(),delete this.currentDownloadsMap[e],delete this.downloadStripesMap[e]},e.prototype.getMatchingDownloadProgressButtons=function(e){var t=[],o=$(".download-status-container[data-book-short-name='"+e+"']");if(o.length>0)for(var n=0;n<o.length;n++){var r=o[n].downloadProgressButton;null!=r&&t.push(r)}return t},e.prototype.getMatchingBookCoverItems=function(e){var t=[];return $(".download-status-container[data-book-short-name='"+e+"']").each((function(e,o){var n=$(o);t.push(n.closest(".open-book-link"))})),t},e}())},81:function(e,t,o){"use strict";var n,r=o(4),i=o(0),s=o(7),a=o(126),c=o(1),l=o(28),u=o(124),d=new(function(){function e(){}return e.prototype.initializeIfNecessary=function(e){var t=this;this.shouldCountPoints()&&($(".top-bar-manning-points-container").removeClass("hidden"),$(".manning-points-container").text(e),$(document).on("achievementPointsChange",(function(e,o){clearTimeout(t.syncTimer),t.syncTimer=setTimeout((function(){t.getPointsFromBackend((function(e){$(".manning-points-container").text(e)}))}),2e3)})))},e.prototype.getPointsFromBackend=function(e){i.a.getFromOurBackend(i.a.getAbsoluteUrl("leaderboard/getNumberOfPoints"),(function(t){return e(t.points)}),(function(t){return e(0)}))},e.prototype.shouldCountPoints=function(){if(c.b.isApp())return!1;var e=new Date;return 2019==e.getFullYear()&&11==e.getMonth()},e}()),p=$(document);n=l.a.prod;var h=function(){function e(){this.chaptersSeen=0,this.viewingScrambledContent=!0,this.currentlyLoggedIn=!1,this.currentBookPart="",this.currentCartStep="",this.numTocMenuClicks=0,this.numTocIndexClicks=0}return e.prototype.startTime=function(){this.startedViewingChapter=new Date},e.prototype.getAbTestVariant=function(){var e=this;return null!=this.abTestVariant?this.abTestVariant:this.abTestVariant=new Promise((function(t,o){e.getExperimentReady().then((function(){window.gtag("event","optimize.callback",{name:"oxDdP4PGSiaRrBD-BsgjEg",callback:function(e){return t(e)}}),setTimeout((function(){return t("0")}),5e3)}))}))},e.prototype.getExperimentReady=function(){return this.experimentReady||(this.experimentReady=new Promise((function(e,t){var o=window;o.dataLayer=o.dataLayer||[],o.gtag=function(){o.dataLayer.push(arguments)},o.gtag("js",new Date),o.gtag("config","UA-98429831-1"),e()}))),this.experimentReady},e.prototype.initializeAnalyticsIfNecessary=function(){var e=this;setTimeout((function(){return e.initializeGoogleAnalytics()}),5),setTimeout((function(){return e.initializeFbAnalytics()}),5),setTimeout((function(){return e.initializeConvertCart()}),5),this.initializeHotjar(),c.b.isApp()||setTimeout((function(){d.shouldCountPoints()?d.getPointsFromBackend((function(e){a.a.initialize(l.b.livebook,new u.a(l.b.livebook,n),e,s.a.isCurrentlyLoggedIn()),d.initializeIfNecessary(e)})):a.a.initialize(l.b.livebook,new u.a(l.b.livebook,n),0,s.a.isCurrentlyLoggedIn())}),50)},e.prototype.initializeGoogleAnalytics=function(){try{c.b.isApp()&&(e=window,t=document,o="script",n="ga",e.GoogleAnalyticsObject=n,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,r=t.createElement(o),i=t.getElementsByTagName(o)[0],r.async=1,r.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(r,i),ga("create","UA-98429831-1","auto"),ga("require","GTM-N46DWC8"),ga("require","ecommerce")),this.trackInterestingEvents()}catch(e){console.log("Error in google analytics",e)}var e,t,o,n,r,i},e.prototype.initializeFbAnalytics=function(){try{e=window,t=document,o="script",e.fbq||(n=e.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)},e._fbq||(e._fbq=n),n.push=n,n.loaded=!0,n.version="2.0",n.queue=[],(r=t.createElement(o)).async=!0,r.src="https://connect.facebook.net/en_US/fbevents.js",(i=t.getElementsByTagName(o)[0]).parentNode.insertBefore(r,i)),window.fbq&&window.fbq("init","1940497162877014")}catch(o){}var e,t,o,n,r,i},e.prototype.initializeSentry=function(){try{$.getScript("https://browser.sentry-cdn.com/4.6.1/bundle.min.js",(function(){var e=window;e.Sentry&&e.Sentry.init&&e.Sentry.init({dsn:"https://c3d25eac84454a43a0a15dc43c9cb2f1@sentry.io/1208009"})}))}catch(e){console.log("Error when installing sentry")}},e.prototype.initializeConvertCart=function(){var e,t,o,n,r,i,s;e=window,t=document,o="script",n="ccart",s=e.fetch?"f":"",e.ccartObj=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].t=Date.now(),(r=t.createElement(o)).async=1,r.src="//cdn.convertcart.com/72486907"+s+".js",(i=t.getElementsByTagName(o)[0]).parentNode.insertBefore(r,i)},e.prototype.initializeConsoleTracking=function(){window.ga=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log("Sent to GA:",JSON.stringify(e))}},e.prototype.initializeHotjar=function(){try{e=window,t=document,e.hj=e.hj||function(){(e.hj.q=e.hj.q||[]).push(arguments)},e._hjSettings={hjid:766946,hjsv:6},o=t.getElementsByTagName("head")[0],(n=t.createElement("script")).async=1,n.src="https://static.hotjar.com/c/hotjar-"+e._hjSettings.hjid+".js?sv="+e._hjSettings.hjsv,o.appendChild(n)}catch(e){console.log("Error initializing hotjar",e)}var e,t,o,n},e.prototype.trackInterestingEvents=function(){var e,t,o=this;setTimeout((function(){s.a.isLoggedIn().then((function(e){e&&e.loggedIn&&e.userDetails?ga&&(ga("set","userId",""+e.userDetails.id),ga("set","dimension1",""+e.userDetails.id),ga("set","dimension2","loggedIn")):ga&&ga("set","dimension2","notLoggedIn")})).catch((function(e){ga&&ga("set","dimension2","anonymous")}))}),100),p.on("chapterLoadingTime",(function(e,t){setTimeout((function(){ga("send","event","chapterLoadingTime",t,a(),{nonInteraction:!0})}),100)})),p.on("appStarted",(function(e,t){ga("send","event","appStarted",t,t,{nonInteraction:!0})})),p.on("bookContentLoaded",(function(o,n,r,s){setTimeout((function(){var o="";if(e=n,t=r.bookElement,e.userOwnsBook)o="accessingOwnedBook";else if(e.isFreeEbook)o="accessingFreeEbook-"+(s?"logged-in":"not-logged-in");else if(t.isOpen)o="accessingFreeBookChapter-"+(s?"logged-in":"not-logged-in");else{o="accessingNotOwnedBookChapter-"+(s?"logged-in":"not-logged-in");try{var c=window;c.hj&&c.hj("trigger","scrambled_chapter_viewed")}catch(e){console.log("Error when triggering hotjar")}}ga("send","event","bookContent",o,a(),{nonInteraction:!0});try{null==n||n.userOwnsBook||(window.ccLayer=window.ccLayer||[],window.ccLayer.push({ccEvent:"productViewed",id:n.manningId,src:"custom",name:n.title,url:"https://livebook.manning.com/"+i.a.getBookUrl(n.slug),image:i.a.getBookCoverUrl(n.shortName),currency:"USD",inStock:!0}))}catch(e){}}),50)})),p.on("exercisesOpened",(function(e){setTimeout((function(){ga("send","event","exercises","solvingExercises",a())}),50)})),p.on("exerciseAnsweredCorrectly",(function(e,t){setTimeout((function(){ga("send","event","exercises","answeredCorrectly",a()),p.trigger("user-action-exercise-solved",[t.productManningId,t.bookShortName+"-"+t.paragraphId+"-"+t.exerciseIndex,!1])}),50)})),p.on("exerciseAnsweredIncorrectly",(function(e){setTimeout((function(){ga("send","event","exercises","answeredIncorrectly",a())}),50)})),p.on("tour",(function(e,t){setTimeout((function(){ga("send","event","tour",t,a())}))})),p.on("unlockSuccess",(function(e,t){setTimeout((function(){"FreePreview"!=t&&ga("send","event","unlock",t+"-success",a())}),50)})),p.on("registrationSuccessful",(function(){setTimeout((function(){ga("send","event","registration","success"),window.fbq&&window.fbq("track","CompleteRegistration",{currency:"USD",value:0})}),50)})),p.on("cartUpsellAddToCartClick",(function(e,t){setTimeout((function(){ga("send","event","cartUpsell","addToCart",t)}),50)})),p.on("cartUpsellShown",(function(e,t){setTimeout((function(){ga("send","event","cartUpsell","show",t)}),50)})),p.on("registrationSubscribeInfo",(function(e,t){setTimeout((function(){ga("send","event","registration",t?"success-subscribed":"success-not-subscribed")}),50)})),p.on("registrationAccountNotActivated",(function(){setTimeout((function(){ga("send","event","registrationProcess","notActivated")}),50)})),p.on("activationRequested",(function(e,t){setTimeout((function(){ga("send","event","registrationProcess","activationRequested",t)}),50)})),p.on("registrationModalShown",(function(){setTimeout((function(){ga("send","event","registrationProcess","registrationModalShown")}),50)})),p.on("unlockFailure",(function(e,t,o){setTimeout((function(){if("FreePreview"!=t){var e=a();try{e+="-"+JSON.stringify(o)}catch(e){}ga("send","event","unlock",t+"-failure",e)}}),50)})),p.on("outOfParagraphByParagraphUnlocks",(function(e){setTimeout((function(){ga("send","event","unlock","outOfParagraphByParagraphUnlocks",a())}),50)})),p.on("searchMade",(function(e,t){setTimeout((function(){ga("send","event","search",t,a());try{window.ccLayer=window.ccLayer||[],window.ccLayer.push({ccEvent:"liveBookProductsSearched",src:"custom",query:t})}catch(e){}p.trigger("user-action-search-made",[c(),t,!1])}),50)})),p.on("searchSuggestion",(function(e,t,o){setTimeout((function(){ga("send","event","searchSuggestion",t,o),p.trigger("user-action-search-result-opened",[c(),t,o,!1])}),50)})),p.on("audioChapterEnded",(function(e){setTimeout((function(){ga("send","event","audio",e.type,a())}),50)})),p.on("anonymousFreePreviewStartRequested",(function(e){setTimeout((function(){ga("send","event","freePreview","anonymousFreePreviewStartRequested",a())}),50)})),p.on("dogEarsClick",(function(e){setTimeout((function(){ga("send","event","dogEarsClick",a())}),50)})),p.on("freePreviewModeActivated",(function(e,t){setTimeout((function(){if(t){ga("send","event","24hFreePreview","activated",a());try{var e=window;e.hj&&e.hj("trigger","24_h_free_preview_activated")}catch(e){console.log("Error when triggering hotjar")}}else ga("send","event","freePreview","activated",a())}),50)})),p.on("landingPageLoaded",(function(){setTimeout((function(){window.ccLayer=window.ccLayer||[],window.ccLayer.push({ccEvent:"homepageViewed",src:"custom"})}),5)})),p.on("freePreviewModeDeactivated",(function(){setTimeout((function(){ga("send","event","freePreview","deactivated",a())}),50)})),p.on("freePreviewModeExpired",(function(){setTimeout((function(){ga("send","event","freePreview","expired",a())}),50)})),p.on("addToCartFromFreeEbookUpsell",(function(e,t){setTimeout((function(){ga("send","event","addToCartFromFreeEbookUpsell",t,a())}),50)})),p.on("openLandingPageCoverLink",(function(e,t){setTimeout((function(){ga("send","event","openLandingPageCoverLink",t)}),50)})),p.on("signInRequested",(function(e,t){setTimeout((function(){ga("send","event","signInRequested",t)}),50)})),p.on("discussionMenuOpened",(function(){setTimeout((function(){ga("send","event","discussion","menuOpened")}),50)})),p.on("productAddedToCart",(function(e,t,o){setTimeout((function(){ga("send","event","productAddedToCart",t+"--"+o,a())}),50)})),p.on("pointingLinkOpened",(function(e,t){setTimeout((function(){ga("send","event","pointingLinkOpened",t,a())}),50)})),p.on("highlightAdded",(function(e){setTimeout((function(){ga("send","event","highlightAdded",a()),p.trigger("user-action-highlight-created",[c(),!1])}),50)})),p.on("bookmarkAdded",(function(e){setTimeout((function(){ga("send","event","bookmarkAdded",a()),p.trigger("user-action-bookmark-created",[c(),!1])}),50)})),p.on("noteAdded",(function(e){setTimeout((function(){ga("send","event","noteAdded",a()),p.trigger("user-action-note-created",[c(),!1])}),50)})),p.on("socialEvent",(function(e,t,o){setTimeout((function(){var e="";o&&(e=(o.productExternalId||"")+"-"+(o.element||"")+"-"+(o.location||"")),ga("send","event","social",t,e||a())}),50)})),p.on("forumOpened",(function(e){setTimeout((function(){ga("send","event","social","forumOpened","")}),50)})),p.on("meapErrorReportShow",(function(e){setTimeout((function(){ga("send","event","meapErrorReport","show")}),50)})),p.on("pageLoaded",(function(e){setTimeout((function(){var e=document.location.hash||document.location.pathname||"";(e=e.replace("//","/"))||(e="/"),ga("set","page",e),ga("send","pageview");try{window.fbq&&window.fbq("track","PageView")}catch(e){}}),200)})),p.on("codeLoadingError",(function(e,t,o){setTimeout((function(){ga("send","event","codeLoadingError",t,o,{nonInteraction:!0})}),100)})),p.on("openedChapter",(function(e,t){setTimeout((function(){var e=document.location.href.split("/")[6];t.loggedIn&&!o.currentlyLoggedIn||t.loggedIn||e!=o.currentBookPart&&o.viewingScrambledContent!=t.scrambled&&(o.chaptersSeen=0,o.viewingScrambledContent=t.scrambled)}),50)})),p.on("shoppingCartOpened",(function(){setTimeout((function(){ga("send","event","cartStep","open");var e=window;e.hj&&e.hj("trigger","shoppingCartOpened")}))})),p.on("cartStep",(function(e,t){setTimeout((function(){o.currentCartStep!=t&&(o.currentCartStep=t,ga("send","event","cartStep",t))}),50)})),p.on("tocMenuOpen",(function(e,t){setTimeout((function(){ga("send","event","toc","menuOpened",a(),{nonInteraction:!0})}),50)})),p.on("tocMenuClick",(function(e,t){setTimeout((function(){ga("send","event","toc","menuClick","numClicks",++o.numTocMenuClicks)}),50)})),p.on("tocIndexClick",(function(e,t){setTimeout((function(){ga("send","event","toc","indexClick","numClicks",++o.numTocIndexClicks)}),50)})),p.on("wishListAdd",(function(e,t){setTimeout((function(){ga("send","event","wishList","wishListAdd",t),p.trigger("user-action-wishlist-item-added",[t,!1])}),50)})),p.on("wishListRemove",(function(e,t){setTimeout((function(){ga("send","event","wishList","wishListRemove",t)}),50)})),p.on("wishListAddToCart",(function(e,t){setTimeout((function(){ga("send","event","wishList","wishListAddToCart",t)}),50)})),p.on("wishListFail",(function(e,t){setTimeout((function(){ga("send","event","wishList","wishListFail",t)}),50)})),p.on("marketingEmailSubscription",(function(e,t,o){setTimeout((function(){ga("send","event","marketingEmailSubscription",t,o)}),50)})),p.on("indexedTerms",(function(e,t,o,n,r){setTimeout((function(){ga("send","event","indexedTerms",t,n+"-"+o),"inlineIndexedTermClick"==t&&p.trigger("user-action-cross-reference-term-opened",[r,o]);try{var e=window;e.hj&&e.hj("trigger","indexedTermClick")}catch(e){console.log("Error when triggering hotjar")}}),50)})),p.on("cc-minicart-viewed",(function(e,t){return o.convertCartMinicartViewed(t)})),p.on("geoMapOpen",(function(e){setTimeout((function(){ga("send","event","social","geoMapOpened","");try{var e=window;e.hj&&e.hj("trigger","communityMapOpened")}catch(e){console.log("Error when triggering hotjar")}}),50)})),p.on("geoMapFeedbackThumbVote",(function(e,t){setTimeout((function(){ga("send","event","social","geoMapFeedbackThumbVote",t)}),50)})),p.on("geoMapHideLocation",(function(e){setTimeout((function(){ga("send","event","social","geoMapHideLocation","")}),50)})),p.on("addItemToCartInGA",(function(e,t){setTimeout((function(){ga("ecommerce:addItem",t)}),1)})),p.on("startTransactionInGA",(function(e,t){setTimeout((function(){ga("ecommerce:addTransaction",t)}),1)})),p.on("sendTransactionInGA",(function(e){setTimeout((function(){ga("ecommerce:send")}),1)}));var n=0;function a(){return(null!=e?e.shortName:"unknownBook")+"-"+(null!=t?t.shortName:"unknownBookElement")}function c(){return null!=e?e.manningId:-1}p.on("progressStore",(function(e,t){setTimeout((function(){var e=r.a.mapToArray(t).length/p.find(".readable-text").length*100;n<25&&e>=25?ga("send","event","audio","25%",a()):n<50&&e>=50?ga("send","event","audio","50%",a()):n<75&&e>=75?ga("send","event","audio","75%",a()):n<99&&e>=99&&ga("send","event","audio","100%",a()),n=e}),50)}))},e.prototype.convertCartMinicartViewed=function(e){window.ccLayer=window.ccLayer||[];var t=e.items.map((function(e){return{name:e.title,price:e.price,currency:"USD",quantity:"1",url:"http://livebook.manning.com/"+e.itemLink,image:e.imageUrl}}));window.ccLayer.push({ccEvent:"miniCartViewed",src:"custom",total:e.totalPrice,currency:"USD",items:t})},e}();t.a=new h},9:function(e,t,o){"use strict";var n=o(1),r=o(6),i=o(3),s=$(document),a=!1;n.b.loadDeviceInfo().then((function(e){a=e.isIOS}));var c=function(){function e(){var e=this;this.isCloseModalDisabled=!1,s.on("keyup",(function(t){27==t.keyCode&&e.hideFoundationModal($(".reveal-modal.shown"))})),s.on("click",".close-reveal-modal, .close-reveal-modal-button, .homepage-link",(function(t){e.hideFoundationModal($(t.target).closest(".reveal-modal"))})),s.on("mousedown touchstart",(function(t){if(!$(t.target).closest(".reveal-modal").length){var o=$(".reveal-modal.shown");o.length&&e.hideFoundationModal(o)}})),$.Velocity&&$.Velocity.RegisterEffect("manning.fromLeftOut",{defaultDuration:350,calls:[[{opacity:[0,1],translateX:-10,translateZ:0}]],reset:{translateX:0}}),$.Velocity&&$.Velocity.RegisterEffect("manning.fromLeftIn",{defaultDuration:400,calls:[[{opacity:[1,0],translateX:[0,-10],translateZ:0}]]})}return e.prototype.canHaveScrollBar=function(){var e=this;return this.canHaveScrollBarPromise?this.canHaveScrollBarPromise:this.canHaveScrollBarPromise=new Promise((function(t,o){setTimeout((function(){t(e.getScrollbarWidth()>0)}),16)}))},e.prototype.getScrollbarWidth=function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=document.createElement("div");e.appendChild(t);var o=e.offsetWidth-t.offsetWidth;return e.parentNode.removeChild(e),o},e.prototype.cacheImageIfNeeded=function(e){n.b.isCordova()&&window.fileSystemUtils.getImageCache().then((function(t){t.cacheFile(e.src)})).catch((function(e){}))},e.prototype.loadFromCacheIfPossible=function(e,t,o){n.b.isCordova()?window.fileSystemUtils.getImageCache().then((function(n){var r=$(e);n.isCached(r.attr("src"),(function(e,i){i?n.useCachedFile(r,o,t):t&&t()}))})).catch((function(e){return t&&t()})):t&&t()},e.prototype.changeElementType=function(e,t){var o={};$.each(e.attributes,(function(e,t){o[t.nodeName]=t.nodeValue})),$(e).replaceWith((function(){return $("<"+t+" />",o).append($(this).contents())}))},e.prototype.getFirstVisibleElement=function(e){if(null==e||0==e.length)return null;for(var t=0;t<e.length;t++){var o=e[t],n=o.getBoundingClientRect();if(n.width>0&&n.height>0&&n.bottom>0)return o}return null},e.prototype.visuallyShowHearting=function(){var e=this,t=$(".header-icon-notification.wish-list-notification"),o=$(".books-button");t.removeClass("hidden disappear").addClass("appear"),this.addIconButtonGlow(o),setTimeout((function(){t.removeClass("appear").addClass("disappear"),e.removeIconButtonGlow(o)}),2e3)},e.prototype.showTextSideMenu=function(e,t,o){var a=this,c=document.getElementById("book-main-content-container"),l=$(c),u=t.offset(),d=t.height(),p=t.width(),h=this.getNecessaryMenuFitShift(e,t),f=r.a.getComputedTranslateX(c),g=function(t){void 0===t&&(t=!1),s.trigger("textSideMenuOpened");var n=a.getMainContainerViewRectangle(),r=a.getViewportRectangle(),l=e.height(),g=u.top-.4*d,m=g+l,v=!1;m>r.bottom&&m<n.bottom&&(v=!0),m>n.bottom&&(g-=m-n.bottom)<n.top&&(g=n.top);var b=0;t?(b=c.offsetLeft+c.offsetWidth/2-e.width()/2,e.addClass("no-tip")):(b=u.left+p+20+h-f,e.removeClass("no-tip")),e.css({top:g,left:b}),e.removeClass("closed").addClass("open"),e.velocity("manning.fromLeftIn",(function(){v?(s.trigger("requestScrollToElement",[e.get(0)]),o&&i.a.setTimeout(o,1e3)):o&&o()}))};0==h?g():n.b.isSmallScreenSize()?g(!0):l.velocity({translateX:h},(function(){return g()}))},e.prototype.closeTextSideMenu=function(e,t){s.trigger("textSideMenuClosed");var o=$(document.getElementById("book-main-content-container"));e.velocity("manning.fromLeftOut",{duration:200,delay:200,complete:function(){e.removeClass("open").addClass("closed"),o.velocity({translateX:0},{complete:function(){o.css("transform",""),t&&t()}})}})},e.prototype.getNecessaryMenuFitShift=function(e,t){var o=document.documentElement.clientWidth,n=e.width(),i=t.offset().left,s=r.a.getComputedTranslateX(document.getElementById("book-main-content-container")),a=o-(n+i+t.width()+60)+s;return a>0?0:a},e.prototype.getMainContainerViewRectangle=function(){var e=$("#book-markup-container"),t=e.offset();return{top:t.top,bottom:t.top+e.height()}},e.prototype.getViewportRectangle=function(){return{top:window.pageYOffset,bottom:window.pageYOffset+$(window).height()}},e.prototype.getMarginRight=function(e){if(null==e||0==e.length)return 0;var t=parseFloat(e.css("margin-right"));return Number.isNaN(t)?0:t},e.prototype.swapNodes=function(e,t){if(e&&t){var o=e.parentNode,n=e.nextSibling===t?e:e.nextSibling;t.parentNode.insertBefore(e,t),o.insertBefore(t,n)}},e.prototype.addIconButtonGlow=function(e){e&&e.length&&(e.addClass("glow"),e.find(".fa").addClass("glow-text"),e.off("animationiteration webkitAnimationIteration"))},e.prototype.isHover=function(e){if(!e||!e.length)return!1;try{return e.is(":hover")}catch(e){return!1}},e.prototype.removeIconButtonGlow=function(e){var t;e&&e.length&&(e.is(".glow")&&(e.one("animationiteration webkitAnimationIteration",(function(){e.removeClass("glow"),e.find(".fa").removeClass("glow-text"),clearTimeout(t)})),t=setTimeout((function(){e.removeClass("glow"),e.find(".fa").removeClass("glow-text")}),2100)))},e.prototype.showFoundationModal=function(e,t){var o=this;if(void 0===t&&(t=!1),e&&e.length&&!e.is(".shown")){$(document).trigger("modalOpening"),this.isCloseModalDisabled=!0,setTimeout((function(){return o.isCloseModalDisabled=!1}),400),this.hideFoundationModal($(".reveal-modal.shown"));var n=$(".reveal-modal-bg");n.length||(n=$("<div class='reveal-modal-bg' style='display: none;'></div>"),$("body").append(n)),a&&e.find("input[type=text]").length&&window.scroll(0,0),n.css("display","block");var i=Math.max(e.height(),600);e.css({top:t?"50%":0,display:"block",visibility:"visible"}),e.toggleClass("modal-vertically-centered",t),e.velocity({translateY:-1.5*i+"px",opacity:0},{duration:0}),e.addClass("shown");var s=1.1*r.a.getTopNavBarHeight(!0);e.velocity({translateY:t?"-50%":s+"px",opacity:1},{duration:300}),$("body").addClass("page-is-showing-modal")}},e.prototype.hideFoundationModal=function(e){if(!this.isCloseModalDisabled&&e&&e.length&&($("body").removeClass("page-is-showing-modal"),!e.is(".close-disabled"))){$(".reveal-modal-bg").css("display","none");var t=e.hasClass("modal-vertically-centered");e.removeClass("modal-vertically-centered"),e.velocity({translateY:t?"-100%":-1.5*e.height()+"px",opacity:0},{duration:250,easing:"ease-out",complete:function(){e.css({display:"none",visibility:"hidden"}),e.removeClass("shown"),s.trigger("modalClosed",e)}})}},e.prototype.unwrapIntoParent=function(e){if(e&&0!==e.length)if(e.length>1)for(var t=0;t<e.length;t++)this.unwrapIntoParent(e.eq(t));else{var o=e[0],n=o.childNodes,r=o.nextSibling,i=o.parentNode;if(e.remove(),r)for(t=n.length-1;t>=0;t--)i.insertBefore(n[t],r);else for(var t=0;t<n.length;t++)i.appendChild(n[t]);i.normalize()}},e.prototype.findFirstPrevious=function(e,t,o){if(void 0===o&&(o=100),!e||0===e.length)return $(null);for(var n=e,r=0;(n=this.getPreviousElementIncludingTree(n))&&n.length>0;){if(n.is(t))return n;if(n.is("ul, .callout-container")){var i=n.children().last();if(i.is(t))return i;var s=this.findFirstPrevious(i,t,Math.max(o-r,0));if(s.length>0)return s}if(++r>o)break}return $(null)},e.prototype.findFirstNext=function(e,t,o){if(void 0===o&&(o=100),!e||0===e.length)return $(null);for(var n=e,r=0;(n=this.getFollowingElementIncludingTree(n))&&n.length>0;){if(n.is(t))return n;if(n.is("ul, ol, .callout-container")){var i=n.children().first();if(i.is(t))return i;var s=this.findFirstNext(i,t);if(s.length>0)return s}if(++r>=o)break}return $(null)},e.prototype.getPreviousElementIncludingTree=function(e){if(!e||0===e.length)return $(null);var t=e.prev();return 0!=t.length?t:e.is("li")?e.parent().prev():$(null)},e.prototype.findFirstPreviousStopAt=function(e,t,o,n){if(void 0===n&&(n=100),!e||0===e.length)return $(null);for(var r=e,i=0;(r=this.getPreviousElementIncludingTree(r))&&r.length>0;){if(r.is(t))return r;if(0!=r.find(o).length)break;if(r.is("ul, ol, .callout-container")){var s=r.children().last();if(s.is(t))return s;var a=this.findFirstPrevious(s,t,Math.max(n-i,0));if(a.length>0)return a}if(++i>n)break}return $(null)},e.prototype.getFollowingElementIncludingTree=function(e){if(!e||0===e.length)return $(null);var t=e.next();if(0!=t.length)return t;if(e.is("li"))return e.parent().next();var o=e.closest(".callout-container");return o.length?o.next():$(null)},e.prototype.precedesElement=function(e,t){if(!e||!t)return 0;var o=e.compareDocumentPosition(t);return o&Node.DOCUMENT_POSITION_DISCONNECTED&&console.log("Node is disconnected!"),o&Node.DOCUMENT_POSITION_PRECEDING},e.prototype.isContainedWithElement=function(e,t){var o=e.compareDocumentPosition(t);return o&Node.DOCUMENT_POSITION_CONTAINS||o&Node.DOCUMENT_POSITION_CONTAINED_BY},e.prototype.wrapToHtmlElement=function(e,t,o){return"<"+e+" "+this.getAttributesString(t)+">"+this.escapeHtmlString(o)+"</"+e+">"},e.prototype.createTextNodeTextRanges=function(e){for(var t={value:"",textNodeRanges:[]},o=0;o<e.length;o++){var n=e[o],r=n.nodeValue,i=t.value;t.value+=r,t.textNodeRanges.push({start:i.length,end:t.value.length,textNode:n})}return t},e.prototype.splitRanges=function(e,t,o){for(var n=e.textNodeRanges,r=[],i=[],s=[],a=0;a<n.length;a++){var c=n[a];c.end<=t?r.push(c):c.start>=o?s.push(c):i.push(c)}return{previousRanges:r,matchingRanges:i,followingRanges:s}},e.prototype.walkTheDOM=function(e,t){for(t(e),e=e.firstChild;e;)this.walkTheDOM(e,t),e=e.nextSibling},e.prototype.getAllDescendantTextNodes=function(e){var t=[];return this.walkTheDOM(e,(function(e){3===e.nodeType&&t.push(e)})),t},e.prototype.getTextWidth=function(e,t){var o=(this.canvas||(this.canvas=document.createElement("canvas"))).getContext("2d");return o.font=t,Math.floor(o.measureText(e).width)},e.prototype.getAttributesString=function(e){if(!e)return"";var t="";for(var o in e)t+=" "+o+'="'+e[o]+'"';return t},e.prototype.escapeHtmlString=function(e){return void 0===e&&(e=""),e.replace("<","&lt;").replace(">","&gt;")},e.prototype.getClassNameMatchingRegEx=function(e,t){if(e&&t&&e.classList)for(var o=e.classList,n=0;n<o.length;n++)if(o[n].match(t))return o[n]},e.prototype.getFirstBlockAncestor=function(e){if(null==e)return null;for(var t=0;null!=e;){e=e.parentNode,t++;var o=$(e).css("display");if("block"===o||"list-item"==o||"flex"==o||"grid"==o||"table"==o)return e;if(t>50)return null}return null},e.prototype.textNodesUnder=function(e){var t=[];for(e=e.firstChild;e;e=e.nextSibling)3==e.nodeType?t.push(e):t=t.concat(this.textNodesUnder(e));return t},e}();t.a=new c},94:function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));var n='<div class="row" id="book-content-main-row">\n<div class="large-12 columns">\n    <div id="book-main-content-container">\n        <div id="track-point-column" class="hidden">\n            <div class="track-point-wrapper" id="pointing-start-point">\n                <i class="fa fa-level-down fa-flip-horizontal" aria-hidden="true"></i>\n            </div>\n            <div class="track-point-wrapper" id="pointing-end-point">\n                <i class="fa fa-level-up fa-flip-horizontal" aria-hidden="true"></i>\n            </div>\n            <div class="track-point-wrapper" id="play-point">\n                <div class="track-point">\n                    <i class="icon-i-play-triangle"></i>\n                </div>\n            </div>\n            <div class="track-point-wrapper" id="current-position-point">\n                <div class="track-point">\n                    <div class="track-point-play">\n                        <i></i>\n                    </div>\n                </div>\n            </div>\n            <div class="track-point-wrapper" id="off-screen-position-point">\n                <div class="track-point">\n                    <div class="off-screen-position-point-arrow-container">\n                        <i class=""></i>\n                    </div>\n                </div>\n            </div>\n            <div class="track-point-wrapper" id="restart-paragraph-point">\n                <div class="track-point">\n                    <i class="fa fa-repeat"></i>\n                </div>\n            </div>\n            <div class="track-point-wrapper" id="free-preview-point">\n                <div class="track-point">\n                    <i class="fa fa-unlock"></i>\n                </div>\n            </div>\n        </div>\n        <div id="book-markup-container">\n            <div class="readable-text">\n                <h1>{{BOOK_ELEMENT_TITLE}}</h1>\n            </div>\n            <div class="introduction-summary">\n                <h3>This chapter covers</h3>\n                <ul>\n                    <li class="readable-text"><span class="placeholder" style="margin-right: 30px"><span class="placeholder-animated-background">&nbsp;</span></span></li>\n                    <li class="readable-text"><span class="placeholder"><span class="placeholder-animated-background">&nbsp;</span></span></li>\n                    <li class="readable-text"><span class="placeholder" style="margin-right: 60px"><span class="placeholder-animated-background">&nbsp;</span></span></li>\n                </ul>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 30px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 10px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 70px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="loading-page-image-placeholder"></div>\n\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 30px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 10px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 80px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="loading-page-image-placeholder"></div>\n            <div class="readable-text">\n                <span class="placeholder"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 30px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 10px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 70px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 10px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="loading-page-image-placeholder"></div>\n\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 30px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 10px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 80px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 30px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 10px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="readable-text">\n                <span class="placeholder" style="margin-right: 80px"><span class="placeholder-animated-background">&nbsp;</span></span>\n            </div>\n            <div class="loading-page-image-placeholder"></div>\n        </div>\n    </div>\n</div>\n</div>'},95:function(e,t,o){"use strict";var n=function(e,t,o,n,r,i,s,a,c,l,u,d,p,h){this.book=e,this.id=t,this.title=o,this.shortName=n,this.userOwnsBookElement=r,this.ordinal=i,this.wordCount=Math.max(s||0,0),this.freeWordCount=Math.max(a||0,0),this.audioLocation=c,this.subtitlesLocation=l,this.isOpen=u,this.meapVersion=d,this.location=p,this.isBookOverview=h};t.a=n},96:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var n=o(14),r=new(function(){function e(){}return e.prototype.isFreeEbookOpen=function(e){try{return!!JSON.parse(n.a.getItem("OPEN_FREE_EBOOKS")||"{}")[e]}catch(e){return!1}},e.prototype.openCurrentFreeEbook=function(e){try{var t=JSON.parse(n.a.getItem("OPEN_FREE_EBOOKS")||"{}");t[e]=!0,n.a.setItem("OPEN_FREE_EBOOKS",JSON.stringify(t))}catch(e){}},e}())}});
//# sourceMappingURL=app.js.map